@font-face {
  font-family: "Caslon Antique";
  src: url("../asset/font/caslon-antique.ttf");
}
@font-face {
  font-family: "Caslon Antique";
  src: url("../asset/font/caslon-antique-Italic.ttf");
  font-style: italic;
}
@font-face {
  font-family: "Caslon Antique";
  src: url("../asset/font/caslon-antique-bold.ttf");
  font-weight: bold;
}
@font-face {
  font-family: "Caslon Antique";
  src: url("../asset/font/caslon-antique-boldItalic.ttf");
  font-style: italic;
  font-weight: bold;
}

/* IMPMAL-CORE FONTS */
@font-face {
  font-family: "Novarese";
  src: url('../assets/fonts/itc-novarese-std-medium.otf');
}
@font-face {
  font-family: "Novarese";
  src: url('../assets/fonts/itc-novarese-std-bold.otf');
  font-weight: bold;
}

@font-face {
  font-family: "MinionPro";
  src: url('../assets/fonts/MinionPro-Regular.otf');
}
@font-face {
  font-family: "MinionPro";
  src: url('../assets/fonts/MinionPro-Bold.otf');
  font-weight: bold;
}
@font-face {
  font-family: "MinionPro";
  src: url('../assets/fonts/MinionPro-BoldIt.otf');
  font-weight: bold;
  font-style: italic;
}

@font-face {
  font-family: "OnlySkulls";
  src: url('../assets/fonts/only-skulls.ttf');
}

@font-face {
  font-family: "CarolGothic";
  src: url('../assets/fonts/carolgothic.ttf');
}
:root {
  --color-highlight: red;
  --color-text: black;
  --color-title: white;
  --color-border: black;
  --color-foreground: #7a1404;
  --color-shadow: #ab4c00;
  --color-success: green;
  --color-failure: red;
  --font-text: "MinionPro", serif;
  --font-header: "Novarese", serif;
  /* IMPMAL CSS VARIABLES */
  --impmal-lightblue: #0b4a50;
  --color-shadow-primary: #065c63;
  --color-border-highlight: #065c63;
  --color-border-light-primary: #065c63;
  --impmal-darkblue: #1c3132;
  --color-border-highlight-alt: #1c3132;
  --color-shadow-highlight: #1c3132;
  --color-border-dark-3: #1c3132;
  --impmal-lightgreen: #37b36b;
  --impmal-darkgreen: #25644b;
  --impmal-orange: #cf9742;
  --impmal-grey: #95a0a2;
  --impmal-grey2: #c9cfce;
  --font-primary: "Novarese";
  scrollbar-color: initial;
  scrollbar-width: initial;
}
.dark-heresy .flex {
  display: flex;
}
.dark-heresy .row {
  flex-direction: row;
}
.dark-heresy .column {
  flex-direction: column;
}
.dark-heresy .border {
  border: 2px solid var(--impmal-lightblue);
  border-radius: 5px;
  padding: 8px;
  text-align: center;
  background: rgba(12, 24, 26, 0.8);
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
}
.dark-heresy .grow {
  flex-grow: 1;
}
.dark-heresy .wrap {
  flex-wrap: wrap;
}
.dark-heresy .justify-center {
  justify-content: center;
}
/* TAB COLORS */
#sidebar-tabs > .item {
  line-height: 31px;
}
#sidebar-tabs > .collapse {
  color: #483d33;
}
#sidebar.collapsed #sidebar-tabs > .item.active {
  border: 1px solid transparent;
}
#sidebar-tabs > .item.active {
  color: #f1f7fd;
  box-shadow: 0 0 10px inset #483d33;
  text-shadow: 0 0 5px #483d33;
  border: 1px solid black;
  border-bottom: none;
}
#sidebar-tabs {
  color: #483d33;
  border-bottom: 1px solid #000;
  box-shadow: 0 0 10px #483d33;
}
#sidebar-tabs a:hover {
  color: #dcdcdc;
  text-shadow: 0 0 8px #483d33, 0 0 8px #483d33, 0 0 8px #483d33;
  -webkit-text-stroke-width: 1px;
  -webkit-text-stroke-color: rgba(255, 255, 255, 0.25);
}
/* BORDER SHENANIGANS */
.subdirectory,
.subdirectory .folder,
.sidebar-tab .directory-list .entity,
li.folder > .folder-header,
.sidebar-tab .directory-list .folder + .entity,
.sidebar-tab .directory-list .entity:last-child,
.sidebar-tab .directory-list .directory-item {
  border: none;
  line-height: 34px;
}
/* MARGIN & PADDING SHENANIGANS */
.sidebar-tab .directory-list {
  padding-left: 5px;
  padding-right: 5px;
}
ol.subdirectory {
  margin-left: 5px;
  padding-left: 5px;
}
.sidebar-tab .directory-list .entity {
  margin-bottom: 2px;
  padding-left: 5px;
}
/* FOLDER ICON SIZE */
li.folder > .folder-header h3 > i {
  display: inline;
  vertical-align: middle;
  font-size: 2em;
}
#actors-popout {
  width: fit-content !important;
}
/* SIDEBAR BACKGROUND & TEXT COLOR */
#sidebar,
.sidebar-popout {
  background-image: url('../assets/ui/sidebar.webp');
  background-size: cover;
}
#sidebar,
.sidebar-popout {
  background-image: url('../assets/ui/sidebar.webp');
  background-size: cover;
}

.app.sidebar-popout .window-content {
  background-image: url("../assets/ui/box-background.webp");
  background-size: 100% 100%;
  background-repeat: no-repeat;
  background-position: center;
  color: #e0e0e0;
  overflow-y: auto;
}

#sidebar,
.sidebar-popout,
.app.sidebar-popout .window-content,
li.folder > .folder-header h3,
li.folder > .folder-header .create-folder,
li.folder > .folder-header .create-entity {
  color: #e0e0e0;
}
li.folder > .folder-header,
li.folder.collapsed > .folder-header {
  background: rgba(12, 24, 26, 0.9);
  border: 1px solid var(--impmal-lightblue);
  border-radius: 4px;
  line-height: 28px;
  box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.35);
  padding: 3px 6px 2px;
}
li.folder > .folder-header:hover,
li.folder.collapsed > .folder-header:hover {
  background: var(--impmal-darkgreen);
  border-color: var(--impmal-lightgreen);
  box-shadow: 0 0 6px rgba(66, 207, 125, 0.35);
}
.sidebar-tab .directory-list .directory-item h3,
.sidebar-tab .directory-list .directory-item h4 {
  padding: 0 6px;
  font-size: 16px;
  color: #e0e0e0;
  font-weight: 600;
}

.sidebar-tab .directory-list .directory-item {
  color: #e0e0e0;
  background: rgba(12, 24, 26, 0.5);
  border: 1px solid rgba(11, 74, 80, 0.5);
  border-radius: 4px;
  margin: 2px 0;
}

.sidebar-tab .directory-list .directory-item:hover {
  background: rgba(28, 49, 50, 0.7);
  border-color: var(--impmal-lightgreen);
  box-shadow: 0 0 6px rgba(66, 207, 125, 0.25);
}
#playlists li.sound .sound-name {
  font-size: 12px;
}
#compendium h3 {
  background: rgba(115, 10, 0, 0.5);
  color: #dcdcdc;
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.8);
  border: 1px solid rgba(66, 207, 125, 0.3);
}

#compendium ol.compendium-list {
  font-size: 16px;
  color: #e0e0e0;
}

#compendium li.compendium-pack {
  background: rgba(26, 26, 26, 0.8);
  border: 1px solid rgba(66, 207, 125, 0.2);
  color: #e0e0e0;
}

#compendium li.compendium-pack:hover {
  background: rgba(40, 40, 40, 0.9);
  border-color: rgba(66, 207, 125, 0.5);
}

#compendium li.compendium-pack .compendium-footer {
  font-size: 12px;
  color: #b0b0b0;
}

#compendium li.compendium-pack .compendium-name {
  color: #dcdcdc;
  font-weight: bold;
}
.sidebar-tab .directory-list .directory-item img {
  flex: 0 0 40px;
  height: 40px;
  width: 40px;
  object-fit: cover;
  object-position: 50% 0;
  margin: 0 8px 0 2px;
  border-radius: 5px;
}
/* SCENES MENU */
#scenes .scene h3 a:hover {
  color: #dcdcdc;
  font-weight: normal;
  text-shadow: 1px 1px 3px #000, 1px -1px 3px #000, -1px 1px 3px #000;
}
#scenes .scene h3 {
  font-size: 1.5em;
  color: #dcdcdc;
  text-shadow: 1px 1px 3px #000, 1px -1px 3px #000, -1px 1px 3px #000;
  line-height: 100px;
  padding-left: 0px;
}
#scenes .subdirectory {
  border-left: 1px solid rgba(51, 51, 51, 0.5);
  border-bottom: 1px solid rgba(51, 51, 51, 0.5);
  border-radius: 0px 0px 0px 15px;
  padding-bottom: 10px;
}
#scenes .scene {
  position: relative;
  height: 100px;
  line-height: 100px;
  background-position: 50% 50%;
  border: 1px solid rgba(0, 0, 0, 0.8);
  margin: 6px 0px -5px 5px;
  box-shadow: none;
}
/* PLAYLIST */
#playlists li.playlist .sound-control {
  font-size: 13px;
  color: #333;
}
#playlists li.global-volume input[type="range"] {
  border-radius: 5px;
  padding: 5px;
}
#playlists .global-control .playlist-header h4 i.fa,
#playlists li.playlist .playlist-header .playlist-name i.fa {
  color: #9e3c16;
  margin-left: 5px;
}
#playlists .sound-timer span,
#playlists i.volume-icon,
#playlists i {
  color: #333;
}
#playlists .global-control .playlist-header {
  background: rgba(115, 10, 0, 0.3);
}
/* NAVIGATION BAR */
#navigation #scene-list .scene,
#navigation #scene-list .scene.view,
#navigation #scene-list .scene.context {
  border: 1px solid rgba(255, 255, 255, 0.25);
  background: rgba(20, 50, 120, 0.9);
  color: #dcdcdc;
}
#navigation #scene-list .scene.view,
#navigation #scene-list .scene.context {
  box-shadow: 0 0 10px rgba(255, 255, 255, 0.8), 0 0 5px #ffffff;
}
#navigation #scene-list .scene.gm {
  border: 1px solid rgba(255, 255, 255, 0.25);
  background: rgba(51, 51, 51, 0.9);
  color: #dcdcdc;
}
#navigation #scene-list .scene.active,
#navigation #scene-list .scene.active.gm {
  background: rgba(0, 0, 0, 0.8);
  border: 1px solid rgba(255, 255, 255, 0.25);
  /* DkGreen */
}
#navigation #scene-list .scene a:hover {
  font-weight: normal;
  color: #dcdcdc;
  text-shadow: 0 0 12px #ffffff, 0 0 10px rgba(255, 255, 255, 0.75), 0 0 8px rgba(255, 255, 255, 0.5);
}
/* COMBAT TRACKER */
#combat #combat-round .encounters a,
#combat #combat-round .encounters h4,
#combat li.combatant .token-resource,
#combat li.combatant .token-name .combatant-control,
.combat-sidebar #combat-round .encounters a,
.combat-sidebar #combat-round .encounters h4,
.combat-sidebar li.combatant .token-resource,
.combat-sidebar li.combatant .token-name .combatant-control {
  color: #333;
  border: none;
}
#combat li.combatant .token-name,
#combat li.combatant .token-initiative .initiative,
.combat-sidebar li.combatant .token-name,
.combat-sidebar li.combatant .token-initiative .initiative {
  font-size: 22px;
  text-shadow: none;
}
#combat li.combatant .token-initiative .combat-sidebar li.combatant .token-initiative {
  mix-blend-mode: difference;
}
#combat li.combatant.hover,
#combat li.combatant:hover,
.combat-sidebar li.combatant.hover,
.combat-sidebar li.combatant:hover {
  background: rgba(140, 75, 30, 0.2);
}
#combat li.combatant.active,
.combat-sidebar li.combatant.active {
  background: rgba(0, 0, 0, 0.25);
}
/* IMPMAL-CORE UI STYLING */
body:not(.no-theme) .powers.active .bar-container.state2 .bar {
  background: url(../assets/ui/space.webp) repeat;
  animation: sliding-bg 4s infinite linear;
}

body:not(.no-theme) #logo {
  content: url(../assets/ui/logo.webp);
  object-fit: contain;
  width: 130px;
  margin: 3px 5px 5px 3px;
}

body:not(.no-theme) .sheet.journal-entry .journal-sidebar {
  background-image: url(../assets/ui/journal-sidebar.webp);
  background-size: cover;
}

body:not(.no-theme) #pause {
  font-family: "CarolGothic";
  background: unset;
}

body:not(.no-theme) #pause::before {
  content: "";
  background: url(../assets/ui/pause-skull.webp);
  display: block;
  background-size: contain;
  position: relative;
  left: calc(50% - 48px);
  top: 10px;
  background-repeat: no-repeat;
  width: 80px;
  height: 100px;
  opacity: 0.5;
}

body:not(.no-theme) #pause img {
  content: url(../assets/ui/pause-ring.webp);
  top: -90px;
  left: calc(50% - 160px);
  height: 300px;
  width: 300px;
}

body:not(.no-theme) #pause figcaption {
  font-size: 3em;
  text-shadow: 0px 0px 15px var(--color-shadow-dark);
}

@keyframes sliding-bg {
  from {
    background-position: 0 0;
  }
  to {
    background-position: 100% 0;
  }
}

/* IMPMAL UI ANIMATIONS */
@keyframes flicker {
  0% {
    opacity: 0.27861;
  }
  5% {
    opacity: 0.34769;
  }
  10% {
    opacity: 0.23604;
  }
  15% {
    opacity: 0.90626;
  }
  20% {
    opacity: 0.18128;
  }
  25% {
    opacity: 0.83891;
  }
  30% {
    opacity: 0.65583;
  }
  35% {
    opacity: 0.67807;
  }
  40% {
    opacity: 0.26559;
  }
  45% {
    opacity: 0.84693;
  }
  50% {
    opacity: 0.96019;
  }
  55% {
    opacity: 0.08594;
  }
  60% {
    opacity: 0.20313;
  }
  65% {
    opacity: 0.71988;
  }
  70% {
    opacity: 0.53455;
  }
  75% {
    opacity: 0.37288;
  }
  80% {
    opacity: 0.71428;
  }
  85% {
    opacity: 0.70419;
  }
  90% {
    opacity: 0.7003;
  }
  95% {
    opacity: 0.36108;
  }
  100% {
    opacity: 0.24387;
  }
}

@keyframes textShadow {
  0% {
    text-shadow: 0.4389924193px 0 1px rgba(0, 30, 255, 0.5), -0.4389924193px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px;
  }
  5% {
    text-shadow: 2.7928974011px 0 1px rgba(0, 30, 255, 0.5), -2.7928974011px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px;
  }
  10% {
    text-shadow: 0.0295627584px 0 1px rgba(0, 30, 255, 0.5), -0.0295627584px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px;
  }
  15% {
    text-shadow: 0.4021853855px 0 1px rgba(0, 30, 255, 0.5), -0.4021853855px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px;
  }
  20% {
    text-shadow: 3.47940379px 0 1px rgba(0, 30, 255, 0.5), -3.47940379px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px;
  }
  25% {
    text-shadow: 1.6125630401px 0 1px rgba(0, 30, 255, 0.5), -1.6125630401px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px;
  }
  30% {
    text-shadow: 0.7015590085px 0 1px rgba(0, 30, 255, 0.5), -0.7015590085px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px;
  }
  35% {
    text-shadow: 3.8969140477px 0 1px rgba(0, 30, 255, 0.5), -3.8969140477px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px;
  }
  40% {
    text-shadow: 3.8709056148px 0 1px rgba(0, 30, 255, 0.5), -3.8709056148px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px;
  }
  45% {
    text-shadow: 2.2310569634px 0 1px rgba(0, 30, 255, 0.5), -2.2310569634px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px;
  }
  50% {
    text-shadow: 0.0808429042px 0 1px rgba(0, 30, 255, 0.5), -0.0808429042px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px;
  }
  55% {
    text-shadow: 2.3758461067px 0 1px rgba(0, 30, 255, 0.5), -2.3758461067px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px;
  }
  60% {
    text-shadow: 2.2021930511px 0 1px rgba(0, 30, 255, 0.5), -2.2021930511px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px;
  }
  65% {
    text-shadow: 2.8638780615px 0 1px rgba(0, 30, 255, 0.5), -2.8638780615px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px;
  }
  70% {
    text-shadow: 0.4887402516px 0 1px rgba(0, 30, 255, 0.5), -0.4887402516px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px;
  }
  75% {
    text-shadow: 1.8948491306px 0 1px rgba(0, 30, 255, 0.5), -1.8948491306px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px;
  }
  80% {
    text-shadow: 0.0833037308px 0 1px rgba(0, 30, 255, 0.5), -0.0833037308px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px;
  }
  85% {
    text-shadow: 0.0976982726px 0 1px rgba(0, 30, 255, 0.5), -0.0976982726px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px;
  }
  90% {
    text-shadow: 3.4433397615px 0 1px rgba(0, 30, 255, 0.5), -3.4433397615px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px;
  }
  95% {
    text-shadow: 2.1841838853px 0 1px rgba(0, 30, 255, 0.5), -2.1841838853px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px;
  }
  100% {
    text-shadow: 2.6208764474px 0 1px rgba(0, 30, 255, 0.5), -2.6208764474px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px;
  }
}

/* CHAT IMPROVEMENTS - IMPMAL STYLE */
#chat-log {
  background-image: url(../assets/ui/sidebar.webp);
  background-size: cover;
  background-position: center;
  background-repeat: repeat;
}

/* Chat messages - IMPMAL STYLE */
body:not(.no-theme) #chat-log .chat-message {
  border: 3px double var(--impmal-darkgreen);
  background: rgba(37, 100, 75, 0.5);
  color: #DDD;
  font-family: "MinionPro", serif;
}

body:not(.no-theme) #chat-log .chat-message .table-description {
  color: #dcdcdc;
}

body:not(.no-theme) #chat-log .chat-message h2, 
body:not(.no-theme) #chat-log .chat-message h3 {
  border-color: var(--impmal-lightgreen);
}

body:not(.no-theme) #chat-log .chat-message.highlight, 
body:not(.no-theme) #chat-log .chat-message.highlight-delayed {
  box-shadow: 0px 0px 10px var(--impmal-lightgreen) inset;
}

body:not(.no-theme) #chat-log .chat-message.whisper {
  background: rgba(6, 92, 99, 0.5);
  border-color: var(--impmal-lightblue);
}

body:not(.no-theme) #chat-log .chat-message.blind {
  background: rgba(125, 66, 207, 0.5);
  border-color: rgb(125, 66, 207);
}

body:not(.no-theme) #chat-log .chat-message .message-header {
  color: #DDD;
  font-family: "Novarese", serif;
  font-size: 13px;
  font-weight: bold;
}

body:not(.no-theme) #chat-log .chat-message .message-content,
body:not(.no-theme) #chat-log .chat-message .message-text {
  font-family: "MinionPro", serif;
  font-size: 14px;
  line-height: 1.5;
  color: #DDD;
}

body:not(.no-theme) #chat-log .chat-message .item-post {
  border-color: var(--impmal-lightgreen);
  font-family: "MinionPro", serif;
}

body:not(.no-theme) #chat-log .chat-message button {
  background-color: var(--impmal-darkgreen);
  border: 1px solid var(--impmal-lightgreen);
  box-shadow: 0 0 5px var(--impmal-lightgreen) inset;
}

body:not(.no-theme) #chat-log .chat-message button:hover {
  background-color: var(--impmal-lightgreen);
}

.chat-message {
  padding: 0;
  margin-bottom: 8px;
  background: transparent;
  border: none;
}

.chat-message.whisper {
  background: transparent;
  border: none;
}

/* IMPMAL UI STYLES - FOUNDRY VTT */
body:not(.no-theme) .sheet.journal-entry .journal-entry-content {
  background: url(../assets/ui/background.webp) repeat;
  background-size: cover;
}

body:not(.no-theme) ::-webkit-scrollbar-thumb {
  background: var(--impmal-lightblue);
}

body:not(.no-theme) .editor-content,
body:not(.no-theme) .sheet.journal-entry .scrollable,
body:not(.no-theme) .directory .directory-list {
  scrollbar-color: initial;
  scrollbar-width: initial;
}

body:not(.no-theme) h2,
body:not(.no-theme) h3 {
  border-color: var(--impmal-lightblue);
}

body:not(.no-theme) hr {
  border-top: 1px solid var(--impmal-darkblue);
  border-bottom: 1px solid var(--impmal-lightblue);
}

body:not(.no-theme) #sidebar-tabs .item.active {
  background-color: var(--impmal-lightgreen);
  position: relative;
  animation: textShadow 1.6s infinite;
}

body:not(.no-theme) #sidebar-tabs .item.active::after {
  content: " ";
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  right: 0;
  background: rgba(18, 16, 16, 0.1);
  opacity: 0;
  z-index: 2;
  pointer-events: none;
  animation: flicker 0.15s infinite;
}

body:not(.no-theme) #sidebar-tabs .item.active::before {
  content: " ";
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  right: 0;
  background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
  z-index: 2;
  background-size: 100% 2px, 3px 100%;
  pointer-events: none;
}

body:not(.no-theme) .sidebar button,
body:not(.no-theme) .sidebar-tab button {
  background-color: var(--impmal-darkblue);
  border: 2px solid var(--impmal-lightblue);
  border-radius: 5px;
  color: #dcdcdc;
  transition: background-color 1s;
}

body:not(.no-theme) .sidebar button:hover,
body:not(.no-theme) .sidebar-tab button:hover {
  background-color: var(--impmal-lightblue);
}

body:not(.no-theme) #chat-controls {
  color: rgba(221, 221, 221, 0.7);
}

body:not(.no-theme) #chat-controls .roll-type-select {
  font-family: monospace;
  color: #DDD;
  border: 1px solid var(--impmal-lightblue);
  background: var(--impmal-darkblue);
}

body:not(.no-theme) #chat-controls .roll-type-select:focus {
  background: var(--impmal-lightblue);
  border: 1px solid var(--impmal-lightblue);
}

body:not(.no-theme) #chat-controls .roll-type-select optgroup,
body:not(.no-theme) #chat-controls .roll-type-select option {
  background: var(--impmal-darkblue);
}

body:not(.no-theme) #chat-form textarea {
  background: rgba(28, 49, 50, 0.7);
  color: #DDD;
  border-color: var(--impmal-lightblue);
  border: 1px solid var(--impmal-lightblue);
}

body:not(.no-theme) #chat-form textarea:focus {
  box-shadow: inset 0 0 5px var(--impmal-lightblue);
}

body:not(.no-theme) #combat-popout .combat-tracker-header,
body:not(.no-theme) #combat-popout #combat-controls,
body:not(.no-theme) #combat .combat-tracker-header,
body:not(.no-theme) #combat #combat-controls {
  background: rgba(6, 92, 99, 0.5);
  border-color: var(--impmal-lightblue);
}

body:not(.no-theme) #combat-popout .resource,
body:not(.no-theme) #combat .resource {
  font-family: monospace;
  color: #DDD;
}

body:not(.no-theme) #combat-popout .resource:focus,
body:not(.no-theme) #combat .resource:focus {
  background: var(--impmal-lightblue);
  border: 1px solid var(--impmal-lightblue);
}

body:not(.no-theme) #combat-popout .resource input,
body:not(.no-theme) #combat .resource input {
  background: var(--impmal-darkblue);
  border-color: var(--impmal-lightblue);
}

body:not(.no-theme) #combat-popout .resource input:focus,
body:not(.no-theme) #combat .resource input:focus {
  background: var(--impmal-lightblue);
}

body:not(.no-theme) .settings-sidebar h2 {
  background: rgba(6, 92, 99, 0.5);
  border-color: var(--impmal-lightblue);
}

/* System settings windows (match impmal style) */
body:not(.no-theme) .script-config .window-content,
body:not(.no-theme) .image-popout .window-content,
body:not(.no-theme) .ambient-light-config .window-content,
body:not(.no-theme) .wall-config .window-content,
body:not(.no-theme) .template-sheet .window-content,
body:not(.no-theme) .filepicker .window-content,
body:not(.no-theme) .sheet-config .window-content,
body:not(.no-theme) .token-sheet .window-content,
body:not(.no-theme) .active-effect-sheet .window-content,
body:not(.no-theme) .sheet.active-effect .window-content,
body:not(.no-theme) .dialog .window-content,
body:not(.no-theme) .roll-table-config .window-content,
body:not(.no-theme) .package-configuration .window-content,
body:not(.no-theme) .scene-sheet .window-content,
body:not(.no-theme) .module-management .window-content,
body:not(.no-theme) .support-issues .window-content,
body:not(.no-theme) .invitation-links .window-content,
body:not(.no-theme) .health-estimate .window-content,
body:not(.no-theme) .health-estimate-config .window-content,
body:not(.no-theme) .dark-heresy.app.window-app .window-content {
  background: rgb(28, 49, 50);
  background: linear-gradient(128deg, rgb(28, 49, 50) 0%, #124549 100%);
  color: #DDD;
}

body:not(.no-theme) .script-config form span.units,
body:not(.no-theme) .image-popout form span.units,
body:not(.no-theme) .ambient-light-config form span.units,
body:not(.no-theme) .wall-config form span.units,
body:not(.no-theme) .template-sheet form span.units,
body:not(.no-theme) .filepicker form span.units,
body:not(.no-theme) .sheet-config form span.units,
body:not(.no-theme) .token-sheet form span.units,
body:not(.no-theme) .active-effect-sheet form span.units,
body:not(.no-theme) .sheet.active-effect form span.units,
body:not(.no-theme) .dialog form span.units,
body:not(.no-theme) .roll-table-config form span.units,
body:not(.no-theme) .package-configuration form span.units,
body:not(.no-theme) .scene-sheet form span.units,
body:not(.no-theme) .module-management form span.units,
body:not(.no-theme) .support-issues form span.units,
body:not(.no-theme) .invitation-links form span.units,
body:not(.no-theme) .health-estimate form span.units,
body:not(.no-theme) .health-estimate-config form span.units,
body:not(.no-theme) .dark-heresy.app.window-app form span.units {
  color: #BBB;
}

body:not(.no-theme) .script-config form .slim .form-fields > label,
body:not(.no-theme) .image-popout form .slim .form-fields > label,
body:not(.no-theme) .ambient-light-config form .slim .form-fields > label,
body:not(.no-theme) .wall-config form .slim .form-fields > label,
body:not(.no-theme) .template-sheet form .slim .form-fields > label,
body:not(.no-theme) .filepicker form .slim .form-fields > label,
body:not(.no-theme) .sheet-config form .slim .form-fields > label,
body:not(.no-theme) .token-sheet form .slim .form-fields > label,
body:not(.no-theme) .active-effect-sheet form .slim .form-fields > label,
body:not(.no-theme) .sheet.active-effect form .slim .form-fields > label,
body:not(.no-theme) .dialog form .slim .form-fields > label,
body:not(.no-theme) .roll-table-config form .slim .form-fields > label,
body:not(.no-theme) .package-configuration form .slim .form-fields > label,
body:not(.no-theme) .scene-sheet form .slim .form-fields > label,
body:not(.no-theme) .module-management form .slim .form-fields > label,
body:not(.no-theme) .support-issues form .slim .form-fields > label,
body:not(.no-theme) .invitation-links form .slim .form-fields > label,
body:not(.no-theme) .health-estimate form .slim .form-fields > label,
body:not(.no-theme) .health-estimate-config form .slim .form-fields > label,
body:not(.no-theme) .dark-heresy.app.window-app form .slim .form-fields > label {
  color: #DDD;
}

body:not(.no-theme) .script-config fieldset,
body:not(.no-theme) .image-popout fieldset,
body:not(.no-theme) .ambient-light-config fieldset,
body:not(.no-theme) .wall-config fieldset,
body:not(.no-theme) .template-sheet fieldset,
body:not(.no-theme) .filepicker fieldset,
body:not(.no-theme) .sheet-config fieldset,
body:not(.no-theme) .token-sheet fieldset,
body:not(.no-theme) .active-effect-sheet fieldset,
body:not(.no-theme) .sheet.active-effect fieldset,
body:not(.no-theme) .dialog fieldset,
body:not(.no-theme) .roll-table-config fieldset,
body:not(.no-theme) .package-configuration fieldset,
body:not(.no-theme) .scene-sheet fieldset,
body:not(.no-theme) .module-management fieldset,
body:not(.no-theme) .support-issues fieldset,
body:not(.no-theme) .invitation-links fieldset,
body:not(.no-theme) .health-estimate fieldset,
body:not(.no-theme) .health-estimate-config fieldset,
body:not(.no-theme) .dark-heresy.app.window-app fieldset {
  border-color: var(--impmal-lightblue);
  border-style: solid;
  margin-bottom: 3px;
}

body:not(.no-theme) .script-config .notes,
body:not(.no-theme) .script-config .hint,
body:not(.no-theme) .script-config .units,
body:not(.no-theme) .image-popout .notes,
body:not(.no-theme) .image-popout .hint,
body:not(.no-theme) .image-popout .units,
body:not(.no-theme) .ambient-light-config .notes,
body:not(.no-theme) .ambient-light-config .hint,
body:not(.no-theme) .ambient-light-config .units,
body:not(.no-theme) .wall-config .notes,
body:not(.no-theme) .wall-config .hint,
body:not(.no-theme) .wall-config .units,
body:not(.no-theme) .template-sheet .notes,
body:not(.no-theme) .template-sheet .hint,
body:not(.no-theme) .template-sheet .units,
body:not(.no-theme) .filepicker .notes,
body:not(.no-theme) .filepicker .hint,
body:not(.no-theme) .filepicker .units,
body:not(.no-theme) .sheet-config .notes,
body:not(.no-theme) .sheet-config .hint,
body:not(.no-theme) .sheet-config .units,
body:not(.no-theme) .token-sheet .notes,
body:not(.no-theme) .token-sheet .hint,
body:not(.no-theme) .token-sheet .units,
body:not(.no-theme) .active-effect-sheet .notes,
body:not(.no-theme) .active-effect-sheet .hint,
body:not(.no-theme) .active-effect-sheet .units,
body:not(.no-theme) .sheet.active-effect .notes,
body:not(.no-theme) .sheet.active-effect .hint,
body:not(.no-theme) .sheet.active-effect .units,
body:not(.no-theme) .dialog .notes,
body:not(.no-theme) .dialog .hint,
body:not(.no-theme) .dialog .units,
body:not(.no-theme) .roll-table-config .notes,
body:not(.no-theme) .roll-table-config .hint,
body:not(.no-theme) .roll-table-config .units,
body:not(.no-theme) .package-configuration .notes,
body:not(.no-theme) .package-configuration .hint,
body:not(.no-theme) .package-configuration .units,
body:not(.no-theme) .scene-sheet .notes,
body:not(.no-theme) .scene-sheet .hint,
body:not(.no-theme) .scene-sheet .units,
body:not(.no-theme) .module-management .notes,
body:not(.no-theme) .module-management .hint,
body:not(.no-theme) .module-management .units,
body:not(.no-theme) .support-issues .notes,
body:not(.no-theme) .support-issues .hint,
body:not(.no-theme) .support-issues .units,
body:not(.no-theme) .invitation-links .notes,
body:not(.no-theme) .invitation-links .hint,
body:not(.no-theme) .invitation-links .units,
body:not(.no-theme) .health-estimate .notes,
body:not(.no-theme) .health-estimate .hint,
body:not(.no-theme) .health-estimate .units,
body:not(.no-theme) .health-estimate-config .notes,
body:not(.no-theme) .health-estimate-config .hint,
body:not(.no-theme) .health-estimate-config .units,
body:not(.no-theme) .dark-heresy.app.window-app .notes,
body:not(.no-theme) .dark-heresy.app.window-app .hint,
body:not(.no-theme) .dark-heresy.app.window-app .units {
  color: #BBB;
}

body:not(.no-theme) .script-config button,
body:not(.no-theme) .image-popout button,
body:not(.no-theme) .ambient-light-config button,
body:not(.no-theme) .wall-config button,
body:not(.no-theme) .template-sheet button,
body:not(.no-theme) .filepicker button,
body:not(.no-theme) .sheet-config button,
body:not(.no-theme) .token-sheet button,
body:not(.no-theme) .active-effect-sheet button,
body:not(.no-theme) .sheet.active-effect button,
body:not(.no-theme) .dialog button,
body:not(.no-theme) .roll-table-config button,
body:not(.no-theme) .package-configuration button,
body:not(.no-theme) .scene-sheet button,
body:not(.no-theme) .module-management button,
body:not(.no-theme) .support-issues button,
body:not(.no-theme) .invitation-links button,
body:not(.no-theme) .dark-heresy.app.window-app button {
  background-color: var(--impmal-darkblue);
  border: 2px solid var(--impmal-lightblue);
  border-radius: 5px;
  color: white;
  transition: background-color 1s;
}
body:not(.no-theme) .script-config button:hover,
body:not(.no-theme) .image-popout button:hover,
body:not(.no-theme) .ambient-light-config button:hover,
body:not(.no-theme) .wall-config button:hover,
body:not(.no-theme) .template-sheet button:hover,
body:not(.no-theme) .filepicker button:hover,
body:not(.no-theme) .sheet-config button:hover,
body:not(.no-theme) .token-sheet button:hover,
body:not(.no-theme) .active-effect-sheet button:hover,
body:not(.no-theme) .sheet.active-effect button:hover,
body:not(.no-theme) .dialog button:hover,
body:not(.no-theme) .roll-table-config button:hover,
body:not(.no-theme) .package-configuration button:hover,
body:not(.no-theme) .scene-sheet button:hover,
body:not(.no-theme) .module-management button:hover,
body:not(.no-theme) .support-issues button:hover,
body:not(.no-theme) .invitation-links button:hover,
body:not(.no-theme) .dark-heresy.app.window-app button:hover {
  background-color: var(--impmal-lightblue);
}

body:not(.no-theme) .script-config textarea,
body:not(.no-theme) .image-popout textarea,
body:not(.no-theme) .ambient-light-config textarea,
body:not(.no-theme) .wall-config textarea,
body:not(.no-theme) .template-sheet textarea,
body:not(.no-theme) .filepicker textarea,
body:not(.no-theme) .sheet-config textarea,
body:not(.no-theme) .token-sheet textarea,
body:not(.no-theme) .active-effect-sheet textarea,
body:not(.no-theme) .sheet.active-effect textarea,
body:not(.no-theme) .dialog textarea,
body:not(.no-theme) .roll-table-config textarea,
body:not(.no-theme) .package-configuration textarea,
body:not(.no-theme) .scene-sheet textarea,
body:not(.no-theme) .module-management textarea,
body:not(.no-theme) .support-issues textarea,
body:not(.no-theme) .invitation-links textarea,
body:not(.no-theme) .dark-heresy.app.window-app textarea {
  color: #DDD;
  border-color: var(--impmal-lightblue);
}

body:not(.no-theme) .script-config select,
body:not(.no-theme) .script-config input,
body:not(.no-theme) .image-popout select,
body:not(.no-theme) .image-popout input,
body:not(.no-theme) .ambient-light-config select,
body:not(.no-theme) .ambient-light-config input,
body:not(.no-theme) .wall-config select,
body:not(.no-theme) .wall-config input,
body:not(.no-theme) .template-sheet select,
body:not(.no-theme) .template-sheet input,
body:not(.no-theme) .filepicker select,
body:not(.no-theme) .filepicker input,
body:not(.no-theme) .sheet-config select,
body:not(.no-theme) .sheet-config input,
body:not(.no-theme) .token-sheet select,
body:not(.no-theme) .token-sheet input,
body:not(.no-theme) .active-effect-sheet select,
body:not(.no-theme) .active-effect-sheet input,
body:not(.no-theme) .sheet.active-effect select,
body:not(.no-theme) .sheet.active-effect input,
body:not(.no-theme) .dialog select,
body:not(.no-theme) .dialog input,
body:not(.no-theme) .roll-table-config select,
body:not(.no-theme) .roll-table-config input,
body:not(.no-theme) .package-configuration select,
body:not(.no-theme) .package-configuration input,
body:not(.no-theme) .scene-sheet select,
body:not(.no-theme) .scene-sheet input,
body:not(.no-theme) .module-management select,
body:not(.no-theme) .module-management input,
body:not(.no-theme) .support-issues select,
body:not(.no-theme) .support-issues input,
body:not(.no-theme) .invitation-links select,
body:not(.no-theme) .invitation-links input,
body:not(.no-theme) .dark-heresy.app.window-app select,
body:not(.no-theme) .dark-heresy.app.window-app input {
  font-family: monospace;
  color: #000000;
  border: 1px solid var(--impmal-lightblue);
}

/* Explicit Foundry system apps: module management, support issues, invitations, edit world */
body:not(.no-theme) .window-app.module-management .window-content,
body:not(.no-theme) .window-app.support-issues .window-content,
body:not(.no-theme) .window-app.invitation-links .window-content,
body:not(.no-theme) .window-app.world-config .window-content,
body:not(.no-theme) .window-app.world-configuration .window-content,
body:not(.no-theme) #module-management .window-content,
body:not(.no-theme) #support-issues .window-content,
body:not(.no-theme) #invitation-links .window-content,
body:not(.no-theme) #world-config .window-content,
body:not(.no-theme) #world-configuration .window-content {
  background: rgb(28, 49, 50);
  background: linear-gradient(128deg, rgb(28, 49, 50) 0%, #124549 100%);
  color: #DDD;
}
body:not(.no-theme) .window-app.module-management .notes,
body:not(.no-theme) .window-app.module-management .hint,
body:not(.no-theme) .window-app.module-management .units,
body:not(.no-theme) .window-app.support-issues .notes,
body:not(.no-theme) .window-app.support-issues .hint,
body:not(.no-theme) .window-app.support-issues .units,
body:not(.no-theme) .window-app.invitation-links .notes,
body:not(.no-theme) .window-app.invitation-links .hint,
body:not(.no-theme) .window-app.invitation-links .units,
body:not(.no-theme) .window-app.world-config .notes,
body:not(.no-theme) .window-app.world-config .hint,
body:not(.no-theme) .window-app.world-config .units,
body:not(.no-theme) .window-app.world-configuration .notes,
body:not(.no-theme) .window-app.world-configuration .hint,
body:not(.no-theme) .window-app.world-configuration .units,
body:not(.no-theme) #module-management .notes,
body:not(.no-theme) #module-management .hint,
body:not(.no-theme) #module-management .units,
body:not(.no-theme) #support-issues .notes,
body:not(.no-theme) #support-issues .hint,
body:not(.no-theme) #support-issues .units,
body:not(.no-theme) #invitation-links .notes,
body:not(.no-theme) #invitation-links .hint,
body:not(.no-theme) #invitation-links .units,
body:not(.no-theme) #world-config .notes,
body:not(.no-theme) #world-config .hint,
body:not(.no-theme) #world-config .units,
body:not(.no-theme) #world-configuration .notes,
body:not(.no-theme) #world-configuration .hint,
body:not(.no-theme) #world-configuration .units {
  color: #BBB;
}
body:not(.no-theme) .window-app.module-management button,
body:not(.no-theme) .window-app.support-issues button,
body:not(.no-theme) .window-app.invitation-links button,
body:not(.no-theme) .window-app.world-config button,
body:not(.no-theme) .window-app.world-configuration button,
body:not(.no-theme) #module-management button,
body:not(.no-theme) #support-issues button,
body:not(.no-theme) #invitation-links button,
body:not(.no-theme) #world-config button,
body:not(.no-theme) #world-configuration button {
  background-color: var(--impmal-darkblue);
  border: 2px solid var(--impmal-lightblue);
  border-radius: 5px;
  color: #DDD;
}
body:not(.no-theme) .window-app.module-management button:hover,
body:not(.no-theme) .window-app.support-issues button:hover,
body:not(.no-theme) .window-app.invitation-links button:hover,
body:not(.no-theme) .window-app.world-config button:hover,
body:not(.no-theme) .window-app.world-configuration button:hover,
body:not(.no-theme) #module-management button:hover,
body:not(.no-theme) #support-issues button:hover,
body:not(.no-theme) #invitation-links button:hover,
body:not(.no-theme) #world-config button:hover,
body:not(.no-theme) #world-configuration button:hover {
  background-color: var(--impmal-lightblue);
}
body:not(.no-theme) .window-app.module-management input,
body:not(.no-theme) .window-app.module-management select,
body:not(.no-theme) .window-app.module-management textarea,
body:not(.no-theme) .window-app.support-issues input,
body:not(.no-theme) .window-app.support-issues select,
body:not(.no-theme) .window-app.support-issues textarea,
body:not(.no-theme) .window-app.invitation-links input,
body:not(.no-theme) .window-app.invitation-links select,
body:not(.no-theme) .window-app.invitation-links textarea,
body:not(.no-theme) .window-app.world-config input,
body:not(.no-theme) .window-app.world-config select,
body:not(.no-theme) .window-app.world-config textarea,
body:not(.no-theme) .window-app.world-configuration input,
body:not(.no-theme) .window-app.world-configuration select,
body:not(.no-theme) .window-app.world-configuration textarea,
body:not(.no-theme) #module-management input,
body:not(.no-theme) #module-management select,
body:not(.no-theme) #module-management textarea,
body:not(.no-theme) #support-issues input,
body:not(.no-theme) #support-issues select,
body:not(.no-theme) #support-issues textarea,
body:not(.no-theme) #invitation-links input,
body:not(.no-theme) #invitation-links select,
body:not(.no-theme) #invitation-links textarea,
body:not(.no-theme) #world-config input,
body:not(.no-theme) #world-config select,
body:not(.no-theme) #world-config textarea,
body:not(.no-theme) #world-configuration input,
body:not(.no-theme) #world-configuration select,
body:not(.no-theme) #world-configuration textarea {
  color: #DDD;
  border-color: var(--impmal-lightblue);
}

body:not(.no-theme) #controls ol.control-tools > li {
  background: var(--impmal-darkblue);
  border-color: var(--impmal-lightblue);
}

body:not(.no-theme) #controls ol.control-tools > li.active, 
body:not(.no-theme) #controls ol.control-tools > li:hover {
  background: var(--impmal-darkgreen);
  border-color: var(--impmal-lightgreen);
}

body:not(.no-theme) #navigation #nav-toggle {
  border-color: var(--impmal-lightblue);
  background: rgba(28, 49, 50, 0.5);
}

body:not(.no-theme) #navigation #scene-list .scene {
  background: var(--impmal-darkblue);
  border-color: var(--impmal-lightblue);
}

body:not(.no-theme) #navigation #scene-list .scene.gm {
  border-color: var(--impmal-lightblue);
}

body:not(.no-theme) #navigation #scene-list .scene.view {
  background: var(--impmal-darkgreen);
}

body:not(.no-theme) #hotbar #macro-list {
  background-image: url(../assets/ui/grid.webp);
  background-size: 50%;
  background-position: 50px 50px;
  border: 1px solid var(--impmal-darkgreen);
}

body:not(.no-theme) #hotbar #macro-list .macro {
  box-shadow: 0 0 5px var(--impmal-darkgreen) inset;
  border: unset;
  background: unset;
}

body:not(.no-theme) #hotbar .bar-controls {
  border: 2px solid var(--impmal-lightblue);
  background: var(--impmal-darkblue);
}

body:not(.no-theme) #players {
  border: 2px solid var(--impmal-lightblue);
  background: var(--impmal-darkblue);
}

body:not(.no-theme) #players h3 {
  border-color: var(--impmal-lightblue);
}

body:not(.no-theme) #players ol .player-name.self {
  color: var(--impmal-lightgreen);
}

body:not(.no-theme) .directory .directory-header .header-search input {
  background: var(--impmal-darkblue);
  border: 2px double var(--impmal-lightblue);
  color: #DDD;
}

body:not(.no-theme) .directory .directory-header .header-search input::placeholder {
  color: var(--impmal-grey);
}

body:not(.no-theme) .directory .directory-item.document {
  border-top: 1px solid var(--impmal-darkblue);
  border-bottom: 1px solid var(--impmal-lightblue);
}

body:not(.no-theme) #menu {
  background-image: url(../assets/ui/grid.webp);
  background-size: cover;
  border: 3px double var(--impmal-lightgreen);
  border-radius: 2px;
}

body:not(.no-theme) a.custom-link,
body:not(.no-theme) a.inline-roll,
body:not(.no-theme) a.content-link {
  padding: 0px;
  border: none;
  background: none;
  color: var(--impmal-lightgreen);
  font-weight: bold;
}

body:not(.no-theme) a.custom-link i,
body:not(.no-theme) a.inline-roll i,
body:not(.no-theme) a.content-link i {
  color: var(--impmal-lightgreen);
}

body:not(.no-theme) a.custom-link.broken,
body:not(.no-theme) a.inline-roll.broken,
body:not(.no-theme) a.content-link.broken {
  color: darkred;
  background: rgba(255, 0, 0, 0.05);
  border: 1px dashed red;
  font-weight: bold;
}

body:not(.no-theme) a.custom-link.broken i,
body:not(.no-theme) a.inline-roll.broken i,
body:not(.no-theme) a.content-link.broken i {
  color: darkred;
}

body:not(.no-theme) a.custom-link img,
body:not(.no-theme) a.inline-roll img,
body:not(.no-theme) a.content-link img {
  filter: invert(74%) sepia(24%) saturate(1030%) hue-rotate(91deg) brightness(89%) contrast(93%);
}

body:not(.no-theme) .journal-sheet:not(.journal-entry-page) .journal-header {
  background-image: url(../assets/ui/title-bg.webp);
  background-size: 100% 100%;
  background-repeat: no-repeat;
  padding: 0px 10px;
}

body:not(.no-theme) .journal-sheet:not(.journal-entry-page) .journal-header .title {
  font-family: "Novarese";
  font-weight: bold;
  text-transform: uppercase;
  font-size: 2.5rem;
  color: #dcdcdc;
  background: none;
  border: none;
}

body:not(.no-theme) .app.window-app:not(.journal-entry-page) .editor .editor-edit {
  background-color: rgba(255, 255, 255, 0.4);
  border-color: var(--impmal-darkgreen);
  color: var(--impmal-darkgreen);
}

body:not(.no-theme) .app.window-app:not(.journal-entry-page) .editor.prosemirror textarea {
  color: #DDD;
}

body:not(.no-theme) .app.window-app:not(.journal-entry-page) .editor.prosemirror button {
  background-color: var(--impmal-darkblue);
  border: 2px solid var(--impmal-lightblue);
  border-radius: 5px;
  color: #dcdcdc;
  transition: background-color 1s;
}

body:not(.no-theme) .app.window-app:not(.journal-entry-page) .editor.prosemirror button:hover {
  background-color: var(--impmal-lightblue);
  color: unset;
}

body:not(.no-theme) .app.window-app:not(.journal-entry-page) .editor.prosemirror button.active {
  background: var(--impmal-darkgreen);
  border-color: var(--impmal-lightgreen);
  color: unset;
}

body:not(.no-theme) .app.window-app:not(.journal-entry-page) .editor.prosemirror menu .pm-dropdown ul {
  background-color: var(--impmal-darkblue);
}

body:not(.no-theme) .app.window-app:not(.journal-entry-page) .editor.prosemirror menu .pm-dropdown ul:hover i {
  color: var(--impmal-lightblue);
}

body:not(.no-theme) .app.window-app:not(.journal-entry-page) .editor.prosemirror menu .pm-dropdown ul li {
  background-color: var(--impmal-darkblue);
  border-color: var(--impmal-darkblue);
}

/* Стили для окна редактирования журнала - новый дизайн, как у других окон */
body:not(.no-theme) .journal-entry-page.window-app .window-content {
  background: rgb(28, 49, 50);
  background: linear-gradient(128deg, rgb(28, 49, 50) 0%, #124549 100%);
  color: #DDD;
}

body:not(.no-theme) .journal-entry-page.window-app .window-header {
  background: rgba(26, 26, 26, 0.9);
  border-bottom: 2px solid rgba(66, 207, 125, 0.3);
  color: #dcdcdc;
}

body:not(.no-theme) .journal-entry-page.window-app .window-header .window-title {
  color: #FFFFFF;
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.8);
}

/* Стили для редактора в окне редактирования журнала */
body:not(.no-theme) .journal-entry-page.window-app .editor .editor-edit {
  background-color: rgba(255, 255, 255, 0.4);
  border-color: var(--impmal-darkgreen);
  color: var(--impmal-darkgreen);
}

body:not(.no-theme) .journal-entry-page.window-app .editor.prosemirror textarea {
  color: #DDD;
}

body:not(.no-theme) .journal-entry-page.window-app .editor.prosemirror button {
  background-color: var(--impmal-darkblue);
  border: 2px solid var(--impmal-lightblue);
  border-radius: 5px;
  color: #dcdcdc;
  transition: background-color 1s;
}

body:not(.no-theme) .journal-entry-page.window-app .editor.prosemirror button:hover {
  background-color: var(--impmal-lightblue);
  color: unset;
}

body:not(.no-theme) .journal-entry-page.window-app .editor.prosemirror button.active {
  background: var(--impmal-darkgreen);
  border-color: var(--impmal-lightgreen);
  color: unset;
}

body:not(.no-theme) .journal-entry-page.window-app .editor.prosemirror menu .pm-dropdown ul {
  background-color: var(--impmal-darkblue);
}

body:not(.no-theme) .journal-entry-page.window-app .editor.prosemirror menu .pm-dropdown ul:hover i {
  color: var(--impmal-lightblue);
}

body:not(.no-theme) .journal-entry-page.window-app .editor.prosemirror menu .pm-dropdown ul li {
  background-color: var(--impmal-darkblue);
  border-color: var(--impmal-darkblue);
}

/* Стили для полей ввода в окне редактирования журнала - белый текст */
body:not(.no-theme) .journal-entry-page.window-app input[type="text"],
body:not(.no-theme) .journal-entry-page.window-app input[type="text"]:focus {
  color: #FFFFFF;
}

/* Стили для контента редактора в окне редактирования журнала - минимальные, чтобы не мешать работе ProseMirror */
body:not(.no-theme) .journal-entry-page.window-app .editor-content.ProseMirror {
  color: #DDD;
}


body:not(.no-theme) .locked-tooltip.link-matches a.content-link {
  color: var(--impmal-lightgreen);
  border-color: var(--impmal-lightgreen);
}

body:not(.no-theme) .journal-entry-page,
body:not(.no-theme) .journal-entry .editor-content {
  font-family: "MinionPro";
  color: var(--impmal-lightblue);
}

body:not(.no-theme) .journal-entry-page ul li::marker,
body:not(.no-theme) .journal-entry .editor-content ul li::marker {
  font-family: OnlySkulls;
  content: "0";
  font-style: normal;
}

body:not(.no-theme) .journal-entry-page ul li > *,
body:not(.no-theme) .journal-entry .editor-content ul li > * {
  margin-left: 5px;
}

body:not(.no-theme) .journal-entry-page .like-h1,
body:not(.no-theme) .journal-entry-page h1,
body:not(.no-theme) .journal-entry .editor-content .like-h1,
body:not(.no-theme) .journal-entry .editor-content h1 {
  font-family: "Novarese";
  text-align: center;
  text-transform: uppercase;
  font-size: 2.5rem;
  font-weight: bold;
  color: var(--impmal-darkblue);
  border-bottom: 0px;
}

body:not(.no-theme) .journal-entry-page .like-h2,
body:not(.no-theme) .journal-entry-page h2,
body:not(.no-theme) .journal-entry .editor-content .like-h2,
body:not(.no-theme) .journal-entry .editor-content h2 {
  font-family: "Novarese";
  text-transform: uppercase;
  font-size: 2rem;
  border-bottom: 2px solid var(--impmal-darkblue);
  font-weight: bold;
  color: var(--impmal-darkblue);
}

body:not(.no-theme) .journal-entry-page .like-h3,
body:not(.no-theme) .journal-entry-page h3,
body:not(.no-theme) .journal-entry .editor-content .like-h3,
body:not(.no-theme) .journal-entry .editor-content h3 {
  margin: 0 0 0.2rem;
  font-family: "Novarese";
  font-variant: small-caps;
  font-size: 1.75rem;
  font-weight: bold;
  color: var(--impmal-lightblue);
  border-bottom: 0px;
}

body:not(.no-theme) .journal-entry-page .like-h4,
body:not(.no-theme) .journal-entry-page h4:not(.window-title),
body:not(.no-theme) .journal-entry .editor-content .like-h4,
body:not(.no-theme) .journal-entry .editor-content h4:not(.window-title) {
  margin: 0 0 0.2rem;
  font-family: "Novarese";
  text-transform: uppercase;
  font-size: 1.5rem;
  color: var(--impmal-lightblue);
}

body:not(.no-theme) .journal-entry-page .like-h5,
body:not(.no-theme) .journal-entry-page h5,
body:not(.no-theme) .journal-entry .editor-content .like-h5,
body:not(.no-theme) .journal-entry .editor-content h5 {
  margin: 0 0 0.5rem;
  font-family: "Novarese";
  text-transform: uppercase;
  font-size: 1.25rem;
  color: var(--impmal-lightblue);
  font-weight: unset;
}

body:not(.no-theme) .journal-entry-page .like-h6,
body:not(.no-theme) .journal-entry-page h6,
body:not(.no-theme) .journal-entry .editor-content .like-h6,
body:not(.no-theme) .journal-entry .editor-content h6 {
  margin: 0 0 0.5rem;
  font-family: "Novarese";
  font-size: 1.125rem;
  color: var(--impmal-lightblue);
}
/* MISC */
li.folder.collapsed > .folder-header {
  background: rgba(86, 78, 74, 0.4);
}
.window-app .window-content {
  background-image: url("../assets/ui/box-background.webp");
  background-size: 100% 100%;
  background-repeat: no-repeat;
  background-position: center;
  color: #e0e0e0;
  overflow-y: auto;
}

.window-app .window-header {
  background: rgba(26, 26, 26, 0.9);
  border-bottom: 2px solid rgba(66, 207, 125, 0.3);
  color: #dcdcdc;
}

.window-app .window-header .window-title {
  color: #dcdcdc;
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.8);
}

/* FORM ELEMENTS IN WINDOWS */
.window-app .form-group label {
  color: #e0e0e0;
  font-weight: bold;
}

.window-app .form-group .notes {
  color: #b0b0b0;
  font-size: 12px;
}

.window-app input[type="text"],
.window-app input[type="number"],
.window-app input[type="password"],
.window-app input[type="email"],
.window-app textarea,
.window-app select {
  background: rgba(183, 172, 158, 0.6);
  border: 1px solid rgba(0, 0, 0, 0.3);
  color: #191813;
  font-family: var(--font-text);
}

.window-app input[type="text"]:focus,
.window-app input[type="number"]:focus,
.window-app input[type="password"]:focus,
.window-app input[type="email"]:focus,
.window-app textarea:focus,
.window-app select:focus {
  border-color: rgba(66, 207, 125, 0.5);
  box-shadow: 0 0 5px rgba(66, 207, 125, 0.3);
}

.window-app button {
  background: rgba(100, 20, 20, 0.8);
  border: 1px solid rgba(0, 0, 0, 0.3);
  color: #dcdcdc;
  font-family: var(--font-text);
}

.window-app button:hover {
  background: rgba(120, 30, 30, 0.9);
  border-color: rgba(66, 207, 125, 0.3);
}
::-webkit-scrollbar-thumb {
  background: #1b0f08b8;
  border: 1px solid #33333380;
}
.dark-heresy.chat {
  color: #F0F0F0;
  font-family: "MinionPro", serif;
  font-size: 14px;
  line-height: 1.5;
  padding: 4px;
  position: relative;
}
.dark-heresy.chat.item {
  max-width: 100%;
}
.dark-heresy.chat.item .background.border {
  background: rgba(12, 24, 26, 0.95);
  background-image: url(../assets/ui/space.webp);
  background-size: cover;
  background-blend-mode: overlay;
  border: 1px solid var(--impmal-lightblue);
  border-radius: 4px;
  padding: 8px 10px;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.4);
  margin: 0;
}
.dark-heresy.chat.item h1 {
  font-family: "Novarese", serif;
  font-size: 15px;
  font-weight: bold;
  color: var(--impmal-lightgreen);
  text-transform: uppercase;
  letter-spacing: 0.8px;
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.8);
  margin: 0 0 6px 0;
  padding: 4px 8px;
  background: rgba(28, 49, 50, 0.5);
  border: 1px solid var(--impmal-lightgreen);
  border-radius: 3px;
  text-align: center;
  line-height: 1.3;
}
.dark-heresy.chat.item img {
  border: 1px solid var(--impmal-lightblue);
  border-radius: 3px;
  display: block;
  margin: 0 auto 6px;
  max-height: 60px;
  width: auto;
  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.3);
}
.dark-heresy.chat.item p {
  margin: 4px 0;
  padding: 3px 6px 3px 8px;
  background: rgba(6, 12, 14, 0.3);
  border-left: 2px solid var(--impmal-lightblue);
  border-radius: 2px;
  line-height: 1.5;
  font-size: 12px;
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  word-wrap: break-word;
  overflow-wrap: break-word;
  box-sizing: border-box;
  align-items: flex-start;
}
.dark-heresy.chat.item p:last-child {
  margin-bottom: 0;
}
.dark-heresy.chat.item p:first-of-type {
  margin-top: 0;
}
.dark-heresy.chat.item strong {
  color: var(--impmal-lightgreen);
  font-weight: 700;
  letter-spacing: 0.2px;
  font-size: 12px;
  flex: 0 0 auto;
  min-width: fit-content;
  white-space: nowrap;
}
.dark-heresy.chat.item p:has(strong:first-child) {
  background: rgba(28, 49, 50, 0.25);
  border-left-color: var(--impmal-lightgreen);
  padding-left: 6px;
}
.dark-heresy.chat.item p:has(strong:first-child) > strong {
  flex: 0 0 auto;
}
.dark-heresy.chat.item p:has(strong:first-child):not(.description-field) > strong ~ * {
  flex: 1 1 auto;
  text-align: right;
  min-width: 0;
  max-width: 100%;
}
/* Description ВСЕГДА justify - принудительно для ВСЕХ элементов */
.dark-heresy.chat.item p.description-field {
  flex-direction: column;
  align-items: flex-start;
  text-align: justify !important;
  text-align-last: justify !important;
}
.dark-heresy.chat.item p.description-field > strong {
  width: 100%;
  margin-bottom: 2px;
  text-align: left !important;
}
/* Упрощенное отображение description: без flex, только текст */
.dark-heresy.chat.item p.description-field {
  display: block !important;
}
.dark-heresy.chat.item p.description-field > strong {
  display: block !important;
}
.dark-heresy.chat.item p.description-field .description-text {
  display: block !important;
  text-align: justify !important;
  text-align-last: justify !important;
  white-space: normal;
}
/* ВСЕ элементы после strong - justify */
.dark-heresy.chat.item p.description-field > strong ~ * {
  text-align: justify !important;
  text-align-last: justify !important;
  width: 100%;
  flex: 1 1 100%;
}
/* ВСЕ дочерние элементы любого уровня вложенности - justify */
.dark-heresy.chat.item p.description-field * {
  text-align: justify !important;
  text-align-last: justify !important;
}
/* Исключение для strong - он остается слева */
.dark-heresy.chat.item p.description-field strong {
  text-align: left !important;
}
/* Специфичные элементы - принудительный justify */
.dark-heresy.chat.item p.description-field p,
.dark-heresy.chat.item p.description-field div,
.dark-heresy.chat.item p.description-field span,
.dark-heresy.chat.item p.description-field em,
.dark-heresy.chat.item p.description-field i,
.dark-heresy.chat.item p.description-field b,
.dark-heresy.chat.item p.description-field u,
.dark-heresy.chat.item p.description-field s,
.dark-heresy.chat.item p.description-field code,
.dark-heresy.chat.item p.description-field pre,
.dark-heresy.chat.item p.description-field h1,
.dark-heresy.chat.item p.description-field h2,
.dark-heresy.chat.item p.description-field h3,
.dark-heresy.chat.item p.description-field h4,
.dark-heresy.chat.item p.description-field h5,
.dark-heresy.chat.item p.description-field h6 {
  text-align: justify !important;
  text-align-last: justify !important;
}
/* Списки в description - justify и без маркеров */
.dark-heresy.chat.item p.description-field ul,
.dark-heresy.chat.item p.description-field ol {
  text-align: justify !important;
  text-align-last: justify !important;
  list-style: none !important;
  padding-left: 0 !important;
}
.dark-heresy.chat.item p.description-field li {
  text-align: justify !important;
  text-align-last: justify !important;
  list-style: none !important;
  list-style-type: none !important;
}
.dark-heresy.chat.item p.description-field li::before,
.dark-heresy.chat.item p.description-field li::marker {
  display: none !important;
  content: none !important;
}
/* Исправление переполнения для списков и символов */
.dark-heresy.chat.item p ul,
.dark-heresy.chat.item p ol {
  margin: 0;
  padding-left: 0;
  padding-right: 0;
  overflow-wrap: break-word;
  word-wrap: break-word;
  max-width: 100%;
  box-sizing: border-box;
  width: 100%;
  flex: 1 1 100%;
  text-align: justify !important;
  list-style: none !important;
}
.dark-heresy.chat.item p li {
  margin: 2px 0;
  overflow-wrap: break-word;
  word-wrap: break-word;
  text-align: justify !important;
  list-style: none !important;
  list-style-type: none !important;
}
.dark-heresy.chat.item p li::before {
  content: none !important;
}
.dark-heresy.chat.item p li::marker {
  display: none !important;
}
.dark-heresy.chat.item p * {
  max-width: 100%;
  overflow-wrap: break-word;
  word-wrap: break-word;
  box-sizing: border-box;
}
.dark-heresy.chat.item p:has(ul):has(strong:first-child),
.dark-heresy.chat.item p:has(ol):has(strong:first-child) {
  flex-direction: column;
}
.dark-heresy.chat.item p:has(ul):has(strong:first-child) > strong ~ *,
.dark-heresy.chat.item p:has(ol):has(strong:first-child) > strong ~ * {
  text-align: justify !important;
  width: 100%;
}
/* Убираем маркеры списков везде в чате */
.dark-heresy.chat.item ul,
.dark-heresy.chat.item ol {
  list-style: none !important;
  padding-left: 0 !important;
}
.dark-heresy.chat.item li {
  list-style: none !important;
  list-style-type: none !important;
}
.dark-heresy.chat.item li::before,
.dark-heresy.chat.item li::marker {
  display: none !important;
  content: none !important;
}
.dark-heresy.chat.roll h1 {
  height: auto;
  margin: 0 0 8px;
  color: #dcdcdc;
  font-family: "Novarese", serif;
  font-weight: bold;
  text-transform: uppercase;
  font-size: 16px;
  letter-spacing: 1px;
  text-shadow: 2px 2px 6px rgba(0, 0, 0, 1), 1px 1px 2px rgba(0, 0, 0, 1), 0 0 12px rgba(0, 0, 0, 0.95);
  background-image: url(../assets/ui/title-bg.webp);
  background-size: 100% 100%;
  background-repeat: no-repeat;
  background-color: rgba(43, 27, 16, 1);
  padding: 8px 12px;
  border: none;
  border-bottom: none;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  filter: contrast(1.1);
}
.dark-heresy.chat.roll .background.border {
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.5);
  padding: 8px 12px;
  background: rgba(37, 100, 75, 0.6);
  background-image: url(../assets/ui/space.webp);
  background-size: cover;
  background-blend-mode: overlay;
  border: 2px double var(--impmal-darkgreen);
  border-radius: 0;
  position: relative;
  color: #F0F0F0;
  margin: 0 0 6px 0;
}
.dark-heresy.chat h3 {
  font-family: "Novarese", serif;
  font-size: 18px;
  font-weight: bold;
  padding: 6px 0;
  margin: 6px 0 8px 0;
  text-align: center;
  text-transform: uppercase;
  letter-spacing: 1.5px;
  text-shadow: 0 1px 4px rgba(0, 0, 0, 0.9);
  border-bottom: 2px solid var(--impmal-lightgreen);
}

.dark-heresy.chat .dh-outcome,
.dark-heresy.chat .dh-outcome.success,
.dark-heresy.chat .mass-outcome.success {
  color: var(--impmal-lightgreen) !important;
  text-shadow: 0 0 8px rgba(66, 207, 125, 0.6), 0 2px 4px rgba(0, 0, 0, 0.8);
}
.dark-heresy.chat .dh-outcome.failure,
.dark-heresy.chat .mass-outcome.failure {
  color: #e74c3c !important;
  text-shadow: 0 0 8px rgba(231, 76, 60, 0.6), 0 2px 4px rgba(0, 0, 0, 0.8);
}
.dark-heresy.chat .separator {
  border-top: 2px solid var(--impmal-lightgreen);
  margin: 6px 0;
  opacity: 0.8;
}
.dark-heresy.chat p {
  margin: 0 0 4px;
  color: #F0F0F0;
  font-family: "MinionPro", serif;
  font-size: 13px;
  line-height: 1.5;
}

.dark-heresy.chat.roll p {
  color: #F0F0F0;
  background: transparent !important;
}

.dark-heresy.chat.roll p strong {
  background: transparent !important;
}

.dark-heresy.chat.roll .background.border p {
  background: transparent !important;
}

.dark-heresy.chat.roll .background.border p strong {
  background: transparent !important;
}

.dark-heresy.chat strong {
  font-family: "MinionPro", serif;
  font-weight: bold;
  font-size: 13px;
  color: #dcdcdc;
  letter-spacing: 0.2px;
}

.dark-heresy.chat span {
  font-family: "MinionPro", serif;
  font-size: 13px;
  color: #E8E8E8;
}
.dark-heresy.chat > .dice-rolls > .dice-roll-render {
  margin-top: 6px;
  margin-bottom: 6px;
}
.dark-heresy.chat button {
  width: 50%;
  height: 28px;
  background-color: var(--impmal-darkgreen);
  color: #dcdcdc;
  font-family: "Novarese", serif;
  font-size: 12px;
  font-weight: bold;
  border: 1px solid var(--impmal-lightgreen);
  border-radius: 0;
  box-shadow: 0 0 5px var(--impmal-lightgreen) inset;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  transition: all 0.2s ease;
  padding: 4px 8px;
}
.dark-heresy.chat .action-buttons {
  display: flex;
  flex-direction: column !important;
  width: 100%;
  gap: 4px;
  margin-top: 6px;
}
.dark-heresy.chat .action-row {
  display: flex;
  gap: 3px;
  width: 100%;
  justify-content: space-between;
}
.dark-heresy.chat .action-row button {
  flex: 1 1 0;
  width: auto;
}
.dark-heresy.chat .action-row-center {
  justify-content: center;
}
.dark-heresy.chat .mass-roll {
  width: 60%;
  position: relative;
}
.dark-heresy.chat .mass-roll::before {
  content: "";
  position: absolute;
  top: -6px;
  left: 50%;
  transform: translateX(-50%);
  border-left: 5px solid transparent;
  border-right: 5px solid transparent;
  border-bottom: 6px solid #641414;
}
.dark-heresy.chat .action-buttons {
  gap: 4px;
}
.dark-heresy.chat .action-buttons button {
  width: auto;
  flex: 1 1 0;
  min-width: 0;
}
.dark-heresy.chat button:hover {
  background-color: var(--impmal-lightgreen);
  box-shadow: 0 0 8px var(--impmal-lightgreen);
  transform: translateY(-1px);
}
.dark-heresy.chat button:active {
  transform: translateY(1px);
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.5), inset 0 2px 4px rgba(0, 0, 0, 0.3);
}
.dark-heresy.chat .mass-card .background.border,
.dark-heresy.chat .mass-card .mass-card-body {
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.5);
  padding: 8px 12px;
  background: rgba(37, 100, 75, 0.6);
  background-image: url(../assets/ui/space.webp);
  background-size: cover;
  background-blend-mode: overlay;
  border: 2px double var(--impmal-darkgreen);
  border-radius: 0;
  color: #F0F0F0;
  margin: 0 0 6px 0;
  font-family: "MinionPro", serif;
  font-size: 13px;
  line-height: 1.5;
}

.dark-heresy.chat .mass-card h1 {
  font-family: "Novarese", serif;
  font-size: 16px;
  letter-spacing: 1px;
  text-transform: uppercase;
  background-image: url(../assets/ui/name-bg.webp);
  background-size: 100% 100%;
  background-repeat: no-repeat;
  background-color: rgba(43, 27, 16, 1);
  padding: 8px 12px;
  margin: 0 0 8px 0;
  color: #dcdcdc;
  text-shadow: 2px 2px 6px rgba(0, 0, 0, 1), 1px 1px 2px rgba(0, 0, 0, 1), 0 0 12px rgba(0, 0, 0, 0.95);
  border: none;
  border-bottom: none;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  filter: contrast(1.1);
}
/* Modern minimalistic test card design with animations */
.dark-heresy.chat.roll.impmal-test {
  font-size: 14px;
  animation: fadeIn 0.3s ease-out;
  padding: 0;
  margin: 0;
}

.dark-heresy.chat.roll.impmal-test .roll-card-background {
  background: linear-gradient(135deg, rgba(0, 0, 0, 0.85) 0%, rgba(20, 20, 20, 0.9) 100%);
  backdrop-filter: blur(10px);
  border-radius: 8px;
  padding: 12px 16px;
  border: 1px solid rgba(55, 179, 107, 0.2);
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.6), inset 0 1px 0 rgba(255, 255, 255, 0.05);
  position: relative;
  overflow: hidden;
}

.dark-heresy.chat.roll.impmal-test .roll-card-background::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: url(../assets/ui/space.webp);
  background-size: cover;
  opacity: 0.15;
  z-index: 0;
  pointer-events: none;
}

.dark-heresy.chat.roll.impmal-test .roll-card-background > * {
  position: relative;
  z-index: 1;
}

.dark-heresy.chat.roll.impmal-test h1 {
  margin: 0 0 8px 0;
  padding: 6px 12px;
  font-size: 12px;
  background: rgba(55, 179, 107, 0.15);
  border-radius: 4px;
  border: 1px solid rgba(55, 179, 107, 0.3);
}

.dark-heresy.chat.roll.impmal-test .weapon-jam-notice {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  margin: 6px 0 8px 0;
  padding: 6px 12px;
  background: linear-gradient(135deg, rgba(231, 76, 60, 0.15) 0%, rgba(139, 0, 0, 0.2) 100%);
  border: 1px solid rgba(231, 76, 60, 0.4);
  border-radius: 4px;
  animation: fadeIn 0.3s ease-out, failurePulse 2s ease-in-out infinite;
  backdrop-filter: blur(4px);
}

.dark-heresy.chat.roll.impmal-test .weapon-jam-notice .jam-icon {
  font-size: 16px;
  color: #e74c3c;
  font-weight: 700;
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
}

.dark-heresy.chat.roll.impmal-test .weapon-jam-notice .jam-text {
  font-size: 11px;
  font-weight: 600;
  color: #ff6b6b;
  text-transform: uppercase;
  letter-spacing: 0.8px;
  font-family: "MinionPro", serif;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
}

.dark-heresy.chat.roll.impmal-test .weapon-overheat-notice {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  margin: 6px 0 8px 0;
  padding: 6px 12px;
  background: linear-gradient(135deg, rgba(255, 152, 0, 0.15) 0%, rgba(255, 87, 34, 0.2) 100%);
  border: 1px solid rgba(255, 152, 0, 0.4);
  border-radius: 4px;
  animation: fadeIn 0.3s ease-out, overheatPulse 2s ease-in-out infinite;
  backdrop-filter: blur(4px);
}

.dark-heresy.chat.roll.impmal-test .weapon-overheat-notice .overheat-icon {
  font-size: 16px;
  color: #ff9800;
  font-weight: 700;
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
  filter: drop-shadow(0 0 3px rgba(255, 152, 0, 0.6));
}

.dark-heresy.chat.roll.impmal-test .weapon-overheat-notice .overheat-text {
  font-size: 11px;
  font-weight: 600;
  color: #ffb74d;
  text-transform: uppercase;
  letter-spacing: 0.8px;
  font-family: "MinionPro", serif;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
}

@keyframes overheatPulse {
  0%, 100% {
    border-color: rgba(255, 152, 0, 0.4);
    box-shadow: 0 0 0 rgba(255, 152, 0, 0);
  }
  50% {
    border-color: rgba(255, 152, 0, 0.7);
    box-shadow: 0 0 8px rgba(255, 152, 0, 0.4);
  }
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(-5px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes slideIn {
  from {
    opacity: 0;
    transform: translateX(-10px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

.dark-heresy.chat.roll.impmal-test .sl-container {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin: 6px 0;
  gap: 8px;
  animation: slideIn 0.4s ease-out 0.1s both;
  padding: 4px 0;
  position: relative;
}

.dark-heresy.chat.roll.impmal-test .roll-value-wrapper,
.dark-heresy.chat.roll.impmal-test .target-value-wrapper {
  display: flex;
  align-items: center;
  flex: 0 0 auto;
  position: relative;
  margin-top: -4px;
}

.dark-heresy.chat.roll.impmal-test .roll-value-wrapper {
  flex-direction: row;
  gap: 6px;
}

.dark-heresy.chat.roll.impmal-test .target-value-wrapper {
  flex-direction: row;
  gap: 6px;
}

.dark-heresy.chat.roll.impmal-test .roll-value,
.dark-heresy.chat.roll.impmal-test .target-value {
  font-size: 24px;
  font-weight: 700;
  color: rgba(232, 232, 232, 0.85);
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
  transition: all 0.2s ease;
  min-width: 50px;
  text-align: center;
  padding: 6px 12px;
  border: 1px solid rgba(55, 179, 107, 0.3);
  border-radius: 4px;
  background: linear-gradient(135deg, rgba(0, 0, 0, 0.4) 0%, rgba(20, 20, 20, 0.5) 100%);
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.05);
  position: relative;
  backdrop-filter: blur(4px);
}

.dark-heresy.chat.roll.impmal-test .roll-value {
  text-align: right;
}

.dark-heresy.chat.roll.impmal-test .target-value {
  text-align: left;
}

.dark-heresy.chat.roll.impmal-test .roll-value::before,
.dark-heresy.chat.roll.impmal-test .target-value::before {
  content: '';
  position: absolute;
  top: -2px;
  left: -2px;
  right: -2px;
  bottom: -2px;
  border: 1px solid rgba(55, 179, 107, 0.2);
  border-radius: 4px;
  opacity: 0;
  transition: opacity 0.3s ease;
  pointer-events: none;
}

.dark-heresy.chat.roll.impmal-test .roll-value:hover::before,
.dark-heresy.chat.roll.impmal-test .target-value:hover::before {
  opacity: 1;
}

.dark-heresy.chat.roll.impmal-test .roll-value:hover,
.dark-heresy.chat.roll.impmal-test .target-value:hover {
  transform: scale(1.05) translateY(-2px);
  color: var(--impmal-lightgreen);
  text-shadow: 0 0 8px rgba(55, 179, 107, 0.5);
  border-color: rgba(55, 179, 107, 0.5);
  box-shadow: 0 4px 12px rgba(55, 179, 107, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1);
}


.dark-heresy.chat.roll.impmal-test .sl-container .sl {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  flex: 1 1 auto;
  padding: 4px 0;
  gap: 4px;
  min-width: 0;
}

.dark-heresy.chat.roll.impmal-test .sl .sl-value {
  font-size: 32px;
  background: linear-gradient(135deg, rgba(0, 0, 0, 0.3) 0%, rgba(0, 0, 0, 0.15) 100%);
  border-radius: 6px;
  text-align: center;
  width: 80px;
  height: 48px;
  line-height: 48px;
  border: 1px solid rgba(55, 179, 107, 0.4);
  color: var(--impmal-lightgreen);
  font-weight: 700;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1);
  position: relative;
  overflow: hidden;
}

.dark-heresy.chat.roll.impmal-test .sl .sl-label {
  font-size: 13px;
  color: rgba(55, 179, 107, 0.95);
  font-weight: 600;
  text-align: center;
  font-family: "MinionPro", serif;
  letter-spacing: 0.8px;
  text-shadow: 0 0 8px rgba(55, 179, 107, 0.4);
}

.dark-heresy.chat.roll.impmal-test .sl .sl-value::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(55, 179, 107, 0.2), transparent);
  transition: left 0.5s ease;
}

.dark-heresy.chat.roll.impmal-test .sl .sl-value:hover::before {
  left: 100%;
}

.dark-heresy.chat.roll.impmal-test .sl .sl-value:hover {
  transform: translateY(-2px);
  border-color: var(--impmal-lightgreen);
  box-shadow: 0 4px 12px rgba(55, 179, 107, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.15);
}

/* Failure (DOF) styling with red vibes */
.dark-heresy.chat.roll.impmal-test .sl-container.failure .sl .sl-value,
.dark-heresy.chat.roll.impmal-test .sl.failure .sl-value {
  color: #e74c3c;
  border-color: rgba(231, 76, 60, 0.5);
  background: linear-gradient(135deg, rgba(231, 76, 60, 0.15) 0%, rgba(139, 0, 0, 0.2) 100%);
  box-shadow: 0 2px 8px rgba(231, 76, 60, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.1), 0 0 15px rgba(231, 76, 60, 0.3);
  animation: failurePulse 2s ease-in-out infinite;
}

@keyframes failurePulse {
  0%, 100% {
    box-shadow: 0 2px 8px rgba(231, 76, 60, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.1), 0 0 15px rgba(231, 76, 60, 0.3);
  }
  50% {
    box-shadow: 0 2px 12px rgba(231, 76, 60, 0.6), inset 0 1px 0 rgba(255, 255, 255, 0.15), 0 0 20px rgba(231, 76, 60, 0.5);
  }
}

.dark-heresy.chat.roll.impmal-test .sl-container.failure .sl .sl-value::before,
.dark-heresy.chat.roll.impmal-test .sl.failure .sl-value::before {
  background: linear-gradient(90deg, transparent, rgba(231, 76, 60, 0.3), transparent);
}

.dark-heresy.chat.roll.impmal-test .sl-container.failure .sl .sl-value:hover,
.dark-heresy.chat.roll.impmal-test .sl.failure .sl-value:hover {
  border-color: rgba(231, 76, 60, 0.8);
  box-shadow: 0 4px 16px rgba(231, 76, 60, 0.5), inset 0 1px 0 rgba(255, 255, 255, 0.15), 0 0 25px rgba(231, 76, 60, 0.6);
  transform: translateY(-2px);
}

/* Negative SL (DOF) styling - fallback for older selectors */
.dark-heresy.chat.roll.impmal-test .sl .sl-value:has-text("-"),
.dark-heresy.chat.roll.impmal-test .sl .sl-value:contains("-"),
.dark-heresy.chat.roll.impmal-test .sl .sl-value:not(:has-text("+")):not(:empty) {
  color: #e74c3c;
  border-color: rgba(231, 76, 60, 0.4);
}

.dark-heresy.chat.roll.impmal-test .sl .sl-value:has-text("-"):hover,
.dark-heresy.chat.roll.impmal-test .sl .sl-value:contains("-"):hover {
  border-color: rgba(231, 76, 60, 0.6);
  box-shadow: 0 4px 12px rgba(231, 76, 60, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.15);
}

.dark-heresy.chat.roll.impmal-test p.centered {
  text-align: center;
  margin: 2px 0 6px 0;
  font-size: 13px;
  font-weight: 600;
  color: rgba(220, 220, 220, 0.9);
  text-transform: uppercase;
  letter-spacing: 1.2px;
  animation: fadeIn 0.4s ease-out 0.3s both;
  padding: 2px 0;
}

.dark-heresy.chat.roll.impmal-test .test-details {
  margin-top: 8px;
  animation: fadeIn 0.4s ease-out 0.4s both;
}

.dark-heresy.chat.roll.impmal-test .test-details .tags {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 4px;
  margin-bottom: 8px;
}

.dark-heresy.chat.roll.impmal-test .test-details .tags > * {
  border: 1px solid rgba(55, 179, 107, 0.3);
  border-radius: 12px;
  background: rgba(0, 0, 0, 0.3);
  padding: 3px 10px;
  color: rgba(55, 179, 107, 0.9);
  font-size: 11px;
  font-weight: 500;
  transition: all 0.2s ease;
  backdrop-filter: blur(4px);
}

.dark-heresy.chat.roll.impmal-test .test-details .tags > *:hover {
  background: rgba(55, 179, 107, 0.2);
  border-color: rgba(55, 179, 107, 0.5);
  transform: translateY(-1px);
  box-shadow: 0 2px 6px rgba(55, 179, 107, 0.2);
}

.dark-heresy.chat.roll.impmal-test .details-table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 4px;
  font-size: 12px;
}

.dark-heresy.chat.roll.impmal-test .details-table tbody tr {
  transition: background-color 0.2s ease;
  background: transparent !important;
}

.dark-heresy.chat.roll.impmal-test .details-table tbody tr:nth-child(even),
.dark-heresy.chat.roll.impmal-test .details-table tbody tr:nth-child(odd) {
  background: transparent !important;
}

.dark-heresy.chat.roll.impmal-test .details-table tbody tr:last-child {
  border-bottom: none;
}

.dark-heresy.chat.roll.impmal-test .details-table td {
  padding: 4px 8px;
  vertical-align: top;
}

.dark-heresy.chat.roll.impmal-test .details-table td.label {
  color: rgba(220, 220, 220, 0.7);
  font-weight: 500;
  font-family: "MinionPro", serif;
  width: 40%;
  text-align: right;
  padding-right: 12px;
  font-size: 11px;
  white-space: nowrap;
}

.dark-heresy.chat.roll.impmal-test .details-table td.value {
  color: rgba(240, 240, 240, 0.95);
  font-family: "MinionPro", serif;
  font-size: 12px;
  text-align: left;
  padding-left: 8px;
  background: transparent !important;
}

.dark-heresy.chat.roll.impmal-test .details-table td.label {
  background: transparent !important;
}

.dark-heresy.chat.roll.impmal-test .details-table td.value.error-text {
  color: #e74c3c;
  font-weight: 600;
}

.dark-heresy.chat.roll.impmal-test .details-table td.value a.dh-chat-target {
  color: #e74c3c;
  font-weight: 600;
  text-decoration: none;
  transition: color 0.2s ease;
}

.dark-heresy.chat.roll.impmal-test .details-table td.value a.dh-chat-target:hover {
  color: #ff6b6b;
  text-decoration: underline;
}

.dark-heresy.chat.roll.impmal-test .effect-buttons {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 4px;
  margin-top: 6px;
  animation: fadeIn 0.4s ease-out 0.5s both;
}

.dark-heresy.chat.roll.impmal-test .effect-buttons button {
  flex: 1 1 auto;
  min-width: 100px;
  height: 28px;
  background: linear-gradient(135deg, rgba(37, 100, 75, 0.8) 0%, rgba(25, 68, 51, 0.9) 100%);
  color: #dcdcdc;
  font-family: "Novarese", serif;
  font-size: 11px;
  font-weight: 600;
  border: 1px solid rgba(55, 179, 107, 0.3);
  border-radius: 4px;
  text-transform: uppercase;
  letter-spacing: 0.8px;
  transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  padding: 0 10px;
  cursor: pointer;
  position: relative;
  overflow: hidden;
  backdrop-filter: blur(4px);
}

.dark-heresy.chat.roll.impmal-test .effect-buttons button::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  border-radius: 50%;
  background: rgba(55, 179, 107, 0.2);
  transform: translate(-50%, -50%);
  transition: width 0.4s ease, height 0.4s ease;
}

.dark-heresy.chat.roll.impmal-test .effect-buttons button:hover::before {
  width: 300px;
  height: 300px;
}

.dark-heresy.chat.roll.impmal-test .effect-buttons button:hover {
  background: linear-gradient(135deg, rgba(55, 179, 107, 0.9) 0%, rgba(37, 100, 75, 0.95) 100%);
  border-color: var(--impmal-lightgreen);
  box-shadow: 0 4px 12px rgba(55, 179, 107, 0.4);
  transform: translateY(-2px);
  color: #fff;
}

.dark-heresy.chat.roll.impmal-test .effect-buttons button:active {
  transform: translateY(0);
  box-shadow: 0 2px 6px rgba(55, 179, 107, 0.3);
}

.dark-heresy.chat.roll.impmal-test .effect-buttons button span {
  position: relative;
  z-index: 1;
}

/* Damage card styles - compact and minimalistic */
/* Fire Effect Card - compact and clear design */
.dark-heresy.chat.fire-effect.impmal-test {
  font-size: 12px;
  animation: fadeIn 0.3s ease-out;
  padding: 0;
  margin: 4px 0;
}

.dark-heresy.chat.fire-effect.impmal-test .roll-card-background {
  padding: 6px 10px;
}

.dark-heresy.chat.fire-effect.impmal-test h1 {
  font-family: var(--font-header);
  font-size: 13px;
  color: var(--impmal-lightgreen);
  margin: 0 0 8px 0;
  text-align: center;
  text-transform: uppercase;
  letter-spacing: 1px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
}

.dark-heresy.chat.fire-effect.impmal-test h1 i {
  color: #ff6b35;
  font-size: 14px;
}

/* Compact effects grid */
.dark-heresy.chat.fire-effect.impmal-test .fire-effects-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 6px;
  margin-bottom: 8px;
}

.dark-heresy.chat.fire-effect.impmal-test .fire-effect-item {
  background: rgba(11, 74, 80, 0.2);
  border: 1px solid rgba(55, 179, 107, 0.3);
  border-radius: 4px;
  padding: 5px 6px;
  display: flex;
  align-items: flex-start;
  gap: 6px;
}

.dark-heresy.chat.fire-effect.impmal-test .fire-effect-item.damage {
  border-color: rgba(255, 107, 53, 0.4);
}

.dark-heresy.chat.fire-effect.impmal-test .fire-effect-item.fatigue {
  border-color: rgba(255, 165, 0, 0.4);
}

.dark-heresy.chat.fire-effect.impmal-test .effect-icon {
  flex-shrink: 0;
  width: 20px;
  height: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
}

.dark-heresy.chat.fire-effect.impmal-test .fire-effect-item.damage .effect-icon {
  color: #ff6b35;
}

.dark-heresy.chat.fire-effect.impmal-test .fire-effect-item.fatigue .effect-icon {
  color: var(--impmal-orange);
}

.dark-heresy.chat.fire-effect.impmal-test .effect-content {
  flex: 1;
  min-width: 0;
}

.dark-heresy.chat.fire-effect.impmal-test .effect-label {
  color: var(--impmal-lightgreen);
  font-weight: bold;
  font-size: 9px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 2px;
  line-height: 1.2;
}

.dark-heresy.chat.fire-effect.impmal-test .effect-value {
  display: flex;
  align-items: baseline;
  gap: 4px;
  margin: 2px 0;
  flex-wrap: wrap;
}

.dark-heresy.chat.fire-effect.impmal-test .value-main {
  font-size: 16px;
  font-weight: bold;
  font-family: var(--font-header);
  line-height: 1;
}

.dark-heresy.chat.fire-effect.impmal-test .fire-effect-item.damage .value-main {
  color: #ff6b35;
}

.dark-heresy.chat.fire-effect.impmal-test .fire-effect-item.fatigue .value-main {
  color: var(--impmal-orange);
}

.dark-heresy.chat.fire-effect.impmal-test .value-type,
.dark-heresy.chat.fire-effect.impmal-test .value-total {
  font-size: 9px;
  color: var(--impmal-grey2);
  line-height: 1;
}

.dark-heresy.chat.fire-effect.impmal-test .effect-note {
  display: flex;
  align-items: center;
  gap: 3px;
  font-size: 8px;
  color: var(--impmal-grey2);
  margin-top: 2px;
}

.dark-heresy.chat.fire-effect.impmal-test .effect-note i {
  font-size: 9px;
  color: var(--impmal-lightblue);
}

/* Willpower test section */
.dark-heresy.chat.fire-effect.impmal-test .willpower-test-section {
  margin-top: 6px;
  padding-top: 6px;
  border-top: 1px solid rgba(55, 179, 107, 0.2);
}

.dark-heresy.chat.fire-effect.impmal-test .test-label {
  color: var(--impmal-lightgreen);
  font-weight: bold;
  font-size: 10px;
  text-transform: uppercase;
  text-align: center;
  margin-bottom: 4px;
  letter-spacing: 0.5px;
}


.dark-heresy.chat.roll.impmal-test.damage-card {
  font-size: 12px;
  animation: fadeIn 0.3s ease-out;
  padding: 0;
  margin: 0;
}

.dark-heresy.chat.roll.impmal-test.damage-card .roll-card-background {
  padding: 6px 10px;
}

.dark-heresy.chat.roll.impmal-test.damage-card h1 {
  margin: 0 0 4px 0;
  padding: 4px 8px;
  font-size: 11px;
  background: rgba(55, 179, 107, 0.15);
  border-radius: 3px;
  border: 1px solid rgba(55, 179, 107, 0.3);
  text-align: center;
}

.dark-heresy.chat.roll.impmal-test.damage-card .damage-target {
  text-align: center;
  margin: 3px 0;
  padding: 2px 0;
  font-size: 11px;
  color: rgba(240, 240, 240, 0.9);
}

.dark-heresy.chat.roll.impmal-test.damage-card .damage-target strong {
  color: rgba(220, 220, 220, 0.7);
  margin-right: 4px;
  font-size: 10px;
}

.dark-heresy.chat.roll.impmal-test.damage-card .damage-target a.dh-chat-target {
  color: #e74c3c;
  font-weight: 600;
  text-decoration: none;
  transition: color 0.2s ease;
  font-size: 11px;
}

.dark-heresy.chat.roll.impmal-test.damage-card .damage-target a.dh-chat-target:hover {
  color: #ff6b6b;
  text-decoration: underline;
}

.dark-heresy.chat.roll.impmal-test.damage-card .damage-section {
  margin: 4px 0;
  animation: fadeIn 0.4s ease-out 0.2s both;
}

.dark-heresy.chat.roll.impmal-test.damage-card .damage-section h3.damage-location {
  font-family: "Novarese", serif;
  font-size: 10px;
  font-weight: 600;
  text-align: center;
  text-transform: uppercase;
  letter-spacing: 0.8px;
  color: rgba(55, 179, 107, 0.9);
  margin: 0 0 3px 0;
  padding: 2px 0;
  border-bottom: 1px solid rgba(55, 179, 107, 0.2);
}

.dark-heresy.chat.roll.impmal-test.damage-card .damage-values {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 4px;
  margin: 2px 0;
}

.dark-heresy.chat.roll.impmal-test.damage-card .damage-value-box {
  flex: 1 1 auto;
  min-width: 70px;
  padding: 4px 6px;
  border: 1px solid rgba(55, 179, 107, 0.3);
  border-radius: 4px;
  background: linear-gradient(135deg, rgba(0, 0, 0, 0.4) 0%, rgba(20, 20, 20, 0.5) 100%);
  text-align: center;
  backdrop-filter: blur(4px);
  transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
}

.dark-heresy.chat.roll.impmal-test.damage-card .damage-value-box:hover {
  transform: translateY(-1px);
  border-color: rgba(55, 179, 107, 0.5);
  box-shadow: 0 2px 8px rgba(55, 179, 107, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1);
}

.dark-heresy.chat.roll.impmal-test.damage-card .damage-value-box.special {
  border-color: rgba(231, 76, 60, 0.4);
  background: linear-gradient(135deg, rgba(231, 76, 60, 0.1) 0%, rgba(139, 0, 0, 0.15) 100%);
}

.dark-heresy.chat.roll.impmal-test.damage-card .damage-value-box.special:hover {
  border-color: rgba(231, 76, 60, 0.6);
  box-shadow: 0 2px 8px rgba(231, 76, 60, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1);
}

.dark-heresy.chat.roll.impmal-test.damage-card .damage-label {
  font-size: 8px;
  color: rgba(220, 220, 220, 0.6);
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.6px;
  margin-bottom: 2px;
  font-family: "MinionPro", serif;
}

.dark-heresy.chat.roll.impmal-test.damage-card .damage-total,
.dark-heresy.chat.roll.impmal-test.damage-card .damage-penetration,
.dark-heresy.chat.roll.impmal-test.damage-card .damage-righteous-fury {
  font-size: 18px;
  font-weight: 700;
  color: var(--impmal-lightgreen);
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
  margin: 1px 0;
  font-family: "Novarese", serif;
  line-height: 1.2;
}

.dark-heresy.chat.roll.impmal-test.damage-card .damage-righteous-fury {
  color: #e74c3c;
}

.dark-heresy.chat.roll.impmal-test.damage-card .damage-type {
  font-size: 8px;
  color: rgba(55, 179, 107, 0.8);
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.4px;
  margin-top: 1px;
  font-family: "MinionPro", serif;
}

.dark-heresy.chat.roll.impmal-test.damage-card .applied-damage-section {
  margin-top: 4px;
  animation: fadeIn 0.4s ease-out 0.3s both;
}

.dark-heresy.chat.roll.impmal-test.damage-card .applied-damage-section summary.section-title {
  font-family: "Novarese", serif;
  font-size: 10px;
  font-weight: 600;
  text-align: center;
  text-transform: uppercase;
  letter-spacing: 0.8px;
  color: rgba(55, 179, 107, 0.9);
  margin: 0 0 4px 0;
  padding: 3px 0;
  border-bottom: 1px solid rgba(55, 179, 107, 0.2);
  cursor: pointer;
  list-style: none;
  user-select: none;
  transition: color 0.2s ease;
}

.dark-heresy.chat.roll.impmal-test.damage-card .applied-damage-section summary.section-title::-webkit-details-marker {
  display: none;
}

.dark-heresy.chat.roll.impmal-test.damage-card .applied-damage-section summary.section-title::marker {
  display: none;
}

.dark-heresy.chat.roll.impmal-test.damage-card .applied-damage-section summary.section-title::before {
  content: '▶';
  display: inline-block;
  margin-right: 6px;
  font-size: 8px;
  transition: transform 0.2s ease;
  color: rgba(55, 179, 107, 0.7);
}

.dark-heresy.chat.roll.impmal-test.damage-card .applied-damage-section[open] summary.section-title::before {
  transform: rotate(90deg);
}

.dark-heresy.chat.roll.impmal-test.damage-card .applied-damage-section summary.section-title:hover {
  color: var(--impmal-lightgreen);
}

.dark-heresy.chat.roll.impmal-test.damage-card .applied-damage-content {
  margin-top: 4px;
  padding: 2px 0;
}

.dark-heresy.chat.roll.impmal-test.damage-card .applied-damage-line {
  display: flex;
  align-items: center;
  justify-content: center;
  flex-wrap: wrap;
  gap: 6px;
  padding: 3px 0;
  font-size: 12px;
  font-family: "MinionPro", serif;
  color: rgba(240, 240, 240, 0.95);
  line-height: 1.4;
  text-align: center;
}

.dark-heresy.chat.roll.impmal-test.damage-card .applied-summary {
  margin-top: 4px;
  padding-top: 4px;
  border-top: 1px solid rgba(55, 179, 107, 0.2);
}

.dark-heresy.chat.roll.impmal-test.damage-card .applied-damage-line.summary {
  margin-top: 0;
  padding-top: 0;
  border-top: none;
}

.dark-heresy.chat.roll.impmal-test.damage-card .applied-damage-line .damage-amount {
  font-weight: 700;
  color: var(--impmal-lightgreen);
  font-size: 13px;
}

.dark-heresy.chat.roll.impmal-test.damage-card .applied-damage-line .damage-type-text {
  font-weight: 500;
  color: rgba(55, 179, 107, 0.9);
  text-transform: capitalize;
}

.dark-heresy.chat.roll.impmal-test.damage-card .applied-damage-line .damage-source {
  font-weight: 500;
  color: rgba(220, 220, 220, 0.8);
}

.dark-heresy.chat.roll.impmal-test.damage-card .applied-damage-line .damage-location-text {
  font-weight: 400;
  color: rgba(200, 200, 200, 0.7);
  font-style: italic;
}

.dark-heresy.chat.roll.impmal-test.damage-card .applied-damage-line .damage-label {
  font-weight: 500;
  color: rgba(220, 220, 220, 0.7);
  margin-right: 4px;
}

.dark-heresy.chat.roll.impmal-test.damage-card .applied-damage-line .damage-value {
  font-weight: 600;
  color: var(--impmal-lightgreen);
  margin-right: 12px;
}

.dark-heresy.chat.roll.impmal-test.damage-card .effect-buttons {
  margin-top: 4px;
  gap: 3px;
}

.dark-heresy.chat.roll.impmal-test.damage-card .effect-buttons button {
  height: 24px;
  font-size: 10px;
  padding: 0 8px;
  min-width: 80px;
}

/* Mass Evasion Roll styles - same minimalistic design */
.dark-heresy.chat.roll.impmal-test.mass-evasion-card {
  font-size: 12px;
  animation: fadeIn 0.3s ease-out;
  padding: 0;
  margin: 0;
}

.dark-heresy.chat.roll.impmal-test.mass-evasion-card .roll-card-background {
  padding: 6px 10px;
}

.dark-heresy.chat.roll.impmal-test.mass-evasion-card h1 {
  margin: 0 0 6px 0;
  padding: 4px 8px;
  font-size: 11px;
  background: rgba(55, 179, 107, 0.15);
  border-radius: 3px;
  border: 1px solid rgba(55, 179, 107, 0.3);
  text-align: center;
}

.dark-heresy.chat.roll.impmal-test.mass-evasion-card .mass-evasion-header {
  display: flex;
  justify-content: center;
  gap: 12px;
  margin: 4px 0 6px 0;
  flex-wrap: wrap;
}

.dark-heresy.chat.roll.impmal-test.mass-evasion-card .mass-evasion-info {
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: 11px;
}

.dark-heresy.chat.roll.impmal-test.mass-evasion-card .mass-evasion-info .info-label {
  color: rgba(220, 220, 220, 0.7);
  font-weight: 500;
  font-family: "MinionPro", serif;
}

.dark-heresy.chat.roll.impmal-test.mass-evasion-card .mass-evasion-info .info-value {
  color: rgba(240, 240, 240, 0.95);
  font-weight: 600;
  font-family: "MinionPro", serif;
}

.dark-heresy.chat.roll.impmal-test.mass-evasion-card .mass-results {
  display: flex;
  flex-direction: column;
  gap: 4px;
  margin-top: 4px;
}

.dark-heresy.chat.roll.impmal-test.mass-evasion-card .mass-result-card {
  padding: 6px 8px;
  border: 1px solid rgba(55, 179, 107, 0.2);
  border-radius: 4px;
  background: linear-gradient(135deg, rgba(0, 0, 0, 0.3) 0%, rgba(20, 20, 20, 0.4) 100%);
  backdrop-filter: blur(4px);
  animation: fadeIn 0.4s ease-out both;
  transition: all 0.2s ease;
}

.dark-heresy.chat.roll.impmal-test.mass-evasion-card .mass-result-card:nth-child(1) {
  animation-delay: 0.1s;
}

.dark-heresy.chat.roll.impmal-test.mass-evasion-card .mass-result-card:nth-child(2) {
  animation-delay: 0.15s;
}

.dark-heresy.chat.roll.impmal-test.mass-evasion-card .mass-result-card:nth-child(3) {
  animation-delay: 0.2s;
}

.dark-heresy.chat.roll.impmal-test.mass-evasion-card .mass-result-card:nth-child(n+4) {
  animation-delay: 0.25s;
}

.dark-heresy.chat.roll.impmal-test.mass-evasion-card .mass-result-card.failure {
  border-color: rgba(55, 179, 107, 0.2);
  background: linear-gradient(135deg, rgba(0, 0, 0, 0.3) 0%, rgba(20, 20, 20, 0.4) 100%);
}

.dark-heresy.chat.roll.impmal-test.mass-evasion-card .mass-result-card:hover {
  border-color: rgba(55, 179, 107, 0.4);
  transform: translateY(-1px);
  box-shadow: 0 2px 8px rgba(55, 179, 107, 0.2);
}

.dark-heresy.chat.roll.impmal-test.mass-evasion-card .mass-result-card.failure:hover {
  border-color: rgba(55, 179, 107, 0.4);
  box-shadow: 0 2px 8px rgba(55, 179, 107, 0.2);
}

.dark-heresy.chat.roll.impmal-test.mass-evasion-card .mass-result-header {
  margin-bottom: 4px;
}

.dark-heresy.chat.roll.impmal-test.mass-evasion-card .mass-target-name {
  text-align: center;
  margin-bottom: 3px;
}

.dark-heresy.chat.roll.impmal-test.mass-evasion-card .mass-target-name a.dh-chat-target {
  color: #e74c3c;
  font-weight: 600;
  text-decoration: none;
  font-size: 11px;
  transition: color 0.2s ease;
}

.dark-heresy.chat.roll.impmal-test.mass-evasion-card .mass-target-name a.dh-chat-target:hover {
  color: #ff6b6b;
  text-decoration: underline;
}

.dark-heresy.chat.roll.impmal-test.mass-evasion-card .mass-result-comparison {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  margin: 3px 0;
}

.dark-heresy.chat.roll.impmal-test.mass-evasion-card .mass-roll-value,
.dark-heresy.chat.roll.impmal-test.mass-evasion-card .mass-target-value {
  font-size: 18px;
  font-weight: 700;
  color: rgba(232, 232, 232, 0.85);
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
  font-family: "Novarese", serif;
}

.dark-heresy.chat.roll.impmal-test.mass-evasion-card .mass-vs {
  font-size: 10px;
  color: rgba(55, 179, 107, 0.6);
  font-weight: 600;
  letter-spacing: 0.5px;
}

.dark-heresy.chat.roll.impmal-test.mass-evasion-card .mass-result-sl {
  display: flex;
  flex-direction: column;
  align-items: center;
  margin: 4px 0;
  gap: 2px;
}

.dark-heresy.chat.roll.impmal-test.mass-evasion-card .mass-sl-value {
  font-size: 20px;
  font-weight: 700;
  color: var(--impmal-lightgreen);
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
  font-family: "Novarese", serif;
  padding: 2px 0;
  min-width: 40px;
  text-align: center;
}

.dark-heresy.chat.roll.impmal-test.mass-evasion-card .mass-sl-value.failure {
  color: #e74c3c;
}

.dark-heresy.chat.roll.impmal-test.mass-evasion-card .mass-outcome {
  font-size: 10px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.8px;
  font-family: "MinionPro", serif;
}

.dark-heresy.chat.roll.impmal-test.mass-evasion-card .mass-outcome.success {
  color: rgba(55, 179, 107, 0.9);
}

.dark-heresy.chat.roll.impmal-test.mass-evasion-card .mass-outcome.failure {
  color: rgba(231, 76, 60, 0.9);
}

.dark-heresy.chat.roll.impmal-test.mass-evasion-card .mass-result-details {
  margin-top: 4px;
}

.dark-heresy.chat.roll.impmal-test.mass-evasion-card .mass-result-details .details-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 10px;
}

.dark-heresy.chat.roll.impmal-test.mass-evasion-card .mass-result-details .details-table tbody tr {
  background: transparent !important;
}

.dark-heresy.chat.roll.impmal-test.mass-evasion-card .mass-result-details .details-table td {
  padding: 1px 4px;
  vertical-align: top;
  background: transparent !important;
}

.dark-heresy.chat.roll.impmal-test.mass-evasion-card .mass-result-details .details-table td.label {
  color: rgba(220, 220, 220, 0.7);
  font-weight: 500;
  font-family: "MinionPro", serif;
  width: 40%;
  text-align: right;
  padding-right: 8px;
  font-size: 11px;
  white-space: nowrap;
}

.dark-heresy.chat.roll.impmal-test.mass-evasion-card .mass-result-details .details-table td.value {
  color: rgba(240, 240, 240, 0.95);
  font-family: "MinionPro", serif;
  font-size: 12px;
  text-align: left;
  padding-left: 6px;
}

.dark-heresy.chat .mass-subtitle {
  margin-bottom: 6px;
  color: #F0F0F0;
  font-family: "MinionPro", serif;
  font-size: 12px;
  line-height: 1.5;
}
.dark-heresy.chat .mass-results {
  display: flex;
  flex-direction: column;
  gap: 4px;
}
.dark-heresy.chat .mass-result {
  padding: 6px 10px;
  border: 1px solid var(--impmal-lightgreen);
  border-radius: 0;
  background: rgba(0, 0, 0, 0.4);
  margin-bottom: 4px;
}
.dark-heresy.chat .mass-target {
  font-size: 15px;
  font-family: "Novarese", serif;
  font-weight: bold;
  text-align: center;
  margin-bottom: 5px;
  color: #dcdcdc;
  text-transform: uppercase;
  letter-spacing: 0.8px;
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.8);
}
.dark-heresy.chat .mass-loc-row {
  text-align: center;
  font-size: 13px;
  font-family: "Novarese", serif;
  font-weight: bold;
  margin: 5px 0;
  background-image: url(../assets/ui/name-bg.webp);
  background-size: 100% 100%;
  background-repeat: no-repeat;
  background-color: rgba(43, 27, 16, 1);
  padding: 6px 12px;
  color: #dcdcdc;
  text-transform: uppercase;
  letter-spacing: 0.8px;
  text-shadow: 2px 2px 6px rgba(0, 0, 0, 1), 1px 1px 2px rgba(0, 0, 0, 1), 0 0 10px rgba(0, 0, 0, 0.95);
  border: none;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  filter: contrast(1.1);
}
.dark-heresy.chat .mass-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  column-gap: 8px;
  row-gap: 2px;
  align-items: center;
}
.dark-heresy.chat .mass-field {
  display: flex;
  justify-content: space-between;
  font-size: 13px;
  font-family: "MinionPro", serif;
  padding: 2px 0;
  line-height: 1.5;
}
.dark-heresy.chat .mass-label {
  color: #E8E8E8;
  font-family: "MinionPro", serif;
  font-size: 13px;
}
.dark-heresy.chat .mass-value {
  font-weight: bold;
  color: #dcdcdc;
  font-family: "MinionPro", serif;
  font-size: 13px;
}
.dark-heresy.chat .mass-summary {
  grid-column: 1 / -1;
  text-align: center;
  font-size: 12px;
  margin-top: 4px;
  color: #F0F0F0;
  font-family: "MinionPro", serif;
  line-height: 1.5;
}
.dark-heresy.chat .mass-outcome {
  text-align: center;
  font-size: 16px;
  font-family: "Novarese", serif;
  margin-bottom: 4px;
  text-transform: uppercase;
  letter-spacing: 1px;
  font-weight: bold;
}
.dark-heresy.chat .mass-outcome.neutral {
  color: var(--impmal-grey);
}
.dark-heresy.chat .mass-detail {
  text-align: center;
  font-size: 12px;
  font-family: "MinionPro", serif;
  color: #F0F0F0;
  margin-top: 4px;
  line-height: 1.5;
}
.dark-heresy.chat .mass-list {
  margin: 4px 0 6px;
  padding-left: 18px;
  text-align: left;
}
.dark-heresy.chat .mass-damage-line {
  display: flex;
  justify-content: space-between;
  gap: 8px;
}
.dark-heresy.chat .mass-damage-main {
  flex: 1 1 auto;
}
.dark-heresy.chat .mass-pen {
  flex: 0 0 auto;
  color: #3b2b1e;
  font-weight: bold;
}
.dark-heresy.chat .mass-actions button {
  width: 100%;
  height: 26px;
  margin-top: 4px;
  font-size: 12px;
}
.dark-heresy.chat .dh-notice-card {
  font-family: "MinionPro", serif;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.5);
  padding: 8px 12px;
  background: rgba(37, 100, 75, 0.6);
  background-image: url(../assets/ui/space.webp);
  background-size: cover;
  background-blend-mode: overlay;
  border: 2px double var(--impmal-darkgreen);
  border-radius: 0;
  text-align: center;
  color: #F0F0F0;
  margin: 0 0 6px 0;
  font-size: 13px;
  line-height: 1.5;
}
.dark-heresy.chat .dh-notice-title {
  font-size: 16px;
  font-family: "Novarese", serif;
  font-weight: bold;
  letter-spacing: 1px;
  text-transform: uppercase;
  color: #dcdcdc;
  background-image: url(../assets/ui/name-bg.webp);
  background-size: 100% 100%;
  background-repeat: no-repeat;
  background-color: rgba(43, 27, 16, 1);
  padding: 8px 12px;
  margin: 0 0 8px 0;
  text-shadow: 2px 2px 6px rgba(0, 0, 0, 1), 1px 1px 2px rgba(0, 0, 0, 1), 0 0 12px rgba(0, 0, 0, 0.95);
  border: none;
  border-bottom: none;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  filter: contrast(1.1);
}
.dark-heresy.chat .dh-notice-body {
  font-size: 13px;
  font-family: "MinionPro", serif;
  line-height: 1.5;
  color: #F0F0F0;
}
.dark-heresy.chat .dh-notice-button {
  width: 100%;
  margin-top: 6px;
  padding: 4px 8px;
  font-size: 12px;
  font-family: "Novarese", serif;
  color: #dcdcdc;
  background-color: var(--impmal-darkgreen);
  border: 1px solid var(--impmal-lightgreen);
  border-radius: 0;
  box-shadow: 0 0 5px var(--impmal-lightgreen) inset;
  cursor: pointer;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  transition: all 0.2s ease;
  height: 26px;
}
.dark-heresy.chat .dh-notice-button:hover {
  background-color: var(--impmal-lightgreen);
  box-shadow: 0 0 8px var(--impmal-lightgreen);
}
.dark-heresy.chat .reload-Weapon {
  width: 100%;
  height: auto;
  font-size: 14px;
}
.dark-heresy.chat .flex-column {
  display: flex;
  flex-direction: row;
  flex-wrap: nowrap;
  flex-basis: 100%;
}
.dark-heresy.dialog {
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  flex-basis: 100%;
}
.dark-heresy.dialog .wrapper {
  display: flex;
  flex-direction: row;
  flex-basis: 100%;
  margin-top: 5px;
  align-items: center;
}
.dark-heresy.dialog .separator {
  flex-basis: 100%;
  padding-top: 5px;
  margin-bottom: 5px;
  border-bottom: 1px solid var(--color-border);
}
.dark-heresy.dialog .wrapper label {
  width: 4em;
}
.dark-heresy.dialog .wrapper input,
.dark-heresy.dialog .wrapper select {
  width: 101px;
  margin-left: 5px;
  text-align: center;
  font-size: 16px;
}
.dark-heresy.dialog .wrapper .range {
  width: 66px;
}
.dark-heresy.dialog .wrapper .rangeBox {
  width: 30px;
}
.dark-heresy .stats {
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  flex-basis: 100%;
}
.dark-heresy .stats .stats-row {
  display: flex;
  flex-basis: 100%;
  margin-top: 8px;
  justify-content: space-between;
}
.dark-heresy .stats .stats-row:last-child {
  margin-bottom: 4px;
}
.dark-heresy .stats .stats-row .stat {
  display: flex;
  align-items: center;
}
.dark-heresy .stats .stats-row .stat {
  display: flex;
}
.dark-heresy .stats .stats-row .stat input,
.dark-heresy .stats .stats-row .stat select {
  margin-left: 8px;
}
.dark-heresy.mental-disorder .notes-editor {
  height: 165px;
  max-height: 165px;
}
.dark-heresy.malignancy .notes-editor {
  height: 165px;
  max-height: 165px;
}
.dark-heresy.mutation .notes-editor {
  height: 165px;
  max-height: 165px;
}
.dark-heresy.talent .notes-editor {
  height: 165px;
  max-height: 165px;
}
/* Modern Talent Stats Section - Complete Redesign */
.dark-heresy.talent .stats {
  display: block;
  padding: 0;
  min-height: auto;
  background: transparent;
}

.dark-heresy.talent .stats h1 {
  margin: 0 0 12px 0;
  padding: 0;
  font-size: 1.1em;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 1px;
  color: rgba(255, 255, 255, 0.95);
  border: none;
  text-align: left;
}

.dark-heresy.talent .stats .form-group {
  display: flex;
  flex-direction: row;
  align-items: center;
  margin: 0 0 10px 0;
  padding: 0;
  gap: 10px;
  border: none;
}

.dark-heresy.talent .stats .form-group:last-child {
  margin-bottom: 0;
}

.dark-heresy.talent .stats .form-group label {
  flex: 0 0 110px;
  font-weight: 500;
  font-size: 0.9em;
  text-align: left;
  padding: 0;
  margin: 0;
  color: rgba(255, 255, 255, 0.85);
  line-height: 1.5;
}

.dark-heresy.talent .stats .form-group .form-fields {
  flex: 1 1 auto;
  display: flex;
  align-items: center;
  min-width: 0;
  gap: 0;
}

.dark-heresy.talent .stats .form-group .form-fields input {
  flex: 1 1 auto;
  width: 100%;
  min-width: 150px;
  max-width: 100%;
  margin: 0;
  padding: 5px 8px;
  border: 1px solid rgba(255, 255, 255, 0.2);
  background: rgba(0, 0, 0, 0.4);
  border-radius: 2px;
  font-size: 0.9em;
  color: rgba(255, 255, 255, 0.9);
  transition: all 0.15s ease;
}

.dark-heresy.talent .stats .form-group .form-fields input:hover {
  border-color: rgba(255, 255, 255, 0.3);
  background: rgba(0, 0, 0, 0.5);
}

.dark-heresy.talent .stats .form-group .form-fields input:focus {
  border-color: var(--impmal-lightblue);
  background: rgba(0, 0, 0, 0.6);
  outline: none;
  box-shadow: 0 0 0 2px rgba(0, 150, 200, 0.15);
}

.dark-heresy.talent .stats .form-group:has(input[type="number"]) .form-fields {
  flex: 0 0 auto;
}

.dark-heresy.talent .stats .form-group:has(input[type="number"]) .form-fields input {
  width: 55px;
  min-width: 55px;
  max-width: 55px;
  text-align: center;
  flex: 0 0 55px;
}
.dark-heresy.trait .notes-editor {
  height: 165px;
  max-height: 165px;
}
.dark-heresy.trait .stats {
  height: 165px;
  align-content: baseline;
}
.dark-heresy.trait .stats .stats-row .stat.benefit input {
  width: 428px;
}
.dark-heresy.special-ability .notes-editor {
  height: 165px;
  max-height: 165px;
}
.dark-heresy.special-ability .stats {
  height: 165px;
  align-content: baseline;
}
.dark-heresy.special-ability .stats .stats-row .stat.benefit input {
  width: 428px;
}
.dark-heresy.psychic-power .notes-editor {
  height: 193px;
  max-height: 193px;
}

/* Modern Psychic Power Stats Section - Complete Redesign */
.dark-heresy.psychic-power .stats {
  display: block;
  padding: 0;
  min-height: auto;
  background: transparent;
}

.dark-heresy.psychic-power .stats h1 {
  margin: 0 0 12px 0;
  padding: 0;
  font-size: 1.1em;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 1px;
  color: rgba(255, 255, 255, 0.95);
  border: none;
  text-align: left;
}

.dark-heresy.psychic-power .stats .form-group {
  display: flex;
  flex-direction: row;
  align-items: center;
  margin: 0 0 10px 0;
  padding: 0;
  gap: 10px;
  border: none;
}

.dark-heresy.psychic-power .stats .form-group:last-child {
  margin-bottom: 0;
}

.dark-heresy.psychic-power .stats .form-group label {
  flex: 0 0 140px;
  font-weight: 500;
  font-size: 0.9em;
  text-align: left;
  padding: 0;
  margin: 0;
  color: rgba(255, 255, 255, 0.85);
  line-height: 1.5;
}

.dark-heresy.psychic-power .stats .form-group .form-fields {
  flex: 1 1 auto;
  display: flex;
  align-items: center;
  min-width: 0;
  gap: 6px;
}

.dark-heresy.psychic-power .stats .form-group .form-fields input {
  flex: 1 1 auto;
  width: 100%;
  min-width: 0;
  max-width: 100%;
  margin: 0;
  padding: 5px 8px;
  border: 1px solid rgba(255, 255, 255, 0.2);
  background: rgba(0, 0, 0, 0.4);
  border-radius: 2px;
  font-size: 0.9em;
  color: rgba(255, 255, 255, 0.9);
  transition: all 0.15s ease;
}

.dark-heresy.psychic-power .stats .form-group .form-fields input:hover {
  border-color: rgba(255, 255, 255, 0.3);
  background: rgba(0, 0, 0, 0.5);
}

.dark-heresy.psychic-power .stats .form-group .form-fields input:focus {
  border-color: var(--impmal-lightblue);
  background: rgba(0, 0, 0, 0.6);
  outline: none;
  box-shadow: 0 0 0 2px rgba(0, 150, 200, 0.15);
}

.dark-heresy.psychic-power .stats .form-group .form-fields select {
  flex: 0 0 auto;
  min-width: 120px;
  max-width: 200px;
  margin: 0;
  padding: 5px 8px;
  border: 1px solid rgba(255, 255, 255, 0.2);
  background: rgba(0, 0, 0, 0.4);
  border-radius: 2px;
  font-size: 0.9em;
  color: rgba(255, 255, 255, 0.9);
  transition: all 0.15s ease;
}

.dark-heresy.psychic-power .stats .form-group .form-fields select:hover {
  border-color: rgba(255, 255, 255, 0.3);
  background: rgba(0, 0, 0, 0.5);
}

.dark-heresy.psychic-power .stats .form-group .form-fields select:focus {
  border-color: var(--impmal-lightblue);
  background: rgba(0, 0, 0, 0.6);
  outline: none;
  box-shadow: 0 0 0 2px rgba(0, 150, 200, 0.15);
}

.dark-heresy.psychic-power .stats .form-group .form-fields select option {
  background: rgba(20, 20, 25, 0.95);
  color: rgba(255, 255, 255, 0.9);
  padding: 6px 8px;
}

.dark-heresy.psychic-power .stats .form-group .form-fields select option:hover,
.dark-heresy.psychic-power .stats .form-group .form-fields select option:focus {
  background: rgba(0, 150, 200, 0.3);
  color: rgba(255, 255, 255, 1);
}

.dark-heresy.psychic-power .stats .form-group .form-fields select option:checked {
  background: rgba(0, 150, 200, 0.4);
  color: rgba(255, 255, 255, 1);
}

/* Стили для заблокированных опций в select */
.dark-heresy.dialog select option:disabled,
.dark-heresy select option:disabled,
.dark-heresy select option.disabled-option {
    opacity: 0.4 !important;
    color: #888 !important;
    background-color: #2a2a2a !important;
    cursor: not-allowed !important;
    font-style: italic;
    text-decoration: line-through;
}

.dark-heresy.dialog select option:disabled:hover,
.dark-heresy select option:disabled:hover,
.dark-heresy select option.disabled-option:hover {
    background-color: #2a2a2a !important;
    opacity: 0.5 !important;
    cursor: not-allowed !important;
}

/* Общие стили для всех select option в системе */
.dark-heresy select option {
  background: rgba(20, 20, 25, 0.95) !important;
  color: rgba(255, 255, 255, 0.9) !important;
  padding: 6px 8px;
}

.dark-heresy select option:hover,
.dark-heresy select option:focus {
  background: rgba(0, 150, 200, 0.3) !important;
  color: rgba(255, 255, 255, 1) !important;
}

.dark-heresy select option:checked {
  background: rgba(0, 150, 200, 0.4) !important;
  color: rgba(255, 255, 255, 1) !important;
}

/* Focus Power - two inputs side by side */
.dark-heresy.psychic-power .stats .form-group:has(.form-fields input[type="number"] + input[type="text"]) .form-fields input[type="number"] {
  flex: 0 0 50px;
  min-width: 50px;
  max-width: 50px;
  text-align: center;
}

.dark-heresy.psychic-power .stats .form-group:has(.form-fields input[type="number"] + input[type="text"]) .form-fields input[type="text"] {
  flex: 0 0 120px;
  min-width: 120px;
  max-width: 120px;
}

/* Damage - formula input + type select */
.dark-heresy.psychic-power .stats .form-group:has(.form-fields input + select) .form-fields input {
  flex: 0 0 100px;
  min-width: 100px;
  max-width: 100px;
}

.dark-heresy.psychic-power .stats .form-group:has(.form-fields input + select) .form-fields select {
  flex: 0 0 120px;
  min-width: 120px;
  max-width: 120px;
}

/* Number inputs - smaller width */
.dark-heresy.psychic-power .stats .form-group:has(input[type="number"]:only-child) .form-fields input {
  flex: 0 0 60px;
  min-width: 60px;
  max-width: 60px;
  text-align: center;
}
.dark-heresy.critical-injury .notes-editor {
  height: 165px;
  max-height: 165px;
}
.dark-heresy.critical-injury .header .part,
.dark-heresy.critical-injury .header .type {
  flex-basis: 50%;
}
.dark-heresy.critical-injury .header .part select,
.dark-heresy.critical-injury .header .type select {
  margin: 0 8px;
}
.dark-heresy.weapon .notes-editor {
  height: 165px;
  max-height: 165px;
}
/* Modern Weapon Stats Section - Complete Redesign */
.dark-heresy.weapon .stats {
  display: block;
  padding: 0;
  min-height: auto;
  background: transparent;
}

.dark-heresy.weapon .stats h1 {
  margin: 0 0 12px 0;
  padding: 0;
  font-size: 1.1em;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 1px;
  color: rgba(255, 255, 255, 0.95);
  border: none;
  text-align: left;
}

.dark-heresy.weapon .stats .form-group {
  display: flex;
  flex-direction: row;
  align-items: center;
  margin: 0 0 10px 0;
  padding: 0;
  gap: 10px;
  border: none;
}

.dark-heresy.weapon .stats .form-group:last-child {
  margin-bottom: 0;
}

.dark-heresy.weapon .stats .form-group label {
  flex: 0 0 140px;
  font-weight: 500;
  font-size: 0.9em;
  text-align: left;
  padding: 0;
  margin: 0;
  color: rgba(255, 255, 255, 0.85);
  line-height: 1.5;
}

.dark-heresy.weapon .stats .form-group .form-fields {
  flex: 1 1 auto;
  display: flex;
  align-items: center;
  min-width: 0;
  gap: 6px;
}

.dark-heresy.weapon .stats .form-group .form-fields input {
  flex: 1 1 auto;
  width: 100%;
  min-width: 0;
  max-width: 100%;
  margin: 0;
  padding: 5px 8px;
  border: 1px solid rgba(255, 255, 255, 0.2);
  background: rgba(0, 0, 0, 0.4);
  border-radius: 2px;
  font-size: 0.9em;
  color: rgba(255, 255, 255, 0.9);
  transition: all 0.15s ease;
}

.dark-heresy.weapon .stats .form-group .form-fields input:hover {
  border-color: rgba(255, 255, 255, 0.3);
  background: rgba(0, 0, 0, 0.5);
}

.dark-heresy.weapon .stats .form-group .form-fields input:focus {
  border-color: var(--impmal-lightblue);
  background: rgba(0, 0, 0, 0.6);
  outline: none;
  box-shadow: 0 0 0 2px rgba(0, 150, 200, 0.15);
}

.dark-heresy.weapon .stats .form-group .form-fields select {
  flex: 0 0 auto;
  min-width: 120px;
  max-width: 200px;
  margin: 0;
  padding: 5px 8px;
  border: 1px solid rgba(255, 255, 255, 0.2);
  background: rgba(0, 0, 0, 0.4);
  border-radius: 2px;
  font-size: 0.9em;
  color: rgba(255, 255, 255, 0.9);
  transition: all 0.15s ease;
}

.dark-heresy.weapon .stats .form-group .form-fields select:hover {
  border-color: rgba(255, 255, 255, 0.3);
  background: rgba(0, 0, 0, 0.5);
}

.dark-heresy.weapon .stats .form-group .form-fields select:focus {
  border-color: var(--impmal-lightblue);
  background: rgba(0, 0, 0, 0.6);
  outline: none;
  box-shadow: 0 0 0 2px rgba(0, 150, 200, 0.15);
}

.dark-heresy.weapon .stats .form-group .form-fields .separator {
  flex: 0 0 auto;
  color: rgba(255, 255, 255, 0.6);
  font-size: 0.9em;
  padding: 0 2px;
  user-select: none;
}

/* Number inputs - smaller width */
.dark-heresy.weapon .stats .form-group:has(input[type="number"]:only-child) .form-fields input {
  flex: 0 0 60px;
  min-width: 60px;
  max-width: 60px;
  text-align: center;
}

/* Clip - two number inputs with separator */
.dark-heresy.weapon .stats .form-group:has(input[name*="clip"]) .form-fields input[type="number"] {
  flex: 0 0 50px;
  min-width: 50px;
  max-width: 50px;
  text-align: center;
}

/* Rate of Fire - three number inputs with separators */
.dark-heresy.weapon .stats .form-group:has(input[name*="rateOfFire"]) .form-fields input[type="number"] {
  flex: 0 0 45px;
  min-width: 45px;
  max-width: 45px;
  text-align: center;
}

/* Damage - formula input + type select */
.dark-heresy.weapon .stats .form-group:has(.form-fields input + select) .form-fields input {
  flex: 0 0 100px;
  min-width: 100px;
  max-width: 100px;
}

.dark-heresy.weapon .stats .form-group:has(.form-fields input + select) .form-fields select {
  flex: 0 0 120px;
  min-width: 120px;
  max-width: 120px;
}
.dark-heresy.armour .notes-editor {
  height: 165px;
  max-height: 165px;
}
/* Modern Armour Stats Section - Complete Redesign */
.dark-heresy.armour .stats {
  display: block;
  padding: 0;
  min-height: auto;
  background: transparent;
}

.dark-heresy.armour .stats h1 {
  margin: 0 0 12px 0;
  padding: 0;
  font-size: 1.1em;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 1px;
  color: rgba(255, 255, 255, 0.95);
  border: none;
  text-align: left;
}

.dark-heresy.armour .stats .form-group {
  display: flex;
  flex-direction: row;
  align-items: center;
  margin: 0 0 10px 0;
  padding: 0;
  gap: 10px;
  border: none;
}

.dark-heresy.armour .stats .form-group:last-child {
  margin-bottom: 0;
}

.dark-heresy.armour .stats .form-group label {
  flex: 0 0 140px;
  font-weight: 500;
  font-size: 0.9em;
  text-align: left;
  padding: 0;
  margin: 0;
  color: rgba(255, 255, 255, 0.85);
  line-height: 1.5;
}

.dark-heresy.armour .stats .form-group .form-fields {
  flex: 1 1 auto;
  display: flex;
  align-items: center;
  min-width: 0;
  gap: 6px;
}

.dark-heresy.armour .stats .form-group .form-fields input {
  flex: 1 1 auto;
  width: 100%;
  min-width: 0;
  max-width: 100%;
  margin: 0;
  padding: 5px 8px;
  border: 1px solid rgba(255, 255, 255, 0.2);
  background: rgba(0, 0, 0, 0.4);
  border-radius: 2px;
  font-size: 0.9em;
  color: rgba(255, 255, 255, 0.9);
  transition: all 0.15s ease;
}

.dark-heresy.armour .stats .form-group .form-fields input:hover {
  border-color: rgba(255, 255, 255, 0.3);
  background: rgba(0, 0, 0, 0.5);
}

.dark-heresy.armour .stats .form-group .form-fields input:focus {
  border-color: var(--impmal-lightblue);
  background: rgba(0, 0, 0, 0.6);
  outline: none;
  box-shadow: 0 0 0 2px rgba(0, 150, 200, 0.15);
}

.dark-heresy.armour .stats .form-group .form-fields select {
  flex: 0 0 auto;
  min-width: 120px;
  max-width: 200px;
  margin: 0;
  padding: 5px 8px;
  border: 1px solid rgba(255, 255, 255, 0.2);
  background: rgba(0, 0, 0, 0.4);
  border-radius: 2px;
  font-size: 0.9em;
  color: rgba(255, 255, 255, 0.9);
  transition: all 0.15s ease;
}

.dark-heresy.armour .stats .form-group .form-fields select:hover {
  border-color: rgba(255, 255, 255, 0.3);
  background: rgba(0, 0, 0, 0.5);
}

.dark-heresy.armour .stats .form-group .form-fields select:focus {
  border-color: var(--impmal-lightblue);
  background: rgba(0, 0, 0, 0.6);
  outline: none;
  box-shadow: 0 0 0 2px rgba(0, 150, 200, 0.15);
}

.dark-heresy.armour .stats .form-group .form-fields input[type="checkbox"] {
  flex: 0 0 auto;
  width: 18px;
  height: 18px;
  min-width: 18px;
  max-width: 18px;
  margin: 0;
  cursor: pointer;
}

/* Number inputs - smaller width */
.dark-heresy.armour .stats .form-group:has(input[type="number"]:only-child) .form-fields input {
  flex: 0 0 60px;
  min-width: 60px;
  max-width: 60px;
  text-align: center;
}
/* Modern Ammunition, Gear, Drug, Tool, Cybernetic Stats Section - Complete Redesign */
.dark-heresy.ammunition .stats,
.dark-heresy.gear .stats,
.dark-heresy.drug .stats,
.dark-heresy.tool .stats,
.dark-heresy.cybernetic .stats {
  display: block;
  padding: 0;
  min-height: auto;
  background: transparent;
}

.dark-heresy.ammunition .stats h1,
.dark-heresy.gear .stats h1,
.dark-heresy.drug .stats h1,
.dark-heresy.tool .stats h1,
.dark-heresy.cybernetic .stats h1 {
  margin: 0 0 12px 0;
  padding: 0;
  font-size: 1.1em;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 1px;
  color: rgba(255, 255, 255, 0.95);
  border: none;
  text-align: left;
}

.dark-heresy.ammunition .stats .form-group,
.dark-heresy.gear .stats .form-group,
.dark-heresy.drug .stats .form-group,
.dark-heresy.tool .stats .form-group,
.dark-heresy.cybernetic .stats .form-group {
  display: flex;
  flex-direction: row;
  align-items: center;
  margin: 0 0 10px 0;
  padding: 0;
  gap: 10px;
  border: none;
}

.dark-heresy.ammunition .stats .form-group:last-child,
.dark-heresy.gear .stats .form-group:last-child,
.dark-heresy.drug .stats .form-group:last-child,
.dark-heresy.tool .stats .form-group:last-child,
.dark-heresy.cybernetic .stats .form-group:last-child {
  margin-bottom: 0;
}

.dark-heresy.ammunition .stats .form-group label,
.dark-heresy.gear .stats .form-group label,
.dark-heresy.drug .stats .form-group label,
.dark-heresy.tool .stats .form-group label,
.dark-heresy.cybernetic .stats .form-group label {
  flex: 0 0 140px;
  font-weight: 500;
  font-size: 0.9em;
  text-align: left;
  padding: 0;
  margin: 0;
  color: rgba(255, 255, 255, 0.85);
  line-height: 1.5;
}

.dark-heresy.ammunition .stats .form-group .form-fields,
.dark-heresy.gear .stats .form-group .form-fields,
.dark-heresy.drug .stats .form-group .form-fields,
.dark-heresy.tool .stats .form-group .form-fields,
.dark-heresy.cybernetic .stats .form-group .form-fields {
  flex: 1 1 auto;
  display: flex;
  align-items: center;
  min-width: 0;
  gap: 6px;
}

.dark-heresy.ammunition .stats .form-group .form-fields input,
.dark-heresy.gear .stats .form-group .form-fields input,
.dark-heresy.drug .stats .form-group .form-fields input,
.dark-heresy.tool .stats .form-group .form-fields input,
.dark-heresy.cybernetic .stats .form-group .form-fields input {
  flex: 1 1 auto;
  width: 100%;
  min-width: 0;
  max-width: 100%;
  margin: 0;
  padding: 5px 8px;
  border: 1px solid rgba(255, 255, 255, 0.2);
  background: rgba(0, 0, 0, 0.4);
  border-radius: 2px;
  font-size: 0.9em;
  color: rgba(255, 255, 255, 0.9);
  transition: all 0.15s ease;
}

.dark-heresy.ammunition .stats .form-group .form-fields input:hover,
.dark-heresy.gear .stats .form-group .form-fields input:hover,
.dark-heresy.drug .stats .form-group .form-fields input:hover,
.dark-heresy.tool .stats .form-group .form-fields input:hover,
.dark-heresy.cybernetic .stats .form-group .form-fields input:hover {
  border-color: rgba(255, 255, 255, 0.3);
  background: rgba(0, 0, 0, 0.5);
}

.dark-heresy.ammunition .stats .form-group .form-fields input:focus,
.dark-heresy.gear .stats .form-group .form-fields input:focus,
.dark-heresy.drug .stats .form-group .form-fields input:focus,
.dark-heresy.tool .stats .form-group .form-fields input:focus,
.dark-heresy.cybernetic .stats .form-group .form-fields input:focus {
  border-color: var(--impmal-lightblue);
  background: rgba(0, 0, 0, 0.6);
  outline: none;
  box-shadow: 0 0 0 2px rgba(0, 150, 200, 0.15);
}

.dark-heresy.ammunition .stats .form-group .form-fields select,
.dark-heresy.gear .stats .form-group .form-fields select,
.dark-heresy.drug .stats .form-group .form-fields select,
.dark-heresy.tool .stats .form-group .form-fields select,
.dark-heresy.cybernetic .stats .form-group .form-fields select {
  flex: 0 0 auto;
  min-width: 120px;
  max-width: 200px;
  margin: 0;
  padding: 5px 8px;
  border: 1px solid rgba(255, 255, 255, 0.2);
  background: rgba(0, 0, 0, 0.4);
  border-radius: 2px;
  font-size: 0.9em;
  color: rgba(255, 255, 255, 0.9);
  transition: all 0.15s ease;
}

.dark-heresy.ammunition .stats .form-group .form-fields select:hover,
.dark-heresy.gear .stats .form-group .form-fields select:hover,
.dark-heresy.drug .stats .form-group .form-fields select:hover,
.dark-heresy.tool .stats .form-group .form-fields select:hover,
.dark-heresy.cybernetic .stats .form-group .form-fields select:hover {
  border-color: rgba(255, 255, 255, 0.3);
  background: rgba(0, 0, 0, 0.5);
}

.dark-heresy.ammunition .stats .form-group .form-fields select:focus,
.dark-heresy.gear .stats .form-group .form-fields select:focus,
.dark-heresy.drug .stats .form-group .form-fields select:focus,
.dark-heresy.tool .stats .form-group .form-fields select:focus,
.dark-heresy.cybernetic .stats .form-group .form-fields select:focus {
  border-color: var(--impmal-lightblue);
  background: rgba(0, 0, 0, 0.6);
  outline: none;
  box-shadow: 0 0 0 2px rgba(0, 150, 200, 0.15);
}

.dark-heresy.ammunition .stats .form-group .form-fields input[type="checkbox"],
.dark-heresy.gear .stats .form-group .form-fields input[type="checkbox"],
.dark-heresy.drug .stats .form-group .form-fields input[type="checkbox"],
.dark-heresy.tool .stats .form-group .form-fields input[type="checkbox"],
.dark-heresy.cybernetic .stats .form-group .form-fields input[type="checkbox"] {
  flex: 0 0 auto;
  width: 18px;
  height: 18px;
  min-width: 18px;
  max-width: 18px;
  margin: 0;
  cursor: pointer;
}

/* Number inputs - smaller width */
.dark-heresy.ammunition .stats .form-group:has(input[type="number"]:only-child) .form-fields input,
.dark-heresy.gear .stats .form-group:has(input[type="number"]:only-child) .form-fields input,
.dark-heresy.drug .stats .form-group:has(input[type="number"]:only-child) .form-fields input,
.dark-heresy.tool .stats .form-group:has(input[type="number"]:only-child) .form-fields input,
.dark-heresy.cybernetic .stats .form-group:has(input[type="number"]:only-child) .form-fields input {
  flex: 0 0 60px;
  min-width: 60px;
  max-width: 60px;
  text-align: center;
}

/* Ammunition - Damage input + type select */
.dark-heresy.ammunition .stats .form-group:has(.form-fields input + select) .form-fields input {
  flex: 0 0 100px;
  min-width: 100px;
  max-width: 100px;
}

.dark-heresy.ammunition .stats .form-group:has(.form-fields input + select) .form-fields select {
  flex: 0 0 120px;
  min-width: 120px;
  max-width: 120px;
}

.dark-heresy.gear .notes-editor {
  height: 165px;
  max-height: 165px;
}
.dark-heresy.drug .notes-editor {
  height: 165px;
  max-height: 165px;
}
.dark-heresy.tool .notes-editor {
  height: 165px;
  max-height: 165px;
}
.dark-heresy.cybernetic .notes-editor {
  height: 165px;
  max-height: 165px;
}
.dark-heresy.weapon-modification .notes-editor {
  height: 165px;
  max-height: 165px;
}
/* Modern Weapon Modification Stats Section - Complete Redesign */
.dark-heresy.weapon-modification .stats {
  display: block;
  padding: 0;
  min-height: auto;
  background: transparent;
}

.dark-heresy.weapon-modification .stats h1 {
  margin: 0 0 12px 0;
  padding: 0;
  font-size: 1.1em;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 1px;
  color: rgba(255, 255, 255, 0.95);
  border: none;
  text-align: left;
}

.dark-heresy.weapon-modification .stats .form-group {
  display: flex;
  flex-direction: row;
  align-items: center;
  margin: 0 0 10px 0;
  padding: 0;
  gap: 10px;
  border: none;
}

.dark-heresy.weapon-modification .stats .form-group:last-child {
  margin-bottom: 0;
}

.dark-heresy.weapon-modification .stats .form-group label {
  flex: 0 0 140px;
  font-weight: 500;
  font-size: 0.9em;
  text-align: left;
  padding: 0;
  margin: 0;
  color: rgba(255, 255, 255, 0.85);
  line-height: 1.5;
}

.dark-heresy.weapon-modification .stats .form-group .form-fields {
  flex: 1 1 auto;
  display: flex;
  align-items: center;
  min-width: 0;
  gap: 6px;
}

.dark-heresy.weapon-modification .stats .form-group .form-fields input {
  flex: 1 1 auto;
  width: 100%;
  min-width: 0;
  max-width: 100%;
  margin: 0;
  padding: 5px 8px;
  border: 1px solid rgba(255, 255, 255, 0.2);
  background: rgba(0, 0, 0, 0.4);
  border-radius: 2px;
  font-size: 0.9em;
  color: rgba(255, 255, 255, 0.9);
  transition: all 0.15s ease;
}

.dark-heresy.weapon-modification .stats .form-group .form-fields input:hover {
  border-color: rgba(255, 255, 255, 0.3);
  background: rgba(0, 0, 0, 0.5);
}

.dark-heresy.weapon-modification .stats .form-group .form-fields input:focus {
  border-color: var(--impmal-lightblue);
  background: rgba(0, 0, 0, 0.6);
  outline: none;
  box-shadow: 0 0 0 2px rgba(0, 150, 200, 0.15);
}

.dark-heresy.weapon-modification .stats .form-group .form-fields select {
  flex: 0 0 auto;
  min-width: 120px;
  max-width: 200px;
  margin: 0;
  padding: 5px 8px;
  border: 1px solid rgba(255, 255, 255, 0.2);
  background: rgba(0, 0, 0, 0.4);
  border-radius: 2px;
  font-size: 0.9em;
  color: rgba(255, 255, 255, 0.9);
  transition: all 0.15s ease;
}

.dark-heresy.weapon-modification .stats .form-group .form-fields select:hover {
  border-color: rgba(255, 255, 255, 0.3);
  background: rgba(0, 0, 0, 0.5);
}

.dark-heresy.weapon-modification .stats .form-group .form-fields select:focus {
  border-color: var(--impmal-lightblue);
  background: rgba(0, 0, 0, 0.6);
  outline: none;
  box-shadow: 0 0 0 2px rgba(0, 150, 200, 0.15);
}

.dark-heresy.weapon-modification .stats .form-group .form-fields input[type="checkbox"] {
  flex: 0 0 auto;
  width: 18px;
  height: 18px;
  min-width: 18px;
  max-width: 18px;
  margin: 0;
  cursor: pointer;
}

/* Number inputs - smaller width */
.dark-heresy.weapon-modification .stats .form-group:has(input[type="number"]:only-child) .form-fields input {
  flex: 0 0 60px;
  min-width: 60px;
  max-width: 60px;
  text-align: center;
}
.dark-heresy.ammunition .notes-editor {
  height: 165px;
  max-height: 165px;
}
.dark-heresy.force-field .notes-editor {
  height: 165px;
  max-height: 165px;
}
/* Modern Force Field Stats Section - Complete Redesign */
.dark-heresy.force-field .stats {
  display: block;
  padding: 0;
  min-height: auto;
  background: transparent;
}

.dark-heresy.force-field .stats h1 {
  margin: 0 0 12px 0;
  padding: 0;
  font-size: 1.1em;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 1px;
  color: rgba(255, 255, 255, 0.95);
  border: none;
  text-align: left;
}

.dark-heresy.force-field .stats .form-group {
  display: flex;
  flex-direction: row;
  align-items: center;
  margin: 0 0 10px 0;
  padding: 0;
  gap: 10px;
  border: none;
}

.dark-heresy.force-field .stats .form-group:last-child {
  margin-bottom: 0;
}

.dark-heresy.force-field .stats .form-group label {
  flex: 0 0 140px;
  font-weight: 500;
  font-size: 0.9em;
  text-align: left;
  padding: 0;
  margin: 0;
  color: rgba(255, 255, 255, 0.85);
  line-height: 1.5;
}

.dark-heresy.force-field .stats .form-group .form-fields {
  flex: 1 1 auto;
  display: flex;
  align-items: center;
  min-width: 0;
  gap: 6px;
}

.dark-heresy.force-field .stats .form-group .form-fields input {
  flex: 1 1 auto;
  width: 100%;
  min-width: 0;
  max-width: 100%;
  margin: 0;
  padding: 5px 8px;
  border: 1px solid rgba(255, 255, 255, 0.2);
  background: rgba(0, 0, 0, 0.4);
  border-radius: 2px;
  font-size: 0.9em;
  color: rgba(255, 255, 255, 0.9);
  transition: all 0.15s ease;
}

.dark-heresy.force-field .stats .form-group .form-fields input:hover {
  border-color: rgba(255, 255, 255, 0.3);
  background: rgba(0, 0, 0, 0.5);
}

.dark-heresy.force-field .stats .form-group .form-fields input:focus {
  border-color: var(--impmal-lightblue);
  background: rgba(0, 0, 0, 0.6);
  outline: none;
  box-shadow: 0 0 0 2px rgba(0, 150, 200, 0.15);
}

.dark-heresy.force-field .stats .form-group .form-fields select {
  flex: 0 0 auto;
  min-width: 120px;
  max-width: 200px;
  margin: 0;
  padding: 5px 8px;
  border: 1px solid rgba(255, 255, 255, 0.2);
  background: rgba(0, 0, 0, 0.4);
  border-radius: 2px;
  font-size: 0.9em;
  color: rgba(255, 255, 255, 0.9);
  transition: all 0.15s ease;
}

.dark-heresy.force-field .stats .form-group .form-fields select:hover {
  border-color: rgba(255, 255, 255, 0.3);
  background: rgba(0, 0, 0, 0.5);
}

.dark-heresy.force-field .stats .form-group .form-fields select:focus {
  border-color: var(--impmal-lightblue);
  background: rgba(0, 0, 0, 0.6);
  outline: none;
  box-shadow: 0 0 0 2px rgba(0, 150, 200, 0.15);
}

/* Number inputs - smaller width */
.dark-heresy.force-field .stats .form-group:has(input[type="number"]:only-child) .form-fields input {
  flex: 0 0 60px;
  min-width: 60px;
  max-width: 60px;
  text-align: center;
}
.dark-heresy.weapon .notes-editor,
.dark-heresy.ammunition .notes-editor,
.dark-heresy.weapon-modification .notes-editor,
.dark-heresy.armour .notes-editor,
.dark-heresy.force-field .notes-editor,
.dark-heresy.cybernetic .notes-editor,
.dark-heresy.drug .notes-editor,
.dark-heresy.gear .notes-editor,
.dark-heresy.tool .notes-editor,
.dark-heresy.critical-injury .notes-editor,
.dark-heresy.malignancy .notes-editor,
.dark-heresy.mental-disorder .notes-editor,
.dark-heresy.mutation .notes-editor,
.dark-heresy.psychic-power .notes-editor,
.dark-heresy.talent .notes-editor,
.dark-heresy.special-ability .notes-editor,
.dark-heresy.trait .notes-editor,
.dark-heresy.aptitude .notes-editor {
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 8px;
  box-sizing: border-box;
  min-height: 200px;
  height: auto !important;
  max-height: none !important;
}
.dark-heresy .notes-editor .notes-editor-body {
  width: 100%;
  height: 520px;
  min-height: 340px;
  max-height: 520px;
  display: flex;
  flex-direction: column;
  flex: 1 1 auto;
  overflow: hidden;
}
.dark-heresy.weapon .notes-editor > div,
.dark-heresy.ammunition .notes-editor > div,
.dark-heresy.weapon-modification .notes-editor > div,
.dark-heresy.armour .notes-editor > div,
.dark-heresy.force-field .notes-editor > div,
.dark-heresy.cybernetic .notes-editor > div,
.dark-heresy.drug .notes-editor > div,
.dark-heresy.gear .notes-editor > div,
.dark-heresy.tool .notes-editor > div,
.dark-heresy.critical-injury .notes-editor > div,
.dark-heresy.malignancy .notes-editor > div,
.dark-heresy.mental-disorder .notes-editor > div,
.dark-heresy.mutation .notes-editor > div,
.dark-heresy.psychic-power .notes-editor > div,
.dark-heresy.talent .notes-editor > div,
.dark-heresy.special-ability .notes-editor > div,
.dark-heresy.trait .notes-editor > div,
.dark-heresy.aptitude .notes-editor > div {
  width: 100%;
  height: 520px !important;
  min-height: 340px;
  max-height: 520px;
}
/* Вернуть внутренний скролл в редакторе, но увеличить базовый размер */
.dark-heresy .notes-editor .editor,
.dark-heresy .notes-editor .editor-content,
.dark-heresy .notes-editor .editor-content.ProseMirror {
  width: 100%;
  height: 100% !important;
  min-height: 340px;
  max-height: 520px !important;
  overflow-y: auto !important;
  box-sizing: border-box;
}
.dark-heresy .notes-editor {
  overflow: hidden;
}
.dark-heresy .notes-editor .editor {
  display: flex;
  flex-direction: column;
  flex: 1 1 auto;
}
.dark-heresy .notes-editor .editor-content,
.dark-heresy .notes-editor .editor-content.ProseMirror {
  flex: 1 1 auto;
  max-height: 520px !important;
  overflow-y: auto !important;
}
/* Принудительный скролл именно на ProseMirror */
.dark-heresy .notes-editor .editor-content.ProseMirror {
  overflow-y: auto !important;
}

/* Scripts Editor Styles */
.dark-heresy .scripts-editor {
  display: flex;
  flex-direction: column;
  flex: 1 1 auto;
  min-height: 0;
  padding: 5px;
  overflow: hidden;
}

.dark-heresy .scripts-editor h1 {
  margin: 0 0 8px 0;
  padding: 0;
  font-size: 1.1em;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 1px;
  color: rgba(255, 255, 255, 0.95);
  border: none;
  text-align: left;
}

.dark-heresy .scripts-editor-body {
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  min-height: 0;
  overflow: hidden;
}

.dark-heresy .scripts-textarea {
  flex: 1 1 auto;
  width: 100%;
  min-height: 300px;
  padding: 10px;
  margin: 0;
  border: 1px solid rgba(255, 255, 255, 0.2);
  background: rgba(0, 0, 0, 0.6);
  border-radius: 2px;
  font-family: 'Courier New', 'Consolas', 'Monaco', monospace;
  font-size: 0.9em;
  line-height: 1.5;
  color: rgba(255, 255, 255, 0.9);
  resize: vertical;
  transition: all 0.15s ease;
  white-space: pre;
  overflow-wrap: normal;
  overflow-x: auto;
}

.dark-heresy .scripts-textarea:hover {
  border-color: rgba(255, 255, 255, 0.3);
  background: rgba(0, 0, 0, 0.7);
}

.dark-heresy .scripts-textarea:focus {
  border-color: var(--impmal-lightblue);
  background: rgba(0, 0, 0, 0.8);
  outline: none;
  box-shadow: 0 0 0 2px rgba(0, 150, 200, 0.15);
}

.dark-heresy .scripts-textarea::placeholder {
  color: rgba(255, 255, 255, 0.4);
  font-style: italic;
}
.dark-heresy.weapon .notes-editor .editor,
.dark-heresy.weapon .notes-editor .editor-content,
.dark-heresy.ammunition .notes-editor .editor,
.dark-heresy.ammunition .notes-editor .editor-content,
.dark-heresy.weapon-modification .notes-editor .editor,
.dark-heresy.weapon-modification .notes-editor .editor-content,
.dark-heresy.armour .notes-editor .editor,
.dark-heresy.armour .notes-editor .editor-content,
.dark-heresy.force-field .notes-editor .editor,
.dark-heresy.force-field .notes-editor .editor-content,
.dark-heresy.cybernetic .notes-editor .editor,
.dark-heresy.cybernetic .notes-editor .editor-content,
.dark-heresy.drug .notes-editor .editor,
.dark-heresy.drug .notes-editor .editor-content,
.dark-heresy.gear .notes-editor .editor,
.dark-heresy.gear .notes-editor .editor-content,
.dark-heresy.tool .notes-editor .editor,
.dark-heresy.tool .notes-editor .editor-content,
.dark-heresy.critical-injury .notes-editor .editor,
.dark-heresy.critical-injury .notes-editor .editor-content,
.dark-heresy.malignancy .notes-editor .editor,
.dark-heresy.malignancy .notes-editor .editor-content,
.dark-heresy.mental-disorder .notes-editor .editor,
.dark-heresy.mental-disorder .notes-editor .editor-content,
.dark-heresy.mutation .notes-editor .editor,
.dark-heresy.mutation .notes-editor .editor-content,
.dark-heresy.psychic-power .notes-editor .editor,
.dark-heresy.psychic-power .notes-editor .editor-content,
.dark-heresy.talent .notes-editor .editor,
.dark-heresy.talent .notes-editor .editor-content,
.dark-heresy.special-ability .notes-editor .editor,
.dark-heresy.special-ability .notes-editor .editor-content,
.dark-heresy.trait .notes-editor .editor,
.dark-heresy.trait .notes-editor .editor-content,
.dark-heresy.aptitude .notes-editor .editor,
.dark-heresy.aptitude .notes-editor .editor-content {
  height: auto;
  min-height: 180px;
  overflow: visible;
}
.dark-heresy.weapon .sheet-body,
.dark-heresy.ammunition .sheet-body,
.dark-heresy.weapon-modification .sheet-body,
.dark-heresy.armour .sheet-body,
.dark-heresy.force-field .sheet-body,
.dark-heresy.cybernetic .sheet-body,
.dark-heresy.drug .sheet-body,
.dark-heresy.gear .sheet-body,
.dark-heresy.tool .sheet-body,
.dark-heresy.critical-injury .sheet-body,
.dark-heresy.malignancy .sheet-body,
.dark-heresy.mental-disorder .sheet-body,
.dark-heresy.mutation .sheet-body,
.dark-heresy.psychic-power .sheet-body,
.dark-heresy.talent .sheet-body,
.dark-heresy.special-ability .sheet-body,
.dark-heresy.trait .sheet-body,
.dark-heresy.aptitude .sheet-body {
  overflow-y: auto;
}
.dark-heresy.critical-injury .stats .stats-row,
.dark-heresy.malignancy .stats .stats-row,
.dark-heresy.mental-disorder .stats .stats-row,
.dark-heresy.mutation .stats .stats-row,
.dark-heresy.special-ability .stats .stats-row,
.dark-heresy.trait .stats .stats-row,
.dark-heresy.aptitude .stats .stats-row {
  flex-wrap: wrap;
  gap: 10px;
  justify-content: flex-start;
}
.dark-heresy.critical-injury .stats .stats-row .stat,
.dark-heresy.malignancy .stats .stats-row .stat,
.dark-heresy.mental-disorder .stats .stats-row .stat,
.dark-heresy.mutation .stats .stats-row .stat,
.dark-heresy.special-ability .stats .stats-row .stat,
.dark-heresy.trait .stats .stats-row .stat,
.dark-heresy.aptitude .stats .stats-row .stat {
  flex: 1 1 180px;
  min-width: 160px;
}
.dark-heresy.force-field .stats .stats-row .stat.availability select {
  width: 8em;
}
.dark-heresy .tabs .item {
  padding: 5px;
  font-size: 18px;
}
.dark-heresy .tabs .item.active {
  text-shadow: 0 0 10px var(--color-highlight);
}
.dark-heresy .tab {
  height: 100%;
  width: 100%;
}

/* Для psychic-power: notes открывается по умолчанию */
.dark-heresy .psychic-power .tab {
  display: none;
}

.dark-heresy .psychic-power .tab.active,
.dark-heresy .psychic-power .tab[data-tab="notes"] {
  display: block;
}
.dark-heresy .sheet-body {
  overflow: hidden;
  flex-grow: 1;
}
.dark-heresy .editor,
.dark-heresy .editor-content {
  font-family: var(--font-text);
  font-size: 16px;
  color: #e0e0e0;
  height: 100%;
  width: 100%;
}
.dark-heresy .sheet-tabs {
  border-radius: 5px;
  background: rgba(28, 49, 50, 0.9);
  border: 2px solid var(--impmal-lightblue);
  color: #dcdcdc;
  font-family: var(--font-header);
  font-size: 15px;
  font-weight: bold;
  margin: 10px 0;
  padding: 6px 10px;
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.8);
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}
.dark-heresy .sheet-tabs b {
  padding: 6px 12px;
  border-radius: 4px;
  transition: all 0.2s ease;
  cursor: pointer;
}
.dark-heresy .sheet-tabs b:hover {
  background: rgba(6, 92, 99, 0.5);
  text-shadow: 0 0 8px var(--impmal-lightgreen);
}
.dark-heresy .sheet-tabs b.active {
  background: var(--impmal-darkgreen);
  border: 1px solid var(--impmal-lightgreen);
  box-shadow: 0 0 5px var(--impmal-lightgreen) inset;
}
.dark-heresy .item-edit:hover {
  cursor: pointer;
  text-shadow: 0 0 8px var(--color-highlight);
}
.dark-heresy h1 {
  width: 100%;
  min-height: 28px;
  border: 1px solid var(--impmal-lightblue);
  border-radius: 4px;
  font-family: var(--font-header);
  font-size: 18px;
  font-weight: bold;
  line-height: 26px;
  margin: 0 0 8px 0;
  padding: 6px 8px;
  text-align: center;
  text-transform: uppercase;
  background: rgba(28, 49, 50, 0.9);
  color: #dcdcdc;
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.8);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}
.dark-heresy button {
  background: rgba(28, 49, 50, 0.8);
  border: 1px solid var(--impmal-lightblue);
  border-radius: 4px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
  color: #e0e0e0;
  cursor: pointer;
  font-family: var(--font-text);
  font-size: inherit;
  font-weight: 500;
  height: auto;
  line-height: inherit;
  padding: 4px 8px;
  width: auto;
  transition: all 0.2s ease;
}
.dark-heresy button:focus,
.dark-heresy button:hover {
  background: var(--impmal-darkgreen);
  border-color: var(--impmal-lightgreen);
  color: #dcdcdc;
  box-shadow: 0 0 8px rgba(66, 207, 125, 0.4);
}
.dark-heresy label,
.dark-heresy span {
  color: #e0e0e0;
  font-family: var(--font-text);
  font-size: 14px;
  font-weight: normal;
}
.dark-heresy label {
  font-weight: 500;
}
.dark-heresy input[type="number"],
.dark-heresy input[type="text"],
.dark-heresy select,
.dark-heresy textarea {
  background: rgba(220, 220, 220, 0.8);
  border: 1px solid var(--impmal-lightblue);
  border-radius: 4px;
  box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.2);
  color: #191813;
  font-family: var(--font-text);
  font-size: 13px;
  height: auto;
  line-height: 18px;
  padding: 4px 6px;
  width: 100%;
  transition: all 0.2s ease;
}
.dark-heresy input[type="number"] {
  -moz-appearance: textfield;
  appearance: textfield;
  text-align: center;
}
.dark-heresy input[type="number"]::-webkit-outer-spin-button,
.dark-heresy input[type="number"]::-webkit-inner-spin-button {
  -webkit-appearance: none;
  margin: 0;
}
.dark-heresy input[type="number"]:focus,
.dark-heresy input[type="text"]:focus,
.dark-heresy select:focus,
.dark-heresy textarea:focus {
  border: 1px solid var(--impmal-lightgreen);
  box-shadow: 0 0 8px rgba(66, 207, 125, 0.4), inset 0 1px 3px rgba(0, 0, 0, 0.2);
  outline: none;
  color: #191813;
  background: rgba(220, 220, 220, 0.85);
}
.dark-heresy .item-list {
  display: flex;
  flex-direction: column;
  font-family: var(--font-text);
  font-size: 16px;
  line-height: 16px;
  min-height: 0;
  width: 100%;
  scrollbar-width: thin;
  scrollbar-color: #4e4438ff transparent;
}
.dark-heresy .item-list .header {
  width: 100%;
  min-height: 26px;
  border: 1px solid var(--impmal-lightblue);
  border-radius: 4px;
  font-family: var(--font-header);
  font-size: 15px;
  font-weight: bold;
  line-height: 24px;
  margin: 0 0 6px 0;
  padding: 6px 8px;
  text-align: center;
  background: rgba(28, 49, 50, 0.9);
  color: #dcdcdc;
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.8);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
  display: flex;
  align-items: center;
  justify-content: space-between;
}
.dark-heresy .item-list .items {
  overflow-y: scroll;
  width: 100%;
}
.dark-heresy .item-list .items .item {
  align-items: center;
}
.dark-heresy .item-list .fas {
  font-size: 10px;
}
.dark-heresy .item-list .items .item:nth-child(odd) {
  background: rgba(0, 0, 0, 0.15);
}
.dark-heresy .item-list .items .item:nth-child(even) {
  background: rgba(28, 49, 50, 0.1);
}
.dark-heresy .item-list .items .item:hover {
  background: rgba(6, 92, 99, 0.2);
  transition: background 0.2s ease;
}
.dark-heresy .item-list .items .item button:focus,
.dark-heresy .item-list .items .item button:hover {
  background: var(--color-foreground);
}
.dark-heresy .item-list .items .item .image {
  background-size: 20px;
  background-repeat: no-repeat;
  height: 20px;
  width: 20px;
  margin-right: 5px;
}
.dark-heresy.sheet .header input,
.dark-heresy.sheet .header span {
  flex-grow: 1;
  margin: 0 8px;
}
.dark-heresy.sheet .header input:not(.header-row.name input) {
  background-image: url(../assets/ui/title-bg.webp);
  background-size: 100% 100%;
  background-repeat: no-repeat;
  background-color: rgba(220, 220, 220, 0.85);
  color: #b8c3c5;
}
.dark-heresy.sheet .header select {
  background-image: url(../assets/ui/title-bg.webp);
  background-size: 100% 100%;
  background-repeat: no-repeat;
  background-color: rgba(220, 220, 220, 0.85);
  color: #b8c3c5;
}
.dark-heresy.sheet .header .header-row {
  align-items: center;
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  margin: 6px 0;
  gap: 8px;
}
.dark-heresy.sheet .header .header-row.name {
  margin-bottom: 10px;
}
.dark-heresy.sheet .header .header-row.name input {
  font-family: var(--font-header);
  font-size: 20px;
  font-weight: bold;
  text-align: center;
  padding: 6px 10px;
  border: 1px solid var(--impmal-lightblue);
  background-image: url(../assets/ui/title-bg.webp);
  background-size: 100% 100%;
  background-repeat: no-repeat;
  background-color: rgba(220, 220, 220, 0.85);
  color: #dcdcdc;
}
.dark-heresy.sheet .header .avatar {
  background: radial-gradient(closest-side, var(--impmal-darkgreen) 0%, transparent 100%);
  flex: 0 0 auto;
  min-height: 100px;
  width: 100px;
  margin-right: 12px;
  border-radius: 4px;
  border: 2px solid var(--impmal-lightblue);
  padding: 2px;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
}
/* NPC avatar переопределяет общий стиль */
.dark-heresy .npc .header .avatar {
  background: transparent !important;
}
.dark-heresy.sheet .header .avatar img {
  border: 0 none;
  border-radius: 2px;
  display: block;
  max-width: 96px;
  max-height: 96px;
  min-width: 20px;
  min-height: 20px;
  margin: auto;
  object-fit: contain;
}
.dark-heresy.sheet .avatar img:hover {
  box-shadow: 0 0 10px var(--color-highlight);
  cursor: pointer;
}
.dark-heresy.sheet .notes-editor {
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  flex-basis: 100%;
}
.dark-heresy .acolyte {
  display: flex;
  flex-direction: column;
  height: 100%;
  width: 100%;
  background-image: url(../assets/ui/box-background.webp);
  background-size: 100% 100%;
  background-repeat: no-repeat;
  background-position: center;
  position: relative;
}
.dark-heresy .acolyte > * {
  position: relative;
  z-index: 1;
}

/* Acolyte Avatar - скрываем старую обертку */
.dark-heresy .acolyte .header .flex.row .avatar {
  display: none;
}

/* Acolyte Header - логика как в impmal, идентично NPC */
.dark-heresy .acolyte .header .flex.row {
  display: flex;
  flex-direction: row;
  width: 100%;
  flex-wrap: nowrap;
  align-items: flex-start;
  gap: 0;
}

/* Acolyte Avatar - обертка динамически подстраивается под размер изображения */
.dark-heresy .acolyte .header .flex.row .avatar-wrapper {
  flex: 0 0 auto;
  width: auto;
  height: auto;
  max-width: 200px;
  max-height: 200px;
  margin-right: 20px;
  position: relative;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  box-sizing: border-box;
}

.dark-heresy .acolyte .header .flex.row .avatar-wrapper .profile-img,
.dark-heresy .acolyte .header .flex.row .avatar-wrapper img.profile-img {
  width: auto;
  height: auto;
  max-width: 200px;
  max-height: 200px;
  object-fit: contain;
  display: block;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  cursor: pointer;
  box-sizing: border-box;
  position: relative;
  background: transparent;
  border-radius: 0;
  /* Адаптивная рамка - динамически облегает размер изображения */
  outline: 2px solid var(--impmal-lightblue);
  outline-offset: -2px;
}

.dark-heresy .acolyte .header .flex.row .avatar-wrapper .profile-img:hover,
.dark-heresy .acolyte .header .flex.row .avatar-wrapper img.profile-img:hover {
  outline-color: var(--impmal-lightgreen);
  box-shadow: 0 4px 12px rgba(66, 207, 125, 0.3);
  transform: scale(1.02);
}

/* Acolyte Header - современное расположение полей, идентично NPC */
.dark-heresy .acolyte .header .header-row {
  display: flex;
  flex-direction: row;
  align-items: flex-end;
  justify-content: flex-start;
  gap: 12px;
  margin: 0 0 10px 0;
  width: 100%;
  box-sizing: border-box;
}
.dark-heresy .acolyte .header .header-row.name {
  margin-bottom: 14px;
  align-items: center;
}
.dark-heresy .acolyte .header .flex.column.grow {
  flex: 1 1 auto;
  min-width: 0;
  display: flex;
  flex-direction: column;
  margin-left: 0;
  justify-content: flex-start;
}

.dark-heresy .acolyte .header .home-world,
.dark-heresy .acolyte .header .background {
  flex: 1 1 0;
  min-width: 0;
  display: flex;
  flex-direction: column;
  gap: 5px;
  align-items: stretch;
}
.dark-heresy .acolyte .header .role,
.dark-heresy .acolyte .header .elite {
  flex: 1 1 0;
  min-width: 0;
  display: flex;
  flex-direction: column;
  gap: 5px;
  align-items: stretch;
}
.dark-heresy .acolyte .header .home-world label,
.dark-heresy .acolyte .header .background label,
.dark-heresy .acolyte .header .role label,
.dark-heresy .acolyte .header .elite label {
  font-size: 11px;
  font-weight: 600;
  color: #dcdcdc;
  text-transform: uppercase;
  letter-spacing: 1px;
  margin: 0;
  padding: 0;
  line-height: 1.3;
  text-align: left;
}
.dark-heresy .acolyte .header .home-world input,
.dark-heresy .acolyte .header .background input,
.dark-heresy .acolyte .header .role input,
.dark-heresy .acolyte .header .elite input {
  width: 100%;
  min-width: 0;
  height: 30px;
  padding: 6px 10px;
  font-size: 13px;
  font-weight: 500;
  border: 1.5px solid var(--impmal-lightblue);
  border-radius: 5px;
  background-image: url(../assets/ui/title-bg.webp);
  background-size: 100% 100%;
  background-repeat: no-repeat;
  background-color: rgba(220, 220, 220, 0.85);
  color: #b8c3c5;
  box-shadow: 
    0 2px 4px rgba(0, 0, 0, 0.2),
    inset 0 1px 2px rgba(255, 255, 255, 0.1);
  transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  box-sizing: border-box;
}
.dark-heresy .acolyte .header .home-world input:hover,
.dark-heresy .acolyte .header .background input:hover,
.dark-heresy .acolyte .header .role input:hover,
.dark-heresy .acolyte .header .elite input:hover {
  border-color: var(--impmal-lightgreen);
  box-shadow: 
    0 3px 8px rgba(66, 207, 125, 0.3),
    inset 0 1px 2px rgba(255, 255, 255, 0.15);
  transform: translateY(-1px);
}
.dark-heresy .acolyte .header .home-world input:focus,
.dark-heresy .acolyte .header .background input:focus,
.dark-heresy .acolyte .header .role input:focus,
.dark-heresy .acolyte .header .elite input:focus {
  border-color: var(--impmal-lightgreen);
  box-shadow: 
    0 0 0 3px rgba(66, 207, 125, 0.2),
    0 3px 10px rgba(66, 207, 125, 0.4),
    inset 0 1px 2px rgba(255, 255, 255, 0.15);
  outline: none;
  transform: translateY(-1px);
}

/* Acolyte Fate и Fatigue - в строке между Background и Elite, компактные */
.dark-heresy .acolyte .header .header-row.fate-fatigue-row {
  display: flex;
  flex-direction: row;
  align-items: flex-end;
  justify-content: center;
  gap: 12px;
  margin: 0;
  width: 100%;
  box-sizing: border-box;
}

.dark-heresy .acolyte .header .fate,
.dark-heresy .acolyte .header .fatigue {
  flex: 0 0 auto;
  display: flex;
  flex-direction: column;
  gap: 2px;
  align-items: center;
  justify-content: flex-start;
  width: auto;
  min-width: 60px;
  max-width: 70px;
  box-sizing: border-box;
}

.dark-heresy .acolyte .header .fate label,
.dark-heresy .acolyte .header .fatigue label {
  font-size: 8px;
  font-weight: 700;
  color: #dcdcdc;
  text-transform: uppercase;
  letter-spacing: 0.6px;
  text-align: center;
  margin: 0;
  padding: 0;
  line-height: 1;
  width: 100%;
  box-sizing: border-box;
}

/* Контейнер для input полей с разделителем - очень компактный */
.dark-heresy .acolyte .header .fate > div,
.dark-heresy .acolyte .header .fatigue > div {
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: center;
  gap: 3px;
  width: 100%;
  box-sizing: border-box;
}

.dark-heresy .acolyte .header .fate input,
.dark-heresy .acolyte .header .fatigue input {
  flex: 1 1 0;
  min-width: 24px;
  max-width: 28px;
  width: auto;
  height: 18px;
  margin: 0;
  padding: 0 3px;
  text-align: center;
  font-size: 10px;
  font-weight: 700;
  border: 1.5px solid var(--impmal-lightblue);
  border-radius: 2px;
  background-image: url(../assets/ui/title-bg.webp);
  background-size: 100% 100%;
  background-repeat: no-repeat;
  background-color: rgba(220, 220, 220, 0.85);
  color: #dcdcdc;
  box-shadow: 
    0 1px 2px rgba(0, 0, 0, 0.12),
    inset 0 1px 1px rgba(255, 255, 255, 0.06);
  transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  box-sizing: border-box;
  appearance: textfield;
  -moz-appearance: textfield;
}

.dark-heresy .acolyte .header .fate input::-webkit-outer-spin-button,
.dark-heresy .acolyte .header .fate input::-webkit-inner-spin-button,
.dark-heresy .acolyte .header .fatigue input::-webkit-outer-spin-button,
.dark-heresy .acolyte .header .fatigue input::-webkit-inner-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

.dark-heresy .acolyte .header .fate input:hover,
.dark-heresy .acolyte .header .fatigue input:hover {
  border-color: var(--impmal-lightgreen);
  box-shadow: 
    0 2px 6px rgba(66, 207, 125, 0.3),
    inset 0 1px 2px rgba(255, 255, 255, 0.15);
  transform: translateY(-1px);
}

.dark-heresy .acolyte .header .fate input:focus,
.dark-heresy .acolyte .header .fatigue input:focus {
  border-color: var(--impmal-lightgreen);
  box-shadow: 
    0 0 0 3px rgba(66, 207, 125, 0.2),
    0 2px 8px rgba(66, 207, 125, 0.4),
    inset 0 1px 2px rgba(255, 255, 255, 0.15);
  outline: none;
  transform: translateY(-1px);
}

/* Разделитель "/" между полями - очень компактный */
.dark-heresy .acolyte .header .fate span,
.dark-heresy .acolyte .header .fatigue span {
  color: #dcdcdc;
  font-size: 10px;
  font-weight: 600;
  line-height: 1;
  flex: 0 0 auto;
  margin: 0;
  padding: 0;
  opacity: 0.8;
}
.dark-heresy .npc {
  display: flex;
  flex-direction: column;
  height: 100%;
  width: 100%;
  background-image: url(../assets/ui/box-background.webp);
  background-size: 100% 100%;
  background-repeat: no-repeat;
  background-position: center;
  position: relative;
}
.dark-heresy .npc > * {
  position: relative;
  z-index: 1;
}
/* NPC Header - логика как в impmal */
.dark-heresy .npc .header .flex.row {
  display: flex;
  flex-direction: row;
  width: 100%;
  flex-wrap: nowrap;
  align-items: flex-start;
  gap: 0;
}

/* NPC Avatar - обертка динамически подстраивается под размер изображения */
.dark-heresy .npc .header .flex.row .avatar-wrapper {
  flex: 0 0 auto;
  width: auto;
  height: auto;
  max-width: 200px;
  max-height: 200px;
  margin-right: 20px;
  position: relative;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  box-sizing: border-box;
}

.dark-heresy .npc .header .flex.row .avatar-wrapper .profile-img,
.dark-heresy .npc .header .flex.row .avatar-wrapper img.profile-img {
  width: auto;
  height: auto;
  max-width: 200px;
  max-height: 200px;
  object-fit: contain;
  display: block;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  cursor: pointer;
  box-sizing: border-box;
  position: relative;
  background: transparent;
  border-radius: 0;
  /* Адаптивная рамка - динамически облегает размер изображения */
  outline: 2px solid var(--impmal-lightblue);
  outline-offset: -2px;
}

/* Альтернативный подход: используем border-radius который адаптируется */
.dark-heresy .npc .header .flex.row .profile-img:hover,
.dark-heresy .npc .header .flex.row img.profile-img:hover {
  outline-color: var(--impmal-lightgreen);
  box-shadow: 0 4px 12px rgba(66, 207, 125, 0.3);
  transform: scale(1.02);
}
.dark-heresy .npc .header .type,
.dark-heresy .npc .header .faction {
  flex: 1 1 0;
  min-width: 0;
  display: flex;
  flex-direction: column;
  gap: 5px;
  align-items: stretch;
}
.dark-heresy .npc .header .threat-level,
.dark-heresy .npc .header .subfaction {
  flex: 1 1 0;
  min-width: 0;
  display: flex;
  flex-direction: column;
  gap: 5px;
  align-items: stretch;
}
.dark-heresy .npc .header .type label,
.dark-heresy .npc .header .faction label,
.dark-heresy .npc .header .threat-level label,
.dark-heresy .npc .header .subfaction label {
  font-size: 11px;
  font-weight: 600;
  color: #dcdcdc;
  text-transform: uppercase;
  letter-spacing: 1px;
  margin: 0;
  padding: 0;
  line-height: 1.3;
  text-align: left;
}
.dark-heresy .npc .header .fate label,
.dark-heresy .npc .header .fatigue label {
  font-size: 8px;
  font-weight: 700;
  color: #dcdcdc;
  text-transform: uppercase;
  letter-spacing: 0.6px;
  text-align: center;
  margin: 0;
  padding: 0;
  line-height: 1;
  width: 100%;
  box-sizing: border-box;
}
.dark-heresy .npc .header .type select,
.dark-heresy .npc .header .faction input,
.dark-heresy .npc .header .threat-level input,
.dark-heresy .npc .header .subfaction input {
  width: 100%;
  min-width: 0;
  height: 30px;
  padding: 6px 10px;
  font-size: 13px;
  font-weight: 500;
  border: 1.5px solid var(--impmal-lightblue);
  border-radius: 5px;
  background-image: url(../assets/ui/title-bg.webp);
  background-size: 100% 100%;
  background-repeat: no-repeat;
  background-color: rgba(220, 220, 220, 0.85);
  color: #b8c3c5;
  box-shadow: 
    0 2px 4px rgba(0, 0, 0, 0.2),
    inset 0 1px 2px rgba(255, 255, 255, 0.1);
  transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  box-sizing: border-box;
}
/* NPC Type: force muted white in the field itself */
.dark-heresy .npc .header .type select {
  color: #b8c3c5 !important;
}
.dark-heresy .npc .header .type select:hover,
.dark-heresy .npc .header .faction input:hover,
.dark-heresy .npc .header .threat-level input:hover,
.dark-heresy .npc .header .subfaction input:hover {
  border-color: var(--impmal-lightgreen);
  box-shadow: 
    0 3px 8px rgba(66, 207, 125, 0.3),
    inset 0 1px 2px rgba(255, 255, 255, 0.15);
  transform: translateY(-1px);
}
.dark-heresy .npc .header .type select:focus,
.dark-heresy .npc .header .faction input:focus,
.dark-heresy .npc .header .threat-level input:focus,
.dark-heresy .npc .header .subfaction input:focus {
  border-color: var(--impmal-lightgreen);
  box-shadow: 
    0 0 0 3px rgba(66, 207, 125, 0.2),
    0 3px 10px rgba(66, 207, 125, 0.4),
    inset 0 1px 2px rgba(255, 255, 255, 0.15);
  outline: none;
  transform: translateY(-1px);
}
/* Fate и Fatigue - в строке между Faction и Subfaction, очень компактные */
.dark-heresy .npc .header .header-row.fate-fatigue-row {
  display: flex;
  flex-direction: row;
  align-items: flex-end;
  justify-content: center;
  gap: 12px;
  margin: 0;
  width: 100%;
  box-sizing: border-box;
}

.dark-heresy .npc .header .fate,
.dark-heresy .npc .header .fatigue {
  flex: 0 0 auto;
  display: flex;
  flex-direction: column;
  gap: 2px;
  align-items: center;
  justify-content: flex-start;
  width: auto;
  min-width: 60px;
  max-width: 70px;
  box-sizing: border-box;
}

.dark-heresy .npc .header .fate label,
.dark-heresy .npc .header .fatigue label {
  font-size: 8px;
  font-weight: 700;
  color: #dcdcdc;
  text-transform: uppercase;
  letter-spacing: 0.6px;
  text-align: center;
  margin: 0;
  padding: 0;
  line-height: 1;
  width: 100%;
  box-sizing: border-box;
}

/* Контейнер для input полей с разделителем - очень компактный */
.dark-heresy .npc .header .fate > div,
.dark-heresy .npc .header .fatigue > div {
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: center;
  gap: 3px;
  width: 100%;
  box-sizing: border-box;
}

.dark-heresy .npc .header .fate input,
.dark-heresy .npc .header .fatigue input {
  flex: 1 1 0;
  min-width: 24px;
  max-width: 28px;
  width: auto;
  height: 18px;
  margin: 0;
  padding: 0 3px;
  text-align: center;
  font-size: 10px;
  font-weight: 700;
  border: 1.5px solid var(--impmal-lightblue);
  border-radius: 2px;
  background-image: url(../assets/ui/title-bg.webp);
  background-size: 100% 100%;
  background-repeat: no-repeat;
  background-color: rgba(220, 220, 220, 0.85);
  color: #dcdcdc;
  box-shadow: 
    0 1px 2px rgba(0, 0, 0, 0.12),
    inset 0 1px 1px rgba(255, 255, 255, 0.06);
  transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  box-sizing: border-box;
  appearance: textfield;
  -moz-appearance: textfield;
}

.dark-heresy .npc .header .fate input::-webkit-outer-spin-button,
.dark-heresy .npc .header .fate input::-webkit-inner-spin-button,
.dark-heresy .npc .header .fatigue input::-webkit-outer-spin-button,
.dark-heresy .npc .header .fatigue input::-webkit-inner-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

.dark-heresy .npc .header .fate input:hover,
.dark-heresy .npc .header .fatigue input:hover {
  border-color: var(--impmal-lightgreen);
  box-shadow: 
    0 2px 6px rgba(66, 207, 125, 0.3),
    inset 0 1px 2px rgba(255, 255, 255, 0.15);
  transform: translateY(-1px);
}

.dark-heresy .npc .header .fate input:focus,
.dark-heresy .npc .header .fatigue input:focus {
  border-color: var(--impmal-lightgreen);
  box-shadow: 
    0 0 0 3px rgba(66, 207, 125, 0.2),
    0 2px 8px rgba(66, 207, 125, 0.4),
    inset 0 1px 2px rgba(255, 255, 255, 0.15);
  outline: none;
  transform: translateY(-1px);
}

/* Разделитель "/" между полями - очень компактный */
.dark-heresy .npc .header .fate span,
.dark-heresy .npc .header .fatigue span {
  color: #dcdcdc;
  font-size: 10px;
  font-weight: 600;
  line-height: 1;
  flex: 0 0 auto;
  margin: 0;
  padding: 0;
  opacity: 0.8;
}
/* Выравнивание header-row для NPC */
.dark-heresy .npc .header .header-row {
  display: flex;
  flex-direction: row;
  align-items: flex-end;
  justify-content: flex-start;
  gap: 12px;
  margin: 0 0 10px 0;
  width: 100%;
  box-sizing: border-box;
}
.dark-heresy .npc .header .header-row.name {
  margin-bottom: 14px;
  align-items: center;
}
.dark-heresy .npc .header .flex.column.grow {
  flex: 1 1 auto;
  min-width: 0;
  display: flex;
  flex-direction: column;
  margin-left: 0;
  justify-content: flex-start;
}
.dark-heresy .limited-sheet {
  display: flex;
  flex-direction: column;
  height: 100%;
  width: 100%;
}
.dark-heresy .limited-sheet .notes-editor {
  width: 100%;
  height: 100%;
  margin-top: 2px;
}
.dark-heresy .limited-sheet .notes-editor-content {
  height: 90%;
  width: 90%;
}
.dark-heresy .stats .insanities {
  display: flex;
  flex-direction: column;
  flex-wrap: wrap;
  width: calc(23% - 2px);
  margin-right: 2px;
  align-items: center;
}
.dark-heresy .stats .insanities .total {
  font-size: 22px;
  font-weight: bold;
  height: 52px;
  width: 52px;
  margin: 2px;
  border: 2px solid var(--impmal-lightblue);
  border-radius: 4px;
  background: rgba(220, 220, 220, 0.85);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}
.dark-heresy .stats .insanities .information {
  display: flex;
  flex-direction: column;
}
.dark-heresy .stats .insanities .information .roll-insanity {
  height: 26px;
  width: 26px;
  margin: 2px;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0;
  box-sizing: border-box;
  border: 1px solid var(--impmal-lightblue);
  border-radius: 4px;
}
.dark-heresy .stats .insanities .information .roll-insanity i,
.dark-heresy .stats .corruptions .information .roll-corruption i {
  font-size: 14px;
  line-height: 1;
}
.dark-heresy .stats .insanities .information .bonus {
  height: 26px;
  width: 26px;
  margin: 2px;
  text-align: center;
  font-size: 13px;
  border: 1px solid var(--impmal-lightblue);
  border-radius: 4px;
  background: rgba(220, 220, 220, 0.8);
}
.dark-heresy .stats .insanities .item-list .header {
  margin-top: 5px;
}
.dark-heresy .stats .insanities .item-list .header .name {
  flex-basis: 85%;
}
.dark-heresy .stats .insanities .item-list .items .insanity {
  width: 100%;
}
.dark-heresy .stats .insanities .item-list .items {
  max-height: 187px;
  height: 187px;
}
.dark-heresy .stats .insanities .item-list .items .item .name {
  flex-basis: 90%;
  align-items: center;
}
/* Acolyte Stats - специфичные стили */
.dark-heresy .acolyte .stats .characteristics-talents-row {
  display: flex;
  flex-direction: row;
  gap: 12px;
  margin-bottom: 8px;
  align-items: flex-start;
  justify-content: center;
}
/* Скрываем talents в stats для acolyte (обработчик идет в abilities) */
.dark-heresy .acolyte .stats .talents {
  display: none !important;
}
.dark-heresy .acolyte .stats .characteristics {
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  flex: 0 0 auto;
  width: calc(54% - 4px);
  margin: 0 2px;
  padding: 6px;
  gap: 6px;
  box-sizing: border-box;
}
/* NPC Stats - специфичные стили, идентично Acolyte */
.dark-heresy .npc .stats .characteristics {
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  flex: 0 0 auto;
  width: calc(54% - 4px);
  margin: 0 2px;
  padding: 6px;
  gap: 6px;
  box-sizing: border-box;
}
/* Скрываем таланты в NPC stats - их там быть не должно */
.dark-heresy .npc .stats .abilities {
  display: none !important;
}
.dark-heresy .npc .stats .talents {
  display: none !important;
}
/* Acolyte Characteristics - независимые стили с современным компактным дизайном */
/* Уменьшенный заголовок для characteristics */
.dark-heresy .acolyte .stats .characteristics.border h1 {
  min-height: 20px;
  height: 20px;
  line-height: 18px;
  font-size: 14px;
  padding: 1px 8px;
  margin: 0 0 6px 0;
  box-sizing: border-box;
}
.dark-heresy .acolyte .stats .characteristics .left {
  display: flex;
  flex-direction: column;
  margin: 0;
  flex-basis: calc(50% - 3px);
  gap: 8px;
  min-width: 0;
  align-items: stretch;
}
.dark-heresy .acolyte .stats .characteristics .right {
  display: flex;
  flex-direction: column;
  margin: 0;
  flex-basis: calc(50% - 3px);
  gap: 8px;
  min-width: 0;
  align-items: stretch;
}
.dark-heresy .acolyte .stats .characteristics .characteristic {
  display: flex;
  flex-direction: row;
  align-items: flex-start;
  gap: 8px;
  padding: 6px 6px;
  background: rgba(28, 49, 50, 0.3);
  border: 1px solid rgba(66, 207, 125, 0.2);
  border-radius: 4px;
  transition: all 0.25s ease;
  min-height: 52px;
  box-sizing: border-box;
}
.dark-heresy .acolyte .stats .characteristics .characteristic:hover {
  background: rgba(28, 49, 50, 0.5);
  border-color: var(--impmal-lightgreen);
  box-shadow: 0 2px 6px rgba(66, 207, 125, 0.15);
  transform: translateY(-1px);
}
.dark-heresy .acolyte .stats .characteristics .characteristic .name {
  flex: 1 1 auto;
  min-width: 0;
  max-width: 100%;
  font-size: 12px;
  font-family: var(--font-text);
  font-weight: 600;
  text-align: left;
  color: #e0e0e0;
  display: flex;
  align-items: center;
  align-self: center;
  overflow: hidden;
}
.dark-heresy .acolyte .stats .characteristics .characteristic .name button {
  font-size: 12px;
  font-weight: 600;
  padding: 4px 6px;
  text-align: left;
  width: 100%;
  max-width: 100%;
  background: linear-gradient(135deg, rgba(66, 207, 125, 0.1) 0%, rgba(66, 207, 125, 0.05) 100%);
  border: 1px solid rgba(66, 207, 125, 0.3);
  border-radius: 4px;
  color: #e0e0e0;
  cursor: pointer;
  transition: all 0.2s ease;
  position: relative;
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
  box-sizing: border-box;
}
.dark-heresy .acolyte .stats .characteristics .characteristic .name button::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
  transition: left 0.5s ease;
}
.dark-heresy .acolyte .stats .characteristics .characteristic .name button:hover {
  color: var(--impmal-lightgreen);
  background: linear-gradient(135deg, rgba(66, 207, 125, 0.2) 0%, rgba(66, 207, 125, 0.1) 100%);
  border-color: var(--impmal-lightgreen);
  box-shadow: 0 0 10px rgba(66, 207, 125, 0.3);
  transform: scale(1.01);
}
.dark-heresy .acolyte .stats .characteristics .characteristic .name button:hover::before {
  left: 100%;
}
.dark-heresy .acolyte .stats .characteristics .characteristic .name button:active {
  transform: scale(0.99);
}
.dark-heresy .acolyte .stats .characteristics .characteristic .total {
  font-size: 16px;
  font-weight: bold;
  height: 36px;
  width: 46px;
  margin: 0;
  border: 2px solid var(--impmal-lightblue);
  border-radius: 4px;
  background: linear-gradient(135deg, rgba(220, 220, 220, 0.9) 0%, rgba(220, 220, 220, 0.85) 100%);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2), inset 0 1px 2px rgba(255, 255, 255, 0.8);
  flex-shrink: 0;
  text-align: center;
  color: #1c3132;
  transition: all 0.2s ease;
  box-sizing: border-box;
  padding: 0;
}
.dark-heresy .stats .characteristics .characteristic .total-wrapper {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 3px;
  position: relative;
  z-index: 2;
}
.dark-heresy .stats .characteristics .characteristic .temp-modifier {
  height: 18px;
  width: 46px;
  font-size: 11px;
  text-align: center;
  position: relative;
  z-index: 3;
  border: 1px solid var(--impmal-lightblue);
  border-radius: 3px;
  background: rgba(220, 220, 220, 0.8);
  box-sizing: border-box;
}
.dark-heresy .acolyte .stats .characteristics .characteristic .total:hover {
  border-color: var(--impmal-lightgreen);
  box-shadow: 0 2px 6px rgba(66, 207, 125, 0.3), inset 0 1px 2px rgba(255, 255, 255, 0.8);
  transform: scale(1.03);
}
.dark-heresy .acolyte .stats .characteristics .characteristic .total:focus {
  border-color: var(--impmal-lightgreen);
  box-shadow: 0 0 10px rgba(66, 207, 125, 0.4), inset 0 1px 2px rgba(255, 255, 255, 0.8);
  outline: none;
}
.dark-heresy .acolyte .stats .characteristics .characteristic .information {
  display: flex;
  flex-direction: column;
  gap: 2px;
  flex-shrink: 0;
  align-items: center;
  justify-content: center;
}
.dark-heresy .acolyte .stats .characteristics .characteristic .information input {
  height: 18px;
  width: 26px;
  margin: 0;
  text-align: center;
  font-size: 10px;
  font-weight: 600;
  border: 1.5px solid var(--impmal-lightblue);
  border-radius: 3px;
  background: rgba(220, 220, 220, 0.85);
  padding: 1px 2px;
  color: #1c3132;
  transition: all 0.2s ease;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.15);
  box-sizing: border-box;
}
.dark-heresy .acolyte .stats .characteristics .characteristic .information input:hover {
  border-color: var(--impmal-lightgreen);
  box-shadow: 0 2px 4px rgba(66, 207, 125, 0.25);
  transform: scale(1.05);
}
.dark-heresy .acolyte .stats .characteristics .characteristic .information input:focus {
  border-color: var(--impmal-lightgreen);
  box-shadow: 0 0 6px rgba(66, 207, 125, 0.4);
  outline: none;
  transform: scale(1.08);
}
/* NPC Characteristics - идентично Acolyte */
/* Уменьшенный заголовок для characteristics */
.dark-heresy .npc .stats .characteristics.border h1 {
  min-height: 20px;
  height: 20px;
  line-height: 18px;
  font-size: 14px;
  padding: 1px 8px;
  margin: 0 0 6px 0;
  box-sizing: border-box;
}
.dark-heresy .npc .stats .characteristics .left {
  display: flex;
  flex-direction: column;
  margin: 0;
  flex-basis: calc(50% - 3px);
  gap: 8px;
  min-width: 0;
  align-items: stretch;
}
.dark-heresy .npc .stats .characteristics .right {
  display: flex;
  flex-direction: column;
  margin: 0;
  flex-basis: calc(50% - 3px);
  gap: 8px;
  min-width: 0;
  align-items: stretch;
}
.dark-heresy .npc .stats .characteristics .characteristic {
  display: flex;
  flex-direction: row;
  align-items: flex-start;
  gap: 8px;
  padding: 6px 6px;
  background: rgba(28, 49, 50, 0.3);
  border: 1px solid rgba(66, 207, 125, 0.2);
  border-radius: 4px;
  transition: all 0.25s ease;
  min-height: 52px;
  box-sizing: border-box;
}
.dark-heresy .npc .stats .characteristics .characteristic:hover {
  background: rgba(28, 49, 50, 0.5);
  border-color: var(--impmal-lightgreen);
  box-shadow: 0 2px 6px rgba(66, 207, 125, 0.15);
  transform: translateY(-1px);
}
.dark-heresy .npc .stats .characteristics .characteristic .name {
  flex: 1 1 auto;
  min-width: 0;
  max-width: 100%;
  font-size: 12px;
  font-family: var(--font-text);
  font-weight: 600;
  text-align: left;
  color: #e0e0e0;
  display: flex;
  align-items: center;
  align-self: center;
  overflow: hidden;
}
.dark-heresy .npc .stats .characteristics .characteristic .name button {
  font-size: 12px;
  font-weight: 600;
  padding: 4px 6px;
  text-align: left;
  width: 100%;
  max-width: 100%;
  background: linear-gradient(135deg, rgba(66, 207, 125, 0.1) 0%, rgba(66, 207, 125, 0.05) 100%);
  border: 1px solid rgba(66, 207, 125, 0.3);
  border-radius: 4px;
  color: #e0e0e0;
  cursor: pointer;
  transition: all 0.2s ease;
  position: relative;
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
  box-sizing: border-box;
}
.dark-heresy .npc .stats .characteristics .characteristic .name button::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
  transition: left 0.5s ease;
}
.dark-heresy .npc .stats .characteristics .characteristic .name button:hover {
  color: var(--impmal-lightgreen);
  background: linear-gradient(135deg, rgba(66, 207, 125, 0.2) 0%, rgba(66, 207, 125, 0.1) 100%);
  border-color: var(--impmal-lightgreen);
  box-shadow: 0 0 10px rgba(66, 207, 125, 0.3);
  transform: scale(1.01);
}
.dark-heresy .npc .stats .characteristics .characteristic .name button:hover::before {
  left: 100%;
}
.dark-heresy .npc .stats .characteristics .characteristic .name button:active {
  transform: scale(0.99);
}
.dark-heresy .npc .stats .characteristics .characteristic .total {
  font-size: 16px;
  font-weight: bold;
  height: 36px;
  width: 46px;
  margin: 0;
  border: 2px solid var(--impmal-lightblue);
  border-radius: 4px;
  background: linear-gradient(135deg, rgba(220, 220, 220, 0.9) 0%, rgba(220, 220, 220, 0.85) 100%);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2), inset 0 1px 2px rgba(255, 255, 255, 0.8);
  flex-shrink: 0;
  text-align: center;
  color: #1c3132;
  transition: all 0.2s ease;
  box-sizing: border-box;
  padding: 0;
}
.dark-heresy .npc .stats .characteristics .characteristic .total:hover {
  border-color: var(--impmal-lightgreen);
  box-shadow: 0 2px 6px rgba(66, 207, 125, 0.3), inset 0 1px 2px rgba(255, 255, 255, 0.8);
  transform: scale(1.03);
}
.dark-heresy .npc .stats .characteristics .characteristic .total:focus {
  border-color: var(--impmal-lightgreen);
  box-shadow: 0 0 10px rgba(66, 207, 125, 0.4), inset 0 1px 2px rgba(255, 255, 255, 0.8);
  outline: none;
}
.dark-heresy .npc .stats .characteristics .characteristic .information {
  display: flex;
  flex-direction: column;
  gap: 2px;
  flex-shrink: 0;
  align-items: center;
  justify-content: center;
}
.dark-heresy .npc .stats .characteristics .characteristic .information input {
  height: 18px;
  width: 26px;
  margin: 0;
  text-align: center;
  font-size: 10px;
  font-weight: 600;
  border: 1.5px solid var(--impmal-lightblue);
  border-radius: 3px;
  background: rgba(220, 220, 220, 0.85);
  padding: 1px 2px;
  color: #1c3132;
  transition: all 0.2s ease;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.15);
  box-sizing: border-box;
}
.dark-heresy .npc .stats .characteristics .characteristic .information input:hover {
  border-color: var(--impmal-lightgreen);
  box-shadow: 0 2px 4px rgba(66, 207, 125, 0.25);
  transform: scale(1.05);
}
.dark-heresy .npc .stats .characteristics .characteristic .information input:focus {
  border-color: var(--impmal-lightgreen);
  box-shadow: 0 0 6px rgba(66, 207, 125, 0.4);
  outline: none;
  transform: scale(1.08);
}
/* Talents в stats - только для acolyte (скрыты через display: none выше) */
.dark-heresy .acolyte .stats .talents {
  display: flex;
  flex-direction: column;
  flex: 1 1 auto;
  min-width: 0;
}
.dark-heresy .acolyte .stats .talents .item-list .header {
  margin-top: 0;
}
.dark-heresy .acolyte .stats .talents .item-list .header .name {
  flex: 1 1 auto;
  text-align: left;
  font-size: 13px;
}
.dark-heresy .acolyte .stats .talents .item-list .items {
  max-height: none;
  height: auto;
  overflow-y: auto;
}
.dark-heresy .acolyte .stats .talents .item-list .items .talent {
  width: 100%;
  padding: 4px 6px;
}
.dark-heresy .acolyte .stats .talents .item-list .items .talent .name {
  flex: 1 1 auto;
  font-size: 13px;
  font-family: var(--font-text);
  color: #e0e0e0;
  min-width: 0;
}
.dark-heresy .acolyte .stats .talents .item-list .items .talent .name div {
  font-size: 13px;
  font-weight: 500;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.dark-heresy .acolyte .stats .talents .item-list .items .talent .benefit {
  display: none;
}
.dark-heresy .acolyte .stats .talents .item-list .items .talent .button {
  flex: 0 0 auto;
}
.dark-heresy .stats .corruptions {
  display: flex;
  flex-direction: column;
  flex-wrap: wrap;
  width: calc(23% - 2px);
  margin-left: 2px;
  align-items: center;
}
.dark-heresy .stats .corruptions .total {
  font-size: 22px;
  font-weight: bold;
  height: 52px;
  width: 52px;
  margin: 2px;
  border: 2px solid var(--impmal-lightblue);
  border-radius: 4px;
  background: rgba(220, 220, 220, 0.85);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}
.dark-heresy .stats .corruptions .information {
  display: flex;
  flex-direction: column;
}
.dark-heresy .stats .corruptions .information .roll-corruption {
  height: 26px;
  width: 26px;
  margin: 2px;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0;
  box-sizing: border-box;
  border: 1px solid var(--impmal-lightblue);
  border-radius: 4px;
}
.dark-heresy .stats .corruptions .information .bonus {
  height: 26px;
  width: 26px;
  margin: 2px;
  text-align: center;
  font-size: 13px;
  border: 1px solid var(--impmal-lightblue);
  border-radius: 4px;
  background: rgba(220, 220, 220, 0.8);
}
.dark-heresy .stats .corruptions .item-list .header {
  margin-top: 5px;
}
.dark-heresy .stats .corruptions .item-list .header .name {
  flex-basis: 85%;
}
.dark-heresy .stats .corruptions .item-list .items .corruption {
  width: 100%;
}
.dark-heresy .stats .corruptions .item-list .items {
  max-height: 80px;
  height: 80px;
}
.dark-heresy .stats .corruptions .item-list .items .item .name {
  flex-basis: 90%;
  align-items: center;
}
/* Современный адаптивный grid layout для Skills */
.dark-heresy .acolyte .stats .skills,
.dark-heresy .npc .stats .skills {
  display: flex;
  flex-direction: column;
  flex-basis: 100%;
  margin-top: 8px;
  gap: 10px;
}
/* Исправление размера окна заголовка SKILLS для NPC */
.dark-heresy .npc .stats .skills.border {
  box-sizing: border-box;
  width: 100%;
  padding: 8px;
  overflow: hidden;
}
.dark-heresy .npc .stats .skills.border h1 {
  width: 100%;
  margin: 0 0 8px 0;
  box-sizing: border-box;
  max-width: 100%;
}
/* Контейнер для основных навыков - адаптивный grid */
.dark-heresy .acolyte .stats .skills > .flex.row,
.dark-heresy .npc .stats .skills > .flex.row {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
  gap: 4px;
  margin: 0;
  align-items: start;
}
/* Адаптивность для разных размеров экрана */
@media (min-width: 1200px) {
  .dark-heresy .acolyte .stats .skills > .flex.row,
  .dark-heresy .npc .stats .skills > .flex.row {
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  }
}
@media (max-width: 800px) {
  .dark-heresy .acolyte .stats .skills > .flex.row,
  .dark-heresy .npc .stats .skills > .flex.row {
    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
  }
}
/* Колонка с навыками - убираем ограничения */
.dark-heresy .acolyte .stats .skills .flex.column,
.dark-heresy .npc .stats .skills .flex.column {
  display: contents;
}
/* Компактный skill item */
.dark-heresy .acolyte .stats .skills .skill,
.dark-heresy .npc .stats .skills .skill {
  display: grid;
  grid-template-columns: 1fr auto auto;
  gap: 6px;
  align-items: center;
  padding: 4px 6px;
  background: rgba(28, 49, 50, 0.25);
  border: 1px solid var(--impmal-lightblue);
  border-radius: 4px;
  transition: all 0.2s ease;
  min-width: 0;
}
.dark-heresy .acolyte .stats .skills .skill:hover,
.dark-heresy .npc .stats .skills .skill:hover {
  background: rgba(28, 49, 50, 0.4);
  border-color: var(--impmal-lightgreen);
  box-shadow: 0 0 4px rgba(66, 207, 125, 0.2);
}
.dark-heresy .acolyte .stats .skills .skill .name,
.dark-heresy .npc .stats .skills .skill .name {
  display: flex;
  align-items: center;
  min-width: 0;
  font-size: 13px;
  font-family: var(--font-text);
  font-weight: 500;
  color: #e0e0e0;
}
.dark-heresy .acolyte .stats .skills .skill .name button,
.dark-heresy .npc .stats .skills .skill .name button {
  font-size: 13px;
  font-weight: 500;
  padding: 2px 4px;
  text-align: left;
  width: 100%;
  background: transparent;
  border: none;
  color: #e0e0e0;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.dark-heresy .acolyte .stats .skills .skill .name button:hover,
.dark-heresy .npc .stats .skills .skill .name button:hover {
  color: var(--impmal-lightgreen);
  text-shadow: 0 0 4px rgba(66, 207, 125, 0.5);
}
.dark-heresy .acolyte .stats .skills .skill .total,
.dark-heresy .npc .stats .skills .skill .total {
  font-size: 14px;
  font-weight: bold;
  height: 28px;
  width: 42px;
  margin: 0;
  border: 1px solid var(--impmal-lightblue);
  border-radius: 3px;
  background: rgba(220, 220, 220, 0.85);
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.15);
  flex-shrink: 0;
  padding: 0 4px;
}
.dark-heresy .acolyte .stats .skills .skill .total:focus,
.dark-heresy .npc .stats .skills .skill .total:focus {
  border-color: var(--impmal-lightgreen);
  box-shadow: 0 0 6px rgba(66, 207, 125, 0.3);
}
.dark-heresy .acolyte .stats .skills .skill .information,
.dark-heresy .npc .stats .skills .skill .information {
  display: flex;
  flex-direction: row;
  gap: 3px;
  flex-shrink: 0;
  align-items: center;
}
.dark-heresy .acolyte .stats .skills .skill .information input,
.dark-heresy .npc .stats .skills .skill .information input {
  height: 24px;
  width: 28px;
  margin: 0;
  text-align: center;
  font-size: 11px;
  font-weight: 500;
  border: 1px solid var(--impmal-lightblue);
  border-radius: 3px;
  background: rgba(220, 220, 220, 0.85);
  padding: 1px 2px;
}
.dark-heresy .acolyte .stats .skills .skill .information input:focus,
.dark-heresy .npc .stats .skills .skill .information input:focus {
  border-color: var(--impmal-lightgreen);
  box-shadow: 0 0 4px rgba(66, 207, 125, 0.3);
}
/* Секция специализаций - улучшенный layout */
.dark-heresy .acolyte .stats .skills > .flex.row:last-child,
.dark-heresy .npc .stats .skills > .flex.row:last-child {
  display: flex;
  flex-direction: column;
  gap: 6px;
  margin-top: 8px;
}
.dark-heresy .acolyte .stats .skills .item-list,
.dark-heresy .npc .stats .skills .item-list {
  margin-top: 0;
  min-height: auto;
  border: 1px solid var(--impmal-lightblue);
  border-radius: 4px;
  background: rgba(28, 49, 50, 0.2);
  padding: 6px;
}
.dark-heresy .acolyte .stats .skills .item-list .header {
  margin-top: 0;
  margin-bottom: 4px;
  font-size: 13px;
  padding: 4px 6px;
}
.dark-heresy .acolyte .stats .skills .item-list .items,
.dark-heresy .npc .stats .skills .item-list .items {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
  gap: 4px;
  max-height: none;
  overflow-y: visible;
}
/* Адаптивность для специализаций */
@media (min-width: 1200px) {
  .dark-heresy .acolyte .stats .skills .item-list .items,
  .dark-heresy .npc .stats .skills .item-list .items {
    grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
  }
}
@media (max-width: 800px) {
  .dark-heresy .acolyte .stats .skills .item-list .items,
  .dark-heresy .npc .stats .skills .item-list .items {
    grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
  }
}
.dark-heresy .acolyte .stats .skills .item-list .item.speciality,
.dark-heresy .npc .stats .skills .item-list .item.speciality {
  display: grid;
  grid-template-columns: 1fr auto auto;
  gap: 6px;
  align-items: center;
  padding: 3px 5px;
  margin: 0;
  background: rgba(28, 49, 50, 0.3);
  border: 1px solid var(--impmal-lightblue);
  border-radius: 3px;
  transition: all 0.2s ease;
}
.dark-heresy .acolyte .stats .skills .item-list .item.speciality:hover,
.dark-heresy .npc .stats .skills .item-list .item.speciality:hover {
  background: rgba(28, 49, 50, 0.45);
  border-color: var(--impmal-lightgreen);
}
.dark-heresy .acolyte .stats .skills .item-list .item.speciality .total,
.dark-heresy .npc .stats .skills .item-list .item.speciality .total {
  font-size: 13px;
  font-weight: bold;
  height: 26px;
  width: 40px;
  margin: 0;
  border: 1px solid var(--impmal-lightblue);
  border-radius: 3px;
  background: rgba(220, 220, 220, 0.85);
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.15);
  flex-shrink: 0;
  padding: 0 3px;
}
.dark-heresy .acolyte .stats .skills .item-list .item.speciality .name,
.dark-heresy .npc .stats .skills .item-list .item.speciality .name {
  display: flex;
  align-items: center;
  min-width: 0;
  font-size: 12px;
  font-family: var(--font-text);
  font-weight: 500;
  color: #d0d0d0;
}
.dark-heresy .acolyte .stats .skills .item-list .item.speciality .name button,
.dark-heresy .npc .stats .skills .item-list .item.speciality .name button {
  font-size: 12px;
  font-weight: 500;
  padding: 2px 4px;
  text-align: left;
  width: 100%;
  background: transparent;
  border: none;
  color: #d0d0d0;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.dark-heresy .acolyte .stats .skills .item-list .item.speciality .name button:hover,
.dark-heresy .npc .stats .skills .item-list .item.speciality .name button:hover {
  color: var(--impmal-lightgreen);
  text-shadow: 0 0 4px rgba(66, 207, 125, 0.5);
}
.dark-heresy .acolyte .stats .skills .item-list .item.speciality .name .roll-speciality {
  text-align: left;
}
.dark-heresy .acolyte .stats .skills .item-list .item.speciality .information,
.dark-heresy .npc .stats .skills .item-list .item.speciality .information {
  display: flex;
  flex-direction: row;
  gap: 3px;
  flex-shrink: 0;
  align-items: center;
}
.dark-heresy .acolyte .stats .skills .item-list .item.speciality .information input,
.dark-heresy .npc .stats .skills .item-list .item.speciality .information input {
  height: 22px;
  width: 26px;
  margin: 0;
  text-align: center;
  font-size: 11px;
  font-weight: 500;
  border: 1px solid var(--impmal-lightblue);
  border-radius: 3px;
  background: rgba(220, 220, 220, 0.85);
  padding: 1px 2px;
}
.dark-heresy .acolyte .stats .skills .item-list .items .item:nth-child(odd),
.dark-heresy .npc .stats .skills .item-list .items .item:nth-child(odd) {
  background: rgba(28, 49, 50, 0.3);
}
.dark-heresy .abilities {
  display: flex;
  flex-direction: column;
  flex-wrap: wrap;
  flex-basis: calc(46% - 2px);
  margin-left: 2px;
}
.dark-heresy .abilities .item-list .header {
  margin-top: 6px;
  margin-bottom: 4px;
  padding: 8px 8px;
  background: rgba(12, 24, 26, 0.9);
  border-radius: 4px;
  border: 1px solid var(--impmal-lightblue);
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: 4px;
  box-sizing: border-box;
}
.dark-heresy .abilities .item-list .header .name,
.dark-heresy .abilities .item-list .header .benefit {
  font-size: 11px;
  font-weight: 700;
  color: #b8c3c5;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}
.dark-heresy .abilities .item-list .header .name {
  flex-basis: 28%;
  text-align: left;
}
.dark-heresy .abilities .item-list .header .benefit {
  flex-basis: 60%;
  text-align: left;
}
.dark-heresy .abilities .item-list .header .button {
  flex-basis: 12%;
  text-align: center;
}
.dark-heresy .abilities .item-list .items {
  max-height: none;
  height: auto;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 4px;
  padding: 2px 0;
}
.dark-heresy .abilities .ability-block {
  width: 100%;
}
.dark-heresy .abilities .ability-toggle {
  display: none;
}
.dark-heresy .abilities .ability-row {
  width: 100%;
  display: flex;
  flex-direction: row;
  align-items: stretch;
  gap: 6px;
  padding: 6px 8px;
  background: rgba(28, 49, 50, 0.4);
  border: 1px solid rgba(11, 74, 80, 0.5);
  border-radius: 4px;
  box-sizing: border-box;
  transition: all 0.2s ease;
}
.dark-heresy .abilities .ability-row:hover {
  background: rgba(28, 49, 50, 0.6);
  border-color: var(--impmal-lightgreen);
  box-shadow: 0 2px 6px rgba(55, 179, 107, 0.3);
  transform: translateY(-1px);
}
.dark-heresy .abilities .ability-row .toggle {
  flex: 0 0 26px;
  display: flex;
  align-items: center;
  justify-content: center;
}
.dark-heresy .abilities .ability-row .toggle label {
  cursor: pointer;
  color: #b8c3c5;
  display: flex;
  align-items: center;
  justify-content: center;
}
.dark-heresy .abilities .ability-row .toggle i {
  font-size: 10px;
  transition: transform 0.2s ease;
}
.dark-heresy .abilities .ability-block .ability-toggle:checked + .ability-row .toggle i {
  transform: rotate(180deg);
}
.dark-heresy .abilities .ability-row .name {
  flex-basis: 28%;
  min-width: 0;
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: 6px;
}
.dark-heresy .abilities .ability-row .image-container {
  flex: 0 0 auto;
  width: 24px;
  height: 24px;
}
.dark-heresy .abilities .ability-row .image-container .image {
  width: 24px;
  height: 24px;
  background-size: contain;
  background-position: center;
  background-repeat: no-repeat;
}
.dark-heresy .abilities .ability-row .ability-name {
  flex: 1 1 auto;
  min-width: 0;
  font-size: 13px;
  font-weight: 600;
  color: #dcdcdc;
  text-align: left;
  line-height: 1.3;
  white-space: normal;
  word-wrap: break-word;
}
.dark-heresy .abilities .ability-row .benefit-short {
  flex-basis: 60%;
  min-width: 0;
  font-size: 12px;
  font-weight: 500;
  color: #b8c3c5;
  text-align: left;
  line-height: 1.4;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}
.dark-heresy .abilities .ability-row .button {
  flex-basis: 12%;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 4px;
}
.dark-heresy .abilities .ability-row .button .item-chat {
  color: #b8c3c5;
  transition: color 0.2s ease;
}
.dark-heresy .abilities .ability-row .button .item-chat:hover {
  color: var(--impmal-lightgreen);
  text-shadow: 0 0 4px rgba(55, 179, 107, 0.5);
}
.dark-heresy .abilities .ability-notes {
  display: none !important;
  margin-top: 2px;
  padding: 6px 8px;
  background: rgba(6, 12, 14, 0.9);
  border-radius: 4px;
  border: 1px solid rgba(11, 74, 80, 0.6);
  font-size: 12px;
  line-height: 1.5;
  color: #c9cfce;
  box-sizing: border-box;
  text-align: justify !important;
}
.dark-heresy .abilities .ability-block .ability-toggle:checked ~ .ability-notes {
  display: block !important;
}
.dark-heresy .abilities .ability-notes * {
  text-align: justify !important;
}
.dark-heresy .abilities .ability-block .ability-toggle:checked ~ .ability-notes {
  display: block;
}
.dark-heresy .combat .wounds {
  display: flex;
  flex-direction: column;
  flex-wrap: wrap;
  flex-basis: 30%;
}
.dark-heresy .combat .wounds .item-list .header {
  margin-top: 5px;
}
.dark-heresy .combat .wounds .item-list .header .name {
  flex-basis: 94%;
}
.dark-heresy .combat .wounds .item-list .items .wound {
  width: 100%;
}
.dark-heresy .combat .wounds .item-list .items {
  max-height: 120px;
  height: 120px;
}
.dark-heresy .combat .wounds .item-list .items .item .wound-row {
  flex-basis: 95%;
  align-items: center;
}
.dark-heresy .combat .wounds .item-list .items .item .wound-row .name {
  flex-basis: 60%;
  align-items: center;
}
.dark-heresy .combat .wounds .item-list .items .item .wound-row input {
  flex-basis: 28%;
  margin: 1px 5px;
}
.dark-heresy .combat .wounds .information {
  display: flex;
  margin-top: 5px;
}
.dark-heresy .combat .wounds .information label {
  flex-basis: 75%;
}
.dark-heresy .combat .wounds .information input {
  flex-basis: 25%;
}
.dark-heresy .combat .wounds .information .wounds-regeneration-row {
  flex-basis: 25%;
  display: flex;
  align-items: center;
  gap: 4px;
}
.dark-heresy .combat .wounds .information .wounds-regeneration-row input {
  flex: 1 1 auto;
}
.dark-heresy .combat .wounds .information .wounds-regeneration-row .roll-regeneration {
  height: 22px;
  width: 22px;
  padding: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 1px solid var(--impmal-lightblue);
  border-radius: 4px;
}
.dark-heresy .combat .wounds .information .wounds-regeneration-row .roll-regeneration i {
  font-size: 12px;
  line-height: 1;
}
.dark-heresy .combat .armour {
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  flex-basis: calc(45% - 4px);
  align-items: center;
  margin: 0 2px;
}
.dark-heresy .combat .armour .armour-row {
  display: flex;
  flex-direction: row;
  justify-content: space-around;
  margin-top: 5px;
  flex-basis: 100%;
}
.dark-heresy .combat .armour .armour-row .part {
  display: flex;
  flex-direction: row;
  align-items: center;
  flex-basis: 100%;
  justify-content: center;
}
.dark-heresy .combat .armour .armour-row .part .name {
  flex-basis: 18%;
  font-size: 16px;
  text-align: center;
  font-family: var(--font-header);
  font-weight: bold;
  color: #e0e0e0;
}
.dark-heresy .combat .armour .armour-row .part .total-wrapper {
  display: flex;
  flex-direction: column;
  align-items: center;
  margin: 2px;
}
.dark-heresy .combat .armour .armour-row .part .total {
  font-size: 22px;
  font-weight: bold;
  height: 52px;
  width: 52px;
  margin: 0;
  border: 2px solid var(--impmal-lightblue);
  border-radius: 4px;
  background: rgba(220, 220, 220, 0.85);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}
.dark-heresy .combat .armour .armour-row .part .total-wrapper .temp-modifier {
  height: 24px;
  width: 52px;
  font-size: 13px;
  margin: 4px 0 0 0;
  text-align: center;
  border: 1px solid var(--impmal-lightblue);
  border-radius: 4px;
  background: rgba(220, 220, 220, 0.8);
}
.dark-heresy .combat .armour .armour-row .part .information {
  display: flex;
  flex-direction: column;
}
.dark-heresy .combat .armour .armour-row .part .information input {
  height: 26px;
  width: 26px;
  margin: 2px;
  text-align: center;
  font-size: 13px;
  border: 1px solid var(--impmal-lightblue);
  border-radius: 4px;
  background: rgba(220, 220, 220, 0.8);
}
.dark-heresy .combat .movement {
  display: flex;
  flex-direction: column;
  flex-wrap: wrap;
  flex-basis: 25%;
  justify-content: space-between;
}
.dark-heresy .combat .movement .information {
  display: flex;
  margin-top: 3px;
  align-items: center;
  gap: 3px;
  justify-content: flex-start;
}
.dark-heresy .combat .movement .information label {
  flex-basis: 50%;
  line-height: 1.1;
  text-align: left;
}
.dark-heresy .combat .movement .information input {
  text-align: left;
  flex-basis: 24%;
  min-width: 36px;
}
.dark-heresy .combat .movement .information .movement-bonus-input {
  flex-basis: 20%;
  min-width: 30px;
}
.dark-heresy .combat .movement .information select {
  flex-basis: 45%;
}
.dark-heresy .combat .movement .information.initiative label {
  flex-basis: 100%;
  text-align: center;
  margin-bottom: 2px;
  font-weight: 600;
}
.dark-heresy .combat .movement .information.initiative {
  flex-direction: column;
  align-items: center;
  gap: 4px;
}
.dark-heresy .combat .movement .information.initiative input {
  width: 44px;
  min-width: 44px;
  text-align: center;
}
.dark-heresy .combat .movement .information.initiative select {
  width: 44px;
  min-width: 44px;
  text-align: center;
  text-align-last: center;
}
.dark-heresy .combat .movement .information.initiative .initiative-row {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 4px;
  width: 100%;
}
.dark-heresy .combat .movement .information.initiative .initiative-row .separator {
  width: 16px;
  text-align: center;
}
/* Weapons - современный дизайн */
.dark-heresy .combat .weapons {
  display: flex;
  flex-direction: column;
  flex-wrap: wrap;
  margin-top: 2px;
  flex-basis: 100%;
  padding: 8px;
  box-sizing: border-box;
}
.dark-heresy .combat .weapons .item-list .header {
  margin-top: 6px;
  margin-bottom: 4px;
  padding: 8px 8px;
  background: rgba(12, 24, 26, 0.9);
  border-radius: 4px;
  border: 1px solid var(--impmal-lightblue);
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: 4px;
  box-sizing: border-box;
}
.dark-heresy .combat .weapons .item-list .header b {
  font-size: 11px;
  font-weight: 700;
  color: #b8c3c5;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  text-align: center;
  padding: 2px 4px;
  box-sizing: border-box;
}
.dark-heresy .combat .weapons .item-list .name {
  flex-basis: 22%;
  min-width: 0;
  text-align: left;
  align-items: center;
  padding: 0 4px;
}
.dark-heresy .combat .weapons .item-list .class {
  flex-basis: 8%;
  min-width: 0;
  text-align: center;
  padding: 0 2px;
}
.dark-heresy .combat .weapons .item-list .range {
  flex-basis: 6%;
  min-width: 0;
  text-align: center;
  padding: 0 2px;
}
.dark-heresy .combat .weapons .item-list .rate-of-fire {
  flex-basis: 8%;
  min-width: 0;
  text-align: center;
  padding: 0 2px;
}
.dark-heresy .combat .weapons .item-list .damage {
  flex-basis: 9%;
  min-width: 0;
  text-align: center;
  padding: 0 2px;
}
.dark-heresy .combat .weapons .item-list .type {
  flex-basis: 6%;
  min-width: 0;
  text-align: center;
  padding: 0 2px;
}
.dark-heresy .combat .weapons .item-list .penetration {
  flex-basis: 6%;
  min-width: 0;
  text-align: center;
  padding: 0 2px;
}
.dark-heresy .combat .weapons .item-list .clip {
  flex-basis: 7%;
  min-width: 0;
  text-align: center;
  padding: 0 2px;
}
.dark-heresy .combat .weapons .item-list .reload {
  flex-basis: 9%;
  min-width: 0;
  text-align: center;
  padding: 0 2px;
}
.dark-heresy .combat .weapons .item-list .special {
  flex-basis: 19%;
  min-width: 0;
  text-align: left;
  padding: 0 4px;
}
.dark-heresy .combat .weapons .item-list .items {
  max-height: none;
  height: auto;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 4px;
  padding: 4px 0;
}
.dark-heresy .combat .weapons .item-list .items .weapon {
  width: 100%;
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: 4px;
  padding: 6px 6px;
  background: rgba(28, 49, 50, 0.25);
  border: 1px solid rgba(66, 207, 125, 0.15);
  border-radius: 4px;
  transition: all 0.2s ease;
  box-sizing: border-box;
}
.dark-heresy .combat .weapons .item-list .items .weapon:hover {
  background: rgba(28, 49, 50, 0.4);
  border-color: var(--impmal-lightgreen);
  box-shadow: 0 2px 6px rgba(66, 207, 125, 0.2);
  transform: translateY(-1px);
}
.dark-heresy .combat .weapons .item-list .items .weapon .name {
  flex-basis: 18%;
  min-width: 0;
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: 6px;
  padding: 0 4px;
}
.dark-heresy .combat .weapons .item-list .items .weapon .name .image-container {
  flex: 0 0 auto;
  width: 24px;
  height: 24px;
}
.dark-heresy .combat .weapons .item-list .items .weapon .name .image-container .image {
  width: 24px;
  height: 24px;
  background-size: contain;
  background-position: center;
  background-repeat: no-repeat;
}
.dark-heresy .combat .weapons .item-list .items .weapon .name button:not(.toggle-equipped) {
  flex: 1 1 auto;
  min-width: 0;
  font-size: 12px;
  font-weight: 600;
  color: #dcdcdc;
  text-align: left;
  padding: 4px 6px;
  background: linear-gradient(135deg, rgba(66, 207, 125, 0.1) 0%, rgba(66, 207, 125, 0.05) 100%);
  border: 1px solid rgba(66, 207, 125, 0.3);
  border-radius: 3px;
  cursor: pointer;
  transition: all 0.2s ease;
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-line-clamp: 2;
  line-clamp: 2;
  white-space: normal;
  overflow: hidden;
  text-overflow: ellipsis;
  box-sizing: border-box;
}
.dark-heresy .combat .weapons .item-list .items .weapon .name button.roll-weapon-damage {
  flex: 0 0 auto;
  min-width: 24px;
  width: 24px;
  height: 24px;
  padding: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  -webkit-box-orient: horizontal;
  -webkit-line-clamp: 1;
  line-clamp: 1;
  white-space: nowrap;
  overflow: visible;
  text-overflow: clip;
  font-size: 14px;
}
.dark-heresy .combat .weapons .item-list .items .weapon .name button:not(.toggle-equipped):hover {
  color: var(--impmal-lightgreen);
  background: linear-gradient(135deg, rgba(66, 207, 125, 0.2) 0%, rgba(66, 207, 125, 0.1) 100%);
  border-color: var(--impmal-lightgreen);
  box-shadow: 0 0 8px rgba(66, 207, 125, 0.3);
}
.dark-heresy .combat .weapons .item-list .items .weapon > div:not(.name) {
  font-size: 11px;
  font-weight: 500;
  color: #dcdcdc;
  text-align: center;
  padding: 4px 2px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  box-sizing: border-box;
  line-height: 1.3;
}
.dark-heresy .combat .weapons .item-list .items .weapon .class,
.dark-heresy .combat .weapons .item-list .items .weapon .range,
.dark-heresy .combat .weapons .item-list .items .weapon .rate-of-fire,
.dark-heresy .combat .weapons .item-list .items .weapon .damage,
.dark-heresy .combat .weapons .item-list .items .weapon .type,
.dark-heresy .combat .weapons .item-list .items .weapon .penetration,
.dark-heresy .combat .weapons .item-list .items .weapon .clip,
.dark-heresy .combat .weapons .item-list .items .weapon .reload {
  text-align: center;
}
.dark-heresy .combat .weapons .item-list .items .weapon .special {
  text-align: left;
  font-size: 10px;
  line-height: 1.4;
  white-space: normal;
  word-wrap: break-word;
}
/* Psychic Powers - современный дизайн */
.dark-heresy .combat .psychic-powers {
  display: flex;
  flex-direction: column;
  flex-wrap: wrap;
  margin-top: 2px;
  flex-basis: 100%;
  padding: 8px;
  box-sizing: border-box;
}
.dark-heresy .combat .psychic-powers .information {
  display: flex;
  flex-direction: row;
  gap: 12px;
  margin-bottom: 10px;
  padding: 8px;
  background: rgba(28, 49, 50, 0.3);
  border: 1px solid rgba(66, 207, 125, 0.2);
  border-radius: 4px;
  align-items: center;
  box-sizing: border-box;
}
.dark-heresy .combat .psychic-powers .information .class {
  display: flex;
  flex-direction: column;
  flex: 1 1 0;
  min-width: 0;
  gap: 4px;
  align-items: flex-start;
}
.dark-heresy .combat .psychic-powers .information .class label {
  font-size: 10px;
  font-weight: 700;
  color: #dcdcdc;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin: 0;
  padding: 0;
}
.dark-heresy .combat .psychic-powers .information .class select {
  width: 100%;
  height: 28px;
  padding: 4px 8px;
  font-size: 12px;
  font-weight: 500;
  color: #dcdcdc;
  background-image: url(../assets/ui/title-bg.webp);
  background-size: 100% 100%;
  background-repeat: no-repeat;
  background-color: rgba(220, 220, 220, 0.85);
  border: 1.5px solid var(--impmal-lightblue);
  border-radius: 3px;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.15);
  transition: all 0.2s ease;
  box-sizing: border-box;
}
.dark-heresy .combat .psychic-powers .information .class select:hover {
  border-color: var(--impmal-lightgreen);
  box-shadow: 0 2px 4px rgba(66, 207, 125, 0.25);
}
.dark-heresy .combat .psychic-powers .information .class select:focus {
  border-color: var(--impmal-lightgreen);
  box-shadow: 0 0 6px rgba(66, 207, 125, 0.4);
  outline: none;
}
.dark-heresy .combat .psychic-powers .information .rating,
.dark-heresy .combat .psychic-powers .information .sustained {
  display: flex;
  flex-direction: column;
  flex: 0 0 auto;
  min-width: 80px;
  max-width: 100px;
  gap: 4px;
  align-items: flex-start;
}
.dark-heresy .combat .psychic-powers .information .rating label,
.dark-heresy .combat .psychic-powers .information .sustained label {
  font-size: 10px;
  font-weight: 700;
  color: #dcdcdc;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin: 0;
  padding: 0;
}
.dark-heresy .combat .psychic-powers .information .rating input,
.dark-heresy .combat .psychic-powers .information .sustained input {
  width: 100%;
  height: 28px;
  padding: 4px 8px;
  font-size: 12px;
  font-weight: 600;
  color: #dcdcdc;
  text-align: center;
  background-image: url(../assets/ui/title-bg.webp);
  background-size: 100% 100%;
  background-repeat: no-repeat;
  background-color: rgba(220, 220, 220, 0.85);
  border: 1.5px solid var(--impmal-lightblue);
  border-radius: 3px;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.15);
  transition: all 0.2s ease;
  box-sizing: border-box;
}
/* Combat Psychic Powers: keep muted white text in inputs/selects */
.dark-heresy .combat .psychic-powers .information .class select,
.dark-heresy .combat .psychic-powers .information .rating input,
.dark-heresy .combat .psychic-powers .information .sustained input {
  color: #dcdcdc !important;
}
.dark-heresy .combat .psychic-powers .information .rating input:hover,
.dark-heresy .combat .psychic-powers .information .sustained input:hover {
  border-color: var(--impmal-lightgreen);
  box-shadow: 0 2px 4px rgba(66, 207, 125, 0.25);
}
.dark-heresy .combat .psychic-powers .information .rating input:focus,
.dark-heresy .combat .psychic-powers .information .sustained input:focus {
  border-color: var(--impmal-lightgreen);
  box-shadow: 0 0 6px rgba(66, 207, 125, 0.4);
  outline: none;
}
.dark-heresy .combat .psychic-powers .item-list .header {
  margin-top: 6px;
  margin-bottom: 4px;
  padding: 8px 8px;
  background: rgba(12, 24, 26, 0.9);
  border-radius: 4px;
  border: 1px solid var(--impmal-lightblue);
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: 4px;
  box-sizing: border-box;
}
.dark-heresy .combat .psychic-powers .item-list .header b {
  font-size: 11px;
  font-weight: 700;
  color: #b8c3c5;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  text-align: center;
  padding: 2px 4px;
  box-sizing: border-box;
}
.dark-heresy .combat .psychic-powers .item-list .name {
  flex-basis: 18%;
  min-width: 0;
  align-items: center;
  padding: 0 4px;
}
.dark-heresy .combat .psychic-powers .item-list .action {
  flex-basis: 8%;
  min-width: 0;
  text-align: center;
  padding: 0 2px;
}
.dark-heresy .combat .psychic-powers .item-list .range {
  flex-basis: 10%;
  min-width: 0;
  text-align: center;
  padding: 0 2px;
}
.dark-heresy .combat .psychic-powers .item-list .sustained {
  flex-basis: 12%;
  min-width: 0;
  text-align: center;
  padding: 0 2px;
}
.dark-heresy .combat .psychic-powers .item-list .zone {
  flex-basis: 8%;
  min-width: 0;
  text-align: center;
  padding: 0 2px;
}
.dark-heresy .combat .psychic-powers .item-list .damage {
  flex-basis: 8%;
  min-width: 0;
  text-align: center;
  padding: 0 2px;
}
.dark-heresy .combat .psychic-powers .item-list .damage-type {
  flex-basis: 6%;
  min-width: 0;
  text-align: center;
  padding: 0 2px;
}
.dark-heresy .combat .psychic-powers .item-list .penetration {
  flex-basis: 6%;
  min-width: 0;
  text-align: center;
  padding: 0 2px;
}
.dark-heresy .combat .psychic-powers .item-list .special {
  flex-basis: 24%;
  min-width: 0;
  text-align: left;
  padding: 0 4px;
}
.dark-heresy .combat .psychic-powers .item-list .items {
  max-height: none;
  height: auto;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 4px;
  padding: 4px 0;
}
.dark-heresy .combat .psychic-powers .item-list .items .weapon {
  width: 100%;
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: 4px;
  padding: 6px 6px;
  background: rgba(28, 49, 50, 0.25);
  border: 1px solid rgba(66, 207, 125, 0.15);
  border-radius: 4px;
  transition: all 0.2s ease;
  box-sizing: border-box;
}
.dark-heresy .combat .psychic-powers .item-list .items .weapon:hover {
  background: rgba(28, 49, 50, 0.4);
  border-color: var(--impmal-lightgreen);
  box-shadow: 0 2px 6px rgba(66, 207, 125, 0.2);
  transform: translateY(-1px);
}
.dark-heresy .combat .psychic-powers .item-list .items .weapon .name {
  flex-basis: 18%;
  min-width: 0;
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: 6px;
  padding: 0 4px;
}
.dark-heresy .combat .psychic-powers .item-list .items .weapon .name .image-container {
  flex: 0 0 auto;
  width: 24px;
  height: 24px;
}
.dark-heresy .combat .psychic-powers .item-list .items .weapon .name .image-container .image {
  width: 24px;
  height: 24px;
  background-size: contain;
  background-position: center;
  background-repeat: no-repeat;
}
.dark-heresy .combat .psychic-powers .item-list .items .weapon .name button {
  flex: 1 1 auto;
  min-width: 0;
  font-size: 12px;
  font-weight: 600;
  color: #dcdcdc;
  text-align: left;
  padding: 4px 6px;
  background: linear-gradient(135deg, rgba(66, 207, 125, 0.1) 0%, rgba(66, 207, 125, 0.05) 100%);
  border: 1px solid rgba(66, 207, 125, 0.3);
  border-radius: 3px;
  cursor: pointer;
  transition: all 0.2s ease;
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-line-clamp: 2;
  line-clamp: 2;
  white-space: normal;
  overflow: hidden;
  text-overflow: ellipsis;
  box-sizing: border-box;
}
.dark-heresy .combat .psychic-powers .item-list .items .weapon .name button.roll-psychic-damage {
  flex: 0 0 auto;
  min-width: 24px;
  width: 24px;
  height: 24px;
  padding: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  -webkit-box-orient: horizontal;
  -webkit-line-clamp: 1;
  line-clamp: 1;
  white-space: nowrap;
  overflow: visible;
  text-overflow: clip;
  font-size: 14px;
}
.dark-heresy .combat .psychic-powers .item-list .items .weapon .name button:hover {
  color: var(--impmal-lightgreen);
  background: linear-gradient(135deg, rgba(66, 207, 125, 0.2) 0%, rgba(66, 207, 125, 0.1) 100%);
  border-color: var(--impmal-lightgreen);
  box-shadow: 0 0 8px rgba(66, 207, 125, 0.3);
}
.dark-heresy .combat .psychic-powers .item-list .items .weapon > div:not(.name) {
  font-size: 11px;
  font-weight: 500;
  color: #dcdcdc;
  text-align: center;
  padding: 4px 2px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  box-sizing: border-box;
  line-height: 1.3;
}
.dark-heresy .combat .psychic-powers .item-list .items .weapon .action,
.dark-heresy .combat .psychic-powers .item-list .items .weapon .range,
.dark-heresy .combat .psychic-powers .item-list .items .weapon .sustained,
.dark-heresy .combat .psychic-powers .item-list .items .weapon .zone,
.dark-heresy .combat .psychic-powers .item-list .items .weapon .damage,
.dark-heresy .combat .psychic-powers .item-list .items .weapon .damage-type,
.dark-heresy .combat .psychic-powers .item-list .items .weapon .penetration {
  text-align: center;
}
.dark-heresy .combat .psychic-powers .item-list .items .weapon .sustained {
  font-size: 10px;
  line-height: 1.4;
  white-space: normal;
  word-wrap: break-word;
}
.dark-heresy .combat .psychic-powers .item-list .items .weapon .special {
  text-align: left;
  font-size: 10px;
  line-height: 1.4;
  white-space: normal;
  word-wrap: break-word;
}
.dark-heresy .abilities .talents,
.dark-heresy .abilities .traits,
.dark-heresy .abilities .special-abilities {
  display: flex;
  flex-direction: column;
  flex-wrap: wrap;
  margin-top: 2px;
  flex-basis: 100%;
}
.dark-heresy .abilities .talents {
  margin-top: 0;
}
.dark-heresy .psychic .psychic-powers {
  display: flex;
  flex-direction: column;
  flex-wrap: wrap;
  flex-basis: 100%;
}
.dark-heresy .psychic .psychic-powers .item-list .header {
  margin-top: 6px;
  margin-bottom: 4px;
  padding: 8px 8px;
  background: rgba(12, 24, 26, 0.9);
  border-radius: 4px;
  border: 1px solid var(--impmal-lightblue);
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: 4px;
  box-sizing: border-box;
}
.dark-heresy .psychic .psychic-powers .item-list .header .name,
.dark-heresy .psychic .psychic-powers .item-list .header .short {
  font-size: 11px;
  font-weight: 700;
  color: #b8c3c5;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}
.dark-heresy .psychic .psychic-powers .item-list .header .name {
  flex-basis: 28%;
  text-align: left;
}
.dark-heresy .psychic .psychic-powers .item-list .header .short {
  flex-basis: 60%;
  text-align: left;
}
.dark-heresy .psychic .psychic-powers .item-list .header .button {
  flex-basis: 12%;
  text-align: center;
}
.dark-heresy .psychic .psychic-powers .item-list .items {
  max-height: none;
  height: auto;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 4px;
  padding: 2px 0;
}
.dark-heresy .psychic .psychic-block {
  width: 100%;
}
.dark-heresy .psychic .psychic-toggle {
  display: none;
}
.dark-heresy .psychic .psychic-row {
  width: 100%;
  display: flex;
  flex-direction: row;
  align-items: stretch;
  gap: 6px;
  padding: 6px 8px;
  background: rgba(28, 49, 50, 0.4);
  border: 1px solid rgba(11, 74, 80, 0.5);
  border-radius: 4px;
  box-sizing: border-box;
  transition: all 0.2s ease;
}
.dark-heresy .psychic .psychic-row:hover {
  background: rgba(28, 49, 50, 0.6);
  border-color: var(--impmal-lightgreen);
  box-shadow: 0 2px 6px rgba(55, 179, 107, 0.3);
  transform: translateY(-1px);
}
.dark-heresy .psychic .psychic-row .toggle {
  flex: 0 0 26px;
  display: flex;
  align-items: center;
  justify-content: center;
}
.dark-heresy .psychic .psychic-row .toggle label {
  cursor: pointer;
  color: #b8c3c5;
  display: flex;
  align-items: center;
  justify-content: center;
}
.dark-heresy .psychic .psychic-row .toggle i {
  font-size: 10px;
  transition: transform 0.2s ease;
}
.dark-heresy .psychic .psychic-block .psychic-toggle:checked + .psychic-row .toggle i {
  transform: rotate(180deg);
}
.dark-heresy .psychic .psychic-row .name {
  flex-basis: 28%;
  min-width: 0;
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: 6px;
}
.dark-heresy .psychic .psychic-row .image-container {
  flex: 0 0 auto;
  width: 24px;
  height: 24px;
}
.dark-heresy .psychic .psychic-row .image-container .image {
  width: 24px;
  height: 24px;
  background-size: contain;
  background-position: center;
  background-repeat: no-repeat;
}
.dark-heresy .psychic .psychic-row .psychic-name {
  flex: 1 1 auto;
  min-width: 0;
  font-size: 13px;
  font-weight: 600;
  color: #dcdcdc;
  text-align: left;
  line-height: 1.3;
  white-space: normal;
  word-wrap: break-word;
}
.dark-heresy .psychic .psychic-row .short-text {
  flex-basis: 60%;
  min-width: 0;
  font-size: 12px;
  font-weight: 500;
  color: #b8c3c5;
  text-align: left;
  line-height: 1.4;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}
.dark-heresy .psychic .psychic-row .button {
  flex-basis: 12%;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 4px;
}
.dark-heresy .psychic .psychic-row .button .item-chat {
  color: #b8c3c5;
  transition: color 0.2s ease;
}
.dark-heresy .psychic .psychic-row .button .item-chat:hover {
  color: var(--impmal-lightgreen);
  text-shadow: 0 0 4px rgba(55, 179, 107, 0.5);
}
.dark-heresy .psychic .psychic-notes {
  display: none !important;
  margin-top: 2px;
  padding: 6px 8px;
  background: rgba(6, 12, 14, 0.9);
  border-radius: 4px;
  border: 1px solid rgba(11, 74, 80, 0.6);
  font-size: 12px;
  line-height: 1.5;
  color: #c9cfce;
  box-sizing: border-box;
  text-align: justify !important;
}
.dark-heresy .psychic .psychic-block .psychic-toggle:checked ~ .psychic-notes {
  display: block !important;
}
.dark-heresy .psychic .psychic-notes * {
  text-align: justify !important;
}
.dark-heresy .psychic .psychic-block .psychic-toggle:checked ~ .psychic-notes {
  display: block;
}
.dark-heresy .gear .encumbrance {
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  flex-basis: 100%;
}
.dark-heresy .gear .encumbrance .information {
  display: flex;
  margin-top: 5px;
  flex-basis: 100%;
  justify-content: space-evenly;
}
.dark-heresy .gear .encumbrance .information .max,
.dark-heresy .gear .encumbrance .information .current {
  display: flex;
  align-self: center;
  text-align: center;
  align-items: center;
}
.dark-heresy .gear .encumbrance .information .max label,
.dark-heresy .gear .encumbrance .information .current label {
  flex-basis: 30%;
  font-size: 18px;
  font-family: var(--font-header);
  font-weight: bold;
  color: #e0e0e0;
}
.dark-heresy .gear .encumbrance .information .max input,
.dark-heresy .gear .encumbrance .information .current input {
  font-size: 22px;
  font-weight: bold;
  height: 52px;
  width: 52px;
  margin-left: 10px;
  border: 2px solid var(--impmal-lightblue);
  border-radius: 4px;
  background: rgba(220, 220, 220, 0.85);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}
.dark-heresy .gear .all-gear {
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  margin-top: 2px;
  flex-basis: 100%;
  overflow-y: auto;
  max-height: none;
  height: auto;
  align-content: flex-start;
}
.dark-heresy .gear .all-gear .item-list .header {
  margin-top: 6px;
  margin-bottom: 4px;
  padding: 6px 8px;
  background: rgba(12, 24, 26, 0.9);
  border-radius: 4px;
  border: 1px solid var(--impmal-lightblue);
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: 6px;
  box-sizing: border-box;
  min-height: 36px;
}
.dark-heresy .gear .all-gear .item-list .header b {
  font-size: 11px;
  font-weight: 700;
  color: #b8c3c5;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  text-align: center;
  padding: 2px 4px;
  box-sizing: border-box;
}
/* Заголовки колонок в header - синхронизированы с данными */
.dark-heresy .gear .all-gear .item-list .header .name {
  flex: 1 1 auto;
  min-width: 0;
  text-align: left;
  display: flex;
  align-items: center;
  padding-left: 32px;
}

.dark-heresy .gear .all-gear .item-list .name {
  flex: 0 1 30%;
  min-width: 0;
  text-align: left;
  align-items: center;
  font-weight: bold;
}

.dark-heresy .gear .all-gear .item-list .header .installed {
  flex: 0 0 10%;
  min-width: 60px;
  text-align: center;
  display: flex;
  align-items: center;
  justify-content: center;
}

.dark-heresy .gear .all-gear .item-list .header .upgrade {
  flex: 0 0 50%;
  min-width: 100px;
  text-align: center;
  display: flex;
  align-items: center;
  justify-content: center;
}

.dark-heresy .gear .all-gear .item-list .header .class {
  flex: 0 0 10%;
  min-width: 60px;
  text-align: center;
  display: flex;
  align-items: center;
  justify-content: center;
}

.dark-heresy .gear .all-gear .item-list .header .damage {
  flex: 0 0 10%;
  min-width: 70px;
  text-align: center;
  display: flex;
  align-items: center;
  justify-content: center;
}

.dark-heresy .gear .all-gear .item-list .header .type {
  flex: 0 0 5%;
  min-width: 30px;
  text-align: center;
  display: flex;
  align-items: center;
  justify-content: center;
}

.dark-heresy .gear .all-gear .item-list .header .clip {
  flex: 0 0 8%;
  min-width: 50px;
  text-align: center;
  display: flex;
  align-items: center;
  justify-content: center;
}
.dark-heresy .gear .all-gear .item-list .header .weapon {
  flex-basis: 45%;
  text-align: center;
}
.dark-heresy .gear .all-gear .item-list .header .quantity {
  flex: 0 0 8%;
  min-width: 50px;
  text-align: center;
  display: flex;
  align-items: center;
  justify-content: center;
}

.dark-heresy .gear .all-gear .item-list .header .name {
  flex: 1 1 auto;
  min-width: 0;
  text-align: left;
  display: flex;
  align-items: center;
  padding-left: 32px;
}
.dark-heresy .gear .all-gear .item-list .header .part {
  flex-basis: 55%;
  text-align: center;
}
.dark-heresy .gear .all-gear .item-list .header .craftsmanship {
  flex-basis: 55%;
  text-align: center;
}
.dark-heresy .gear .all-gear .item-list .header .short-description {
  flex-basis: 55%;
  text-align: center;
}
.dark-heresy .gear .all-gear .item-list .header .cybernetic-craftsmanship {
  flex-basis: 45%;
  text-align: center;
}
.dark-heresy .gear .all-gear .item-list .header .weight {
  flex: 0 0 6%;
  min-width: 40px;
  text-align: center;
  display: flex;
  align-items: center;
  justify-content: center;
}

.dark-heresy .gear .all-gear .item-list .header .sum-weight {
  flex: 0 0 6%;
  min-width: 40px;
  text-align: center;
  display: flex;
  align-items: center;
  justify-content: center;
}

.dark-heresy .gear .all-gear .item-list .header .button {
  flex: 0 0 auto;
  min-width: 60px;
  text-align: center;
  display: flex;
  align-items: center;
  justify-content: flex-end;
}

/* Стили для данных в строках (не заголовки) */
.dark-heresy .gear .all-gear .item-list .name {
  flex-basis: 30%;
  text-align: left;
  align-items: center;
  font-weight: bold;
}
.dark-heresy .gear .all-gear .item-list .installed {
  flex-basis: 10%;
  text-align: center;
  align-items: center;
}
.dark-heresy .gear .all-gear .item-list .upgrade {
  flex-basis: 50%;
  text-align: center;
  align-items: center;
}
.dark-heresy .gear .all-gear .item-list .class {
  flex-basis: 30%;
  text-align: center;
  align-items: center;
}
.dark-heresy .gear .all-gear .item-list .damage {
  flex-basis: 10%;
  text-align: center;
  align-items: center;
}
.dark-heresy .gear .all-gear .item-list .type {
  flex-basis: 5%;
  text-align: center;
  align-items: center;
}
.dark-heresy .gear .all-gear .item-list .clip {
  flex-basis: 10%;
  text-align: center;
  align-items: center;
}
.dark-heresy .gear .all-gear .item-list .weapon {
  flex-basis: 45%;
  text-align: center;
  align-items: center;
}
.dark-heresy .gear .all-gear .item-list .quantity {
  flex: 0 0 8%;
  min-width: 50px;
  text-align: center;
  align-items: center;
  display: flex;
  justify-content: center;
}
.dark-heresy .gear .all-gear .item-list .part {
  flex-basis: 55%;
  text-align: center;
  align-items: center;
}
.dark-heresy .gear .all-gear .item-list .craftsmanship {
  flex-basis: 55%;
  text-align: center;
  align-items: center;
}
.dark-heresy .gear .all-gear .item-list .short-description {
  flex-basis: 55%;
  text-align: center;
  align-items: center;
}
.dark-heresy .gear .all-gear .item-list .cybernetic-craftsmanship {
  flex-basis: 45%;
  text-align: center;
  align-items: center;
}
.dark-heresy .gear .all-gear .item-list .weight {
  flex-basis: 7%;
  text-align: center;
}
.dark-heresy .gear .all-gear .item-list .sum-weight {
  flex-basis: 7%;
  text-align: center;
}
.dark-heresy .gear .all-gear .item-list .button {
  flex-basis: 7%;
  text-align: center;
}
.dark-heresy .gear .all-gear .item-list .item {
  overflow-y: visible;
}
.dark-heresy .gear .all-gear .item-list .items .gear {
  width: 100%;
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: 6px;
  padding: 6px 8px;
  margin-bottom: 3px;
  background: rgba(28, 49, 50, 0.4);
  border: 1px solid rgba(11, 74, 80, 0.5);
  border-radius: 4px;
  box-sizing: border-box;
  transition: all 0.2s ease;
}
.dark-heresy .gear .all-gear .item-list .items .gear:hover {
  background: rgba(28, 49, 50, 0.6);
  border-color: var(--impmal-lightgreen);
  box-shadow: 0 2px 6px rgba(55, 179, 107, 0.3);
  transform: translateY(-1px);
}
.dark-heresy .gear .all-gear .item-list .items .gear-block {
  width: 100%;
}
.dark-heresy .gear .all-gear .item-list .items .gear-toggle {
  display: none;
}
.dark-heresy .gear .all-gear .item-list .items .gear .toggle {
  flex: 0 0 26px;
  display: flex;
  align-items: center;
  justify-content: center;
}
.dark-heresy .gear .all-gear .item-list .items .gear .toggle label {
  cursor: pointer;
  color: #b8c3c5;
  display: flex;
  align-items: center;
  justify-content: center;
}
.dark-heresy .gear .all-gear .item-list .items .gear .toggle i {
  font-size: 10px;
  transition: transform 0.2s ease;
}
.dark-heresy .gear .all-gear .item-list .items .gear-block .gear-toggle:checked + .gear .toggle i {
  transform: rotate(180deg);
}
.dark-heresy .gear .all-gear .item-list .items .gear .name {
  flex: 1 1 auto;
  min-width: 0;
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: 6px;
  text-align: left;
  position: relative;
  justify-content: flex-start;
}
.dark-heresy .gear .all-gear .item-list .items .gear .name .image-container {
  flex: 0 0 auto;
  width: 24px;
  height: 24px;
}
.dark-heresy .gear .all-gear .item-list .items .gear .name .image-container .image {
  width: 24px;
  height: 24px;
  background-size: contain;
  background-position: center;
  background-repeat: no-repeat;
}
.dark-heresy .gear .all-gear .item-list .items .gear .name > div:not(.image-container):not(.toggle-equipped) {
  flex: 1 1 auto;
  min-width: 0;
  font-size: 11px;
  font-weight: 600;
  color: #dcdcdc;
  text-align: left;
  line-height: 1.3;
  white-space: normal;
  word-wrap: break-word;
  padding-right: 20px;
}

.dark-heresy .gear .all-gear .item-list .items .gear > div:not(.name):not(.button):not(.toggle):not(.short-description) {
  font-size: 12px;
  font-weight: 500;
  color: #b8c3c5;
  text-align: center;
  padding: 0 2px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  box-sizing: border-box;
  display: flex;
  align-items: center;
  justify-content: center;
}

.dark-heresy .gear .all-gear .item-list .items .gear .class {
  flex: 0 0 10%;
  min-width: 60px;
}

.dark-heresy .gear .all-gear .item-list .items .gear .damage {
  flex: 0 0 10%;
  min-width: 70px;
}

.dark-heresy .gear .all-gear .item-list .items .gear .type {
  flex: 0 0 5%;
  min-width: 30px;
}

.dark-heresy .gear .all-gear .item-list .items .gear .clip {
  flex: 0 0 8%;
  min-width: 50px;
}

.dark-heresy .gear .all-gear .item-list .items .gear .quantity {
  flex: 0 0 8%;
  min-width: 50px;
}

.dark-heresy .gear .all-gear .item-list .items .gear .weight {
  flex: 0 0 6%;
  min-width: 40px;
}

.dark-heresy .gear .all-gear .item-list .items .gear .button {
  flex: 0 0 auto;
  min-width: 60px;
  display: flex;
  align-items: center;
  justify-content: flex-end;
  gap: 4px;
  padding: 0;
}
.dark-heresy .gear .all-gear .item-list .items .gear .short-description {
  font-size: 12px;
  font-weight: 500;
  color: #b8c3c5;
  text-align: left !important;
  white-space: normal;
  overflow: hidden;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  justify-content: flex-start !important;
  align-items: flex-start !important;
}
.dark-heresy .combat .weapons .item-list .items .weapon .name .roll-weapon-damage,
.dark-heresy .combat .psychic-powers .item-list .items .weapon .name .roll-psychic-damage {
  flex: 0 0 auto;
  width: 22px;
  height: 22px;
  padding: 0;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  background: rgba(255, 255, 255, 0.06);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 3px;
  color: #dcdcdc;
  cursor: pointer;
}
.dark-heresy .combat .weapons .item-list .items .weapon .name .roll-weapon-damage:hover,
.dark-heresy .combat .psychic-powers .item-list .items .weapon .name .roll-psychic-damage:hover {
  background: rgba(255, 255, 255, 0.12);
}
.dark-heresy .gear .all-gear .item-list .items .gear-notes {
  display: none !important;
  margin-top: 2px;
  padding: 6px 8px;
  background: rgba(6, 12, 14, 0.9);
  border-radius: 4px;
  border: 1px solid rgba(11, 74, 80, 0.6);
  font-size: 12px;
  line-height: 1.5;
  color: #c9cfce;
  box-sizing: border-box;
  text-align: justify !important;
}
.dark-heresy .gear .all-gear .item-list .items .gear-block .gear-toggle:checked ~ .gear-notes {
  display: block !important;
}
.dark-heresy .gear .all-gear .item-list .items .gear-notes * {
  text-align: justify !important;
}
.dark-heresy .gear .all-gear .item-list .items .gear-block .gear-toggle:checked ~ .gear-notes {
  display: block;
}
.dark-heresy .progression .aptitudes {
  display: flex;
  flex-direction: column;
  flex-wrap: wrap;
  flex-basis: 25%;
  align-items: flex-start;
}
.dark-heresy .progression .aptitudes.border h1 {
  margin: 0 0 0 0;
  padding: 0;
}
.dark-heresy .progression .aptitudes .item-list {
  width: 100%;
  margin-top: 0;
}
.dark-heresy .progression .aptitudes .item-list .header {
  margin-top: 0px;
}
.dark-heresy .progression .aptitudes .item-list .header .name {
  flex-basis: 89%;
}
.dark-heresy .progression .aptitudes .item-list .items .aptitude {
  width: 100%;
}
.dark-heresy .progression .aptitudes .item-list .items {
  max-height: 160px;
  height: 160px;
  overflow-y: auto;
}
.dark-heresy .progression .aptitudes .item-list .items .item .name {
  flex-basis: 90%;
  align-items: center;
  background: none;
  border: none;
  box-shadow: none;
  font-size: 16px;
  padding: 0;
}
.dark-heresy .progression .aptitudes .item-list .items .item .name:focus {
  background: #d0d0d0;
  border-radius: 3px;
  border: 1px solid var(--color-border);
  box-shadow: 0 0 10px var(--color-shadow);
  outline: none;
  color: var(--color-text);
  font-family: var(--font-text);
  font-size: 12px;
  padding: 2px 4px;
}
.dark-heresy .progression .talents {
  display: flex;
  flex-direction: column;
  flex-wrap: wrap;
  flex-basis: calc(45% - 4px);
  align-items: center;
  margin: 0 2px;
}
.dark-heresy .progression .talents .item-list .header {
  margin-top: 5px;
}
.dark-heresy .progression .talents .item-list .header .name {
  flex-basis: 60%;
}
.dark-heresy .progression .talents .item-list .header .cost {
  flex-basis: 25%;
  padding-right: 20px;
}
.dark-heresy .progression .talents .item-list .header .starter {
  flex-basis: 9%;
  padding-right: 11px;
}
.dark-heresy .progression .talents .item-list .header .button {
  flex-basis: 6%;
  padding-right: 5px;
}
.dark-heresy .progression .talents .item-list .items .talent {
  width: 100%;
}
.dark-heresy .progression .talents .item-list .items {
  max-height: 160px;
  height: 160px;
  overflow-y: auto;
}
.dark-heresy .progression .talents .item-list .items .item .talent-row {
  flex-basis: 60%;
  align-items: center;
}
.dark-heresy .progression .talents .item-list .items .item input {
  flex-basis: 25%;
  margin: 1px 5px;
  color: #dcdcdc;
}
.dark-heresy .progression .talents .item-list .items .item input.item-cost {
  color: #000000;
}
.dark-heresy .progression .talents .item-list .items .item input.item-starter {
  flex-basis: 9%;
  margin: 1px;
  margin-right: 4px;
  width: 15px;
  height: 15px;
}
.dark-heresy .progression .talents .item-list .items .item .button {
  flex-basis: 6%;
}
.dark-heresy .progression .aptitudes .item-list .items .item .aptitude-row {
  flex-basis: 90%;
  align-items: center;
}
.dark-heresy .progression .aptitudes .item-list .items .item input {
  flex-basis: 28%;
  margin: 1px 5px;
  color: #dcdcdc;
}
.dark-heresy .progression .experience {
  display: flex;
  flex-direction: column;
  flex-wrap: wrap;
  flex-basis: 30%;
}
.dark-heresy .progression .experience .information {
  display: flex;
  margin-top: 1px;
}
.dark-heresy .progression .experience .information label {
  flex-basis: 75%;
}
.dark-heresy .progression .experience .information input {
  flex-basis: 25%;
}
.dark-heresy .progression .characteristics {
  display: flex;
  flex-direction: column;
  flex-wrap: wrap;
  margin-right: 1px;
  margin-top: 2px;
}
.dark-heresy .progression .characteristics .item-list .header {
  margin-top: 5px;
}
.dark-heresy .progression .characteristics .item-list .header .name {
  flex-basis: 29%;
}
.dark-heresy .progression .characteristics .item-list .header .advance {
  flex-basis: 25%;
  margin-right: 5px;
}
.dark-heresy .progression .characteristics .item-list .header .unnatural {
  flex-basis: 13%;
  margin: 1px;
}
.dark-heresy .progression .characteristics .item-list .header .base {
  flex-basis: 11%;
  margin: 1px;
}
.dark-heresy .progression .characteristics .item-list .header .cost {
  flex-basis: 15%;
  margin-left: 5px;
}
.dark-heresy .progression .characteristics .item-list .items {
  max-height: 157px;
  height: 157px;
}
.dark-heresy .progression .characteristics .item-list .items .item .name {
  flex-basis: 30%;
  font-size: 20px;
  text-align: center;
  font-weight: bold;
}
.dark-heresy .progression .characteristics .item-list .items .item .advance {
  flex-basis: 25%;
  text-align: center;
  height: 22px;
  margin-right: 5px;
}
.dark-heresy .progression .characteristics .item-list .items .item .unnatural {
  font-size: 12px;
  height: 24px;
  width: 40px;
  margin: 1px;
}
.dark-heresy .progression .characteristics .item-list .items .item .base {
  font-size: 12px;
  height: 24px;
  width: 40px;
  margin: 1px;
}
.dark-heresy .progression .characteristics .item-list .items .item .cost {
  flex-basis: 15%;
  text-align: center;
  height: 22px;
  margin-left: 5px;
  color: #dcdcdc;
}
.dark-heresy .progression .characteristics .item-list .items .item .cost input {
  color: #000000 !important;
}
.dark-heresy .progression .characteristics .item-list .items .item input.cost {
  color: #000000 !important;
}
.dark-heresy .progression .psychic-powers {
  display: flex;
  flex-direction: column;
  flex-wrap: wrap;
  align-items: center;
  margin-right: 1px;
  margin-top: 2px;
}
.dark-heresy .progression .psychic-powers .header {
  margin-top: 5px;
  display: flex;
}
.dark-heresy .progression .psychic-powers .header .class {
  display: flex;
  flex-basis: 50%;
  align-self: center;
}
.dark-heresy .progression .psychic-powers .header .class label {
  flex-basis: 40%;
}
.dark-heresy .progression .psychic-powers .header .class select {
  flex-basis: 60%;
  color: #dcdcdc;
}
.dark-heresy .progression .psychic-powers .header .rating {
  display: flex;
  flex-basis: 50%;
  flex-direction: column;
  margin-left: 20px;
}
.dark-heresy .progression .psychic-powers .header .rating label {
  flex-basis: 70%;
}
.dark-heresy .progression .psychic-powers .header .rating input {
  flex-basis: 40%;
  color: #dcdcdc;
}
.dark-heresy .progression .psychic-powers .item-list .header {
  margin-top: 5px;
}
.dark-heresy .progression .psychic-powers .item-list .header .name {
  flex-basis: 64%;
}
.dark-heresy .progression .psychic-powers .item-list .header .cost {
  flex-basis: 30%;
}
.dark-heresy .progression .psychic-powers .item-list .items .psychic-power {
  width: 100%;
}
.dark-heresy .progression .psychic-powers .item-list .items {
  max-height: 107px;
  height: 107px;
}
.dark-heresy .progression .psychic-powers .item-list .items .item .psychic-powers-row {
  flex-basis: 64%;
  align-items: center;
}
.dark-heresy .progression .psychic-powers .item-list .items .item input {
  flex-basis: 28%;
  margin: 1px 5px;
  color: #dcdcdc;
}
.dark-heresy .progression .psychic-powers .item-list .items .item input.item-cost {
  color: #000000;
}
.dark-heresy .progression .skills {
  display: flex;
  flex-direction: column;
  flex-wrap: wrap;
  flex-basis: calc(50% - 1px);
  margin-left: 1px;
  margin-top: 2px;
}
.dark-heresy .progression .skills .item-list .header {
  margin-top: 5px;
}
.dark-heresy .progression .skills .item-list .header .name {
  flex-basis: 35%;
}
.dark-heresy .progression .skills .item-list .header .advance {
  flex-basis: 25%;
  margin-right: 5px;
}
.dark-heresy .progression .skills .item-list .header .total {
  flex-basis: 11%;
  margin: 1px;
}
.dark-heresy .progression .skills .item-list .header .cost {
  flex-basis: 15%;
  margin-left: 5px;
}
.dark-heresy .progression .skills .item-list .header .starter {
  flex-grow: 1;
}
.dark-heresy .progression .skills .item-list .items {
  max-height: 657px;
  height: 657px;
  overflow-y: auto;
}
.dark-heresy .progression .skills .item-list .items .item .name {
  flex-basis: 40%;
  font-size: 20px;
  text-align: center;
  font-weight: bold;
}
.dark-heresy .progression .skills .item-list .items .item .advance {
  flex-basis: 25%;
  text-align: center;
  height: 22px;
  margin-right: 5px;
}
.dark-heresy .progression .skills .item-list .items .item .total {
  font-size: 12px;
  height: 24px;
  width: 40px;
  margin: 1px;
}
.dark-heresy .progression .skills .item-list .items .item .cost {
  flex-basis: 15%;
  text-align: center;
  height: 22px;
  margin-left: 5px;
  color: #dcdcdc;
}
.dark-heresy .progression .skills .item-list .items .item .cost input {
  color: #000000 !important;
}
.dark-heresy .progression .skills .item-list .items .item input.cost {
  color: #000000 !important;
}
/* Black text for value inputs in Experience/Encumbrance/Wounds/Movement/etc */
.dark-heresy .progression .experience .information input,
.dark-heresy .gear .encumbrance .information input,
.dark-heresy .combat .wounds .item-list .items .item .wound-row input,
.dark-heresy .combat .wounds .information input,
.dark-heresy .combat .movement .information input,
.dark-heresy .combat .armour .armour-row .part .information input,
.dark-heresy .stats .corruptions input,
.dark-heresy .stats .insanities input {
  color: #000000 !important;
}
/* Combat/Stats/Skills: force black text where values are shown */
.dark-heresy .combat input,
.dark-heresy .combat select,
.dark-heresy .stats .characteristics input,
.dark-heresy .stats .skills input,
.dark-heresy .stats .skills select,
.dark-heresy .stats .insanities select,
.dark-heresy .stats .corruptions select {
  color: #000000 !important;
}
/* Advances: все значения в characteristics/skills — черный текст */
.dark-heresy .progression .characteristics .item-list .items .item input,
.dark-heresy .progression .characteristics .item-list .items .item select,
.dark-heresy .progression .skills .item-list .items .item input,
.dark-heresy .progression .skills .item-list .items .item select {
  color: #000000 !important;
}
.dark-heresy .progression .skills .item-list .items .item .starter {
  width: 15px;
  height: 15px;
}

/* ============================
   Advances / Progression (TAB.ADVANCES) - визуальное улучшение
   ============================ */
.dark-heresy .progression .item-list .header {
  margin-top: 6px;
  margin-bottom: 4px;
  padding: 6px 8px;
  background: rgba(12, 24, 26, 0.9);
  border-radius: 4px;
  border: 1px solid var(--impmal-lightblue);
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: 4px;
  box-sizing: border-box;
}
.dark-heresy .progression .item-list .header b {
  font-size: 11px;
  font-weight: 700;
  color: #b8c3c5;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  text-align: left;
}
.dark-heresy .progression .item-list .items {
  max-height: none;
  height: auto;
  display: flex;
  flex-direction: column;
  gap: 4px;
  padding: 2px 0;
}

/* Строки: фон, рамка, hover */
.dark-heresy .progression .aptitudes .item-list .items .aptitude,
.dark-heresy .progression .talents .item-list .items .talent,
.dark-heresy .progression .psychic-powers .item-list .items .psychic-power,
.dark-heresy .progression .skills .item-list .items .skill,
.dark-heresy .progression .skills .item-list .items .speciality,
.dark-heresy .progression .characteristics .item-list .items .characteristic {
  width: 100%;
  padding: 4px 6px;
  background: rgba(28, 49, 50, 0.35);
  border: 1px solid rgba(11, 74, 80, 0.5);
  border-radius: 4px;
  box-sizing: border-box;
  transition: all 0.2s ease;
}
.dark-heresy .progression .aptitudes .item-list .items .aptitude:hover,
.dark-heresy .progression .talents .item-list .items .talent:hover,
.dark-heresy .progression .psychic-powers .item-list .items .psychic-power:hover,
.dark-heresy .progression .skills .item-list .items .skill:hover,
.dark-heresy .progression .skills .item-list .items .speciality:hover,
.dark-heresy .progression .characteristics .item-list .items .characteristic:hover {
  background: rgba(28, 49, 50, 0.55);
  border-color: var(--impmal-lightgreen);
  box-shadow: 0 2px 6px rgba(55, 179, 107, 0.25);
  transform: translateY(-1px);
}

/* Названия и текст внутри строк – поменьше и слева */
.dark-heresy .progression .aptitudes .item-list .items .aptitude .name,
.dark-heresy .progression .talents .item-list .items .talent .name,
.dark-heresy .progression .psychic-powers .item-list .items .psychic-power .name,
.dark-heresy .progression .skills .item-list .items .skill .name,
.dark-heresy .progression .skills .item-list .items .speciality .name,
.dark-heresy .progression .characteristics .item-list .items .characteristic .name {
  font-size: 13px;
  font-weight: 600;
  color: #dcdcdc;
  text-align: left;
  white-space: normal;
  word-wrap: break-word;
}

/* Немного уменьшаем “табличные” числа, чтобы не кричали */
.dark-heresy .progression .characteristics .item-list .items .characteristic .advance,
.dark-heresy .progression .characteristics .item-list .items .characteristic .unnatural,
.dark-heresy .progression .characteristics .item-list .items .characteristic .base,
.dark-heresy .progression .characteristics .item-list .items .characteristic .cost,
.dark-heresy .progression .skills .item-list .items .skill .advance,
.dark-heresy .progression .skills .item-list .items .skill .total,
.dark-heresy .progression .skills .item-list .items .skill .cost {
  font-size: 12px;
}

/* Чуть больше места под списки, без жёстких высот */
.dark-heresy .progression .characteristics .item-list .items,
.dark-heresy .progression .psychic-powers .item-list .items {
  max-height: none;
  height: auto;
}

/* Немного подправим experience, чтобы выглядел аккуратнее */
.dark-heresy .progression .experience .information {
  margin-top: 2px;
}
.dark-heresy .progression .experience .information label {
  font-size: 12px;
  color: #b8c3c5;
}
.dark-heresy .notes-tab .notes-editor {
  margin-top: 2px;
  height: 476px;
}
.dark-heresy .notes-tab .information {
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  flex-basis: 100%;
}
.dark-heresy .notes-tab .information .information-row {
  align-items: baseline;
  display: flex;
  flex-direction: row;
  margin: 5px 0;
}
.dark-heresy .notes-tab .information .full {
  flex-basis: 100%;
}
.dark-heresy .notes-tab .information .information-row .wrapper {
  display: flex;
  align-items: center;
}
.dark-heresy .notes-tab .information .information-row .margin {
  margin-left: 14px;
}
.dark-heresy .notes-tab .information .information-row input {
  margin-left: 8px;
}
.dark-heresy .notes-tab .information .information-row .age input {
  width: 2em;
  text-align: center;
}
.dark-heresy .notes-tab .information .information-row .gender input,
.dark-heresy .notes-tab .information .information-row .build input,
.dark-heresy .notes-tab .information .information-row .complexion input,
.dark-heresy .notes-tab .information .information-row .hair input {
  width: 8em;
}
.dark-heresy .notes-tab .information .information-row .divination label,
.dark-heresy .notes-tab .information .information-row .quirks label,
.dark-heresy .notes-tab .information .information-row .superstition label,
.dark-heresy .notes-tab .information .information-row .momentos label {
  flex-basis: 10%;
}

/* ============================================
   Effects Tab Styles
   ============================================ */
.dark-heresy .effects {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  width: 100%;
}

.dark-heresy .effects .conditions {
  flex: 1 1 100%;
  min-width: 300px;
}

.dark-heresy .effects .conditions .conditions-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
  gap: 8px;
  margin-top: 8px;
}

.dark-heresy .effects .conditions .condition-item {
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: 8px;
  padding: 8px 10px;
  border: 1px solid rgba(184, 195, 197, 0.3);
  border-radius: 4px;
  background: rgba(28, 49, 50, 0.2);
  transition: all 0.2s ease;
  cursor: pointer;
}

.dark-heresy .effects .conditions .condition-item:hover {
  background: rgba(28, 49, 50, 0.4);
  border-color: rgba(184, 195, 197, 0.6);
  transform: translateY(-1px);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

.dark-heresy .effects .conditions .condition-item.active {
  border-color: #37b36b;
  background: rgba(55, 179, 107, 0.15);
}

.dark-heresy .effects .conditions .condition-item.active:hover {
  border-color: #37b36b;
  background: rgba(55, 179, 107, 0.25);
}

.dark-heresy .effects .conditions .condition-icon {
  flex: 0 0 auto;
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.dark-heresy .effects .conditions .condition-icon img {
  width: 100%;
  height: 100%;
  object-fit: contain;
  filter: drop-shadow(0 0 2px rgba(0, 0, 0, 0.5));
}

.dark-heresy .effects .conditions .condition-content {
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  gap: 4px;
  min-width: 0;
}

.dark-heresy .effects .conditions .condition-name {
  font-size: 11px;
  font-weight: 500;
  color: #b8c3c5;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  margin: 0;
  line-height: 1.2;
}

.dark-heresy .effects .conditions .condition-item.active .condition-name {
  color: #37b36b;
  font-weight: 600;
}

.dark-heresy .effects .conditions .pips {
  display: flex;
  gap: 4px;
  align-items: center;
}

.dark-heresy .effects .conditions .pip {
  width: 16px;
  height: 16px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  flex-shrink: 0;
}

.dark-heresy .effects .conditions .pip i {
  font-size: 12px;
  color: rgba(184, 195, 197, 0.7);
  transition: all 0.2s ease;
}

.dark-heresy .effects .conditions .pip:hover i {
  color: #37b36b;
  transform: scale(1.15);
}

.dark-heresy .effects .conditions .pip.filled i {
  color: #37b36b;
}

.dark-heresy .effects .conditions .pip.filled:hover i {
  color: #2d9555;
  transform: scale(1.15);
}

@media (max-width: 600px) {
  .dark-heresy .effects .conditions .conditions-grid {
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    gap: 6px;
  }
  
  .dark-heresy .effects .conditions .condition-item {
    padding: 6px 8px;
  }
  
  .dark-heresy .effects .conditions .condition-icon {
    width: 28px;
    height: 28px;
  }
  
  .dark-heresy .effects .conditions .condition-name {
    font-size: 10px;
  }
  
  .dark-heresy .effects .conditions .pip {
    width: 10px;
    height: 10px;
  }
}

.dark-heresy .effects .temporary-effects,
.dark-heresy .effects .passive-effects,
.dark-heresy .effects .disabled-effects {
  flex: 1 1 calc(33.333% - 6px);
  min-width: 280px;
  max-width: 100%;
}

@media (max-width: 1200px) {
  .dark-heresy .effects .temporary-effects,
  .dark-heresy .effects .passive-effects,
  .dark-heresy .effects .disabled-effects {
    flex: 1 1 calc(50% - 4px);
  }
}

@media (max-width: 800px) {
  .dark-heresy .effects .temporary-effects,
  .dark-heresy .effects .passive-effects,
  .dark-heresy .effects .disabled-effects {
    flex: 1 1 100%;
  }
}

.dark-heresy .effects .item-list .header .name {
  flex-basis: 50%;
}

.dark-heresy .effects .item-list .header .source {
  flex-basis: 30%;
}

.dark-heresy .effects .item-list .header .button {
  flex-basis: 20%;
  text-align: center;
  color: #b8c3c5;
  transition: color 0.2s ease;
  cursor: pointer;
}

.dark-heresy .effects .item-list .header .button:hover {
  color: var(--impmal-lightgreen);
}

.dark-heresy .effects .item-list .items .effect {
  align-items: center;
  padding: 4px 8px;
}

.dark-heresy .effects .item-list .items .effect .name {
  flex-basis: 50%;
  min-width: 0;
}

.dark-heresy .effects .item-list .items .effect .source {
  flex-basis: 30%;
  font-size: 12px;
  color: #b8c3c5;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  display: flex;
  align-items: center;
  padding: 0 4px;
}

.dark-heresy .effects .item-list .items .effect .source a {
  color: #b8c3c5;
  text-decoration: none;
  transition: color 0.2s ease;
  display: flex;
  align-items: center;
  gap: 4px;
}

.dark-heresy .effects .item-list .items .effect .source a:hover {
  color: var(--impmal-lightgreen);
}

.dark-heresy .effects .item-list .items .effect .source a i {
  font-size: 11px;
}

.dark-heresy .effects .item-list .items .effect .button {
  flex-basis: 20%;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
}

.dark-heresy .effects .item-list .items .effect .button a {
  color: #b8c3c5;
  transition: color 0.2s ease;
  cursor: pointer;
}

.dark-heresy .effects .item-list .items .effect .button a:hover {
  color: var(--impmal-lightgreen);
}

.dark-heresy .effects .item-list .items .effect .button a.inactive {
  color: #666;
  cursor: not-allowed;
}

.dark-heresy .effects .item-list .items .effect .button a.inactive:hover {
  color: #666;
}

.dark-heresy .effects .item-list .items .effect.inactive {
  opacity: 0.6;
}

.dark-heresy .effects .item-list .items .effect .image-container {
  flex: 0 0 auto;
  width: 20px;
  height: 20px;
  margin-right: 6px;
}

.dark-heresy .effects .item-list .items .effect .image-container .image {
  width: 20px;
  height: 20px;
  background-size: contain;
  background-position: center;
  background-repeat: no-repeat;
}

/* Item Effects Styles */
.dark-heresy .item-effects {
  width: 100%;
}

.dark-heresy .item-effects .item-list .header .name {
  flex-basis: 85%;
  text-align: left;
}

.dark-heresy .item-effects .item-list .header .button {
  flex-basis: 15%;
  text-align: center;
}

.dark-heresy .item-effects .item-list .items .effect {
  align-items: center;
  padding: 4px 8px;
}

.dark-heresy .item-effects .item-list .items .effect .name {
  flex: 1 1 auto;
  min-width: 0;
}

.dark-heresy .item-effects .item-list .items .effect .button {
  flex: 0 0 auto;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
}

.dark-heresy .item-effects .item-list .items .effect .button a {
  color: #b8c3c5;
  transition: color 0.2s ease;
  cursor: pointer;
}

.dark-heresy .item-effects .item-list .items .effect .button a:hover {
  color: var(--impmal-lightgreen);
}

.dark-heresy .item-effects .item-list .items .effect.inactive {
  opacity: 0.6;
}

.dark-heresy .item-effects .item-list .items .effect .image-container {
  flex: 0 0 auto;
  width: 20px;
  height: 20px;
  margin-right: 6px;
}

.dark-heresy .item-effects .item-list .items .effect .image-container .image {
  width: 20px;
  height: 20px;
  background-size: contain;
  background-position: center;
  background-repeat: no-repeat;
}

/* ============================================
   Active Effect Sheet Styles
   ============================================ */
body:not(.no-theme) .active-effect-sheet .window-header,
body:not(.no-theme) .sheet.active-effect .window-header {
  background: rgba(26, 26, 26, 0.9);
  border-bottom: 2px solid var(--impmal-lightblue);
  color: #dcdcdc;
}

body:not(.no-theme) .active-effect-sheet .window-header .window-title,
body:not(.no-theme) .sheet.active-effect .window-header .window-title {
  color: #dcdcdc;
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.8);
}

body:not(.no-theme) .active-effect-sheet .tabs,
body:not(.no-theme) .sheet.active-effect .tabs {
  border-bottom: 2px solid var(--impmal-lightblue);
  margin-bottom: 8px;
}

body:not(.no-theme) .active-effect-sheet .tabs .item,
body:not(.no-theme) .sheet.active-effect .tabs .item {
  color: #b8c3c5;
  border: 1px solid transparent;
  border-bottom: none;
  background: rgba(28, 49, 50, 0.5);
  transition: all 0.2s ease;
}

body:not(.no-theme) .active-effect-sheet .tabs .item:hover,
body:not(.no-theme) .sheet.active-effect .tabs .item:hover {
  background: rgba(28, 49, 50, 0.8);
  color: #ddd;
}

body:not(.no-theme) .active-effect-sheet .tabs .item.active,
body:not(.no-theme) .sheet.active-effect .tabs .item.active {
  background: rgba(11, 74, 80, 0.6);
  border-color: var(--impmal-lightblue);
  color: #fff;
  border-bottom-color: transparent;
}

body:not(.no-theme) .active-effect-sheet .form-group label,
body:not(.no-theme) .sheet.active-effect .form-group label {
  color: #e0e0e0;
  font-weight: 600;
  font-size: 13px;
}

body:not(.no-theme) .active-effect-sheet .form-group input[type="text"],
body:not(.no-theme) .active-effect-sheet .form-group input[type="color"],
body:not(.no-theme) .sheet.active-effect .form-group input[type="text"],
body:not(.no-theme) .sheet.active-effect .form-group input[type="color"] {
  background: rgba(183, 172, 158, 0.3);
  border: 1px solid var(--impmal-lightblue);
  color: #ddd;
  border-radius: 3px;
  padding: 4px 8px;
}

body:not(.no-theme) .active-effect-sheet .form-group input[type="text"]:focus,
body:not(.no-theme) .active-effect-sheet .form-group input[type="color"]:focus,
body:not(.no-theme) .sheet.active-effect .form-group input[type="text"]:focus,
body:not(.no-theme) .sheet.active-effect .form-group input[type="color"]:focus {
  border-color: var(--impmal-lightgreen);
  box-shadow: 0 0 4px rgba(55, 179, 107, 0.3);
  outline: none;
}

body:not(.no-theme) .active-effect-sheet .form-group select,
body:not(.no-theme) .sheet.active-effect .form-group select {
  background: rgba(183, 172, 158, 0.3);
  border: 1px solid var(--impmal-lightblue);
  color: #ddd;
  border-radius: 3px;
  padding: 4px 8px;
}

body:not(.no-theme) .active-effect-sheet .form-group select:focus,
body:not(.no-theme) .sheet.active-effect .form-group select:focus {
  border-color: var(--impmal-lightgreen);
  box-shadow: 0 0 4px rgba(55, 179, 107, 0.3);
  outline: none;
}

body:not(.no-theme) .active-effect-sheet .form-group input[type="checkbox"],
body:not(.no-theme) .sheet.active-effect .form-group input[type="checkbox"] {
  width: 18px;
  height: 18px;
  cursor: pointer;
  accent-color: var(--impmal-lightgreen);
}

body:not(.no-theme) .active-effect-sheet .editor,
body:not(.no-theme) .sheet.active-effect .editor {
  border: 1px solid var(--impmal-lightblue);
  border-radius: 3px;
  background: rgba(28, 49, 50, 0.5);
}

body:not(.no-theme) .active-effect-sheet .editor-content,
body:not(.no-theme) .sheet.active-effect .editor-content {
  background: rgba(28, 49, 50, 0.3);
  color: #ddd;
  min-height: 100px;
  padding: 8px;
}

body:not(.no-theme) .active-effect-sheet .editor .editor-menu,
body:not(.no-theme) .sheet.active-effect .editor .editor-menu {
  background: rgba(11, 74, 80, 0.4);
  border-bottom: 1px solid var(--impmal-lightblue);
  padding: 4px;
}

body:not(.no-theme) .active-effect-sheet .editor .editor-menu button,
body:not(.no-theme) .sheet.active-effect .editor .editor-menu button {
  background: transparent;
  border: 1px solid transparent;
  color: #b8c3c5;
  padding: 4px 8px;
  margin: 0 2px;
  border-radius: 3px;
  transition: all 0.2s ease;
}

body:not(.no-theme) .active-effect-sheet .editor .editor-menu button:hover,
body:not(.no-theme) .sheet.active-effect .editor .editor-menu button:hover {
  background: rgba(11, 74, 80, 0.6);
  border-color: var(--impmal-lightblue);
  color: #fff;
}

body:not(.no-theme) .active-effect-sheet button[type="submit"],
body:not(.no-theme) .sheet.active-effect button[type="submit"] {
  background-color: var(--impmal-darkblue);
  border: 2px solid var(--impmal-lightblue);
  border-radius: 5px;
  color: white;
  padding: 8px 16px;
  font-weight: 600;
  transition: all 0.2s ease;
  cursor: pointer;
}

body:not(.no-theme) .active-effect-sheet button[type="submit"]:hover,
body:not(.no-theme) .sheet.active-effect button[type="submit"]:hover {
  background-color: var(--impmal-lightblue);
  box-shadow: 0 0 8px rgba(11, 74, 80, 0.5);
}

body:not(.no-theme) .active-effect-sheet .form-group .form-fields,
body:not(.no-theme) .sheet.active-effect .form-group .form-fields {
  display: flex;
  align-items: center;
  gap: 8px;
}

body:not(.no-theme) .active-effect-sheet .form-group .form-fields > *,
body:not(.no-theme) .sheet.active-effect .form-group .form-fields > * {
  flex: 1 1 auto;
}

body:not(.no-theme) .active-effect-sheet .icon-picker,
body:not(.no-theme) .sheet.active-effect .icon-picker {
  border: 1px solid var(--impmal-lightblue);
  border-radius: 3px;
  background: rgba(28, 49, 50, 0.5);
  padding: 4px;
}

body:not(.no-theme) .active-effect-sheet .icon-picker img,
body:not(.no-theme) .sheet.active-effect .icon-picker img {
  width: 32px;
  height: 32px;
  border-radius: 3px;
  border: 1px solid rgba(184, 195, 197, 0.3);
}

/* Unequipped weapon styling */
.dark-heresy .weapon.item.unequipped {
  opacity: 0.5;
  color: #999;
}

.dark-heresy .weapon.item.unequipped .roll-weapon,
.dark-heresy .weapon.item.unequipped .roll-weapon-damage,
.dark-heresy .weapon.item.unequipped .class,
.dark-heresy .weapon.item.unequipped .range,
.dark-heresy .weapon.item.unequipped .rate-of-fire,
.dark-heresy .weapon.item.unequipped .damage,
.dark-heresy .weapon.item.unequipped .type,
.dark-heresy .weapon.item.unequipped .penetration,
.dark-heresy .weapon.item.unequipped .clip,
.dark-heresy .weapon.item.unequipped .reload,
.dark-heresy .weapon.item.unequipped .special {
  color: #999;
}

.dark-heresy .weapon.item.unequipped .roll-weapon:hover {
  color: #bbb;
}

/* Toggle equipped button */
.dark-heresy .toggle-equipped {
  background: transparent;
  border: none;
  color: #666;
  cursor: pointer;
  padding: 0;
  margin: 0;
  font-size: 12px;
  transition: all 0.2s ease;
  margin-left: 6px;
  width: 14px;
  height: 14px;
  min-width: 14px;
  min-height: 14px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  position: relative;
  z-index: 10;
  pointer-events: auto;
  vertical-align: middle;
  line-height: 1;
}

.dark-heresy .toggle-equipped i {
  line-height: 1;
  font-size: 12px;
  display: block;
  width: 12px;
  height: 12px;
  margin: 0;
  padding: 0;
}

/* Equipped state - glowing circle */
.dark-heresy .toggle-equipped.equipped {
  color: var(--impmal-lightgreen);
  box-shadow: 0 0 6px rgba(55, 179, 107, 0.6), 0 0 12px rgba(55, 179, 107, 0.4);
}

.dark-heresy .weapon.item.unequipped .toggle-equipped {
  color: #666;
}

.dark-heresy .weapon.item.unequipped .toggle-equipped.equipped {
  color: var(--impmal-lightgreen);
  box-shadow: 0 0 6px rgba(55, 179, 107, 0.6), 0 0 12px rgba(55, 179, 107, 0.4);
}

.dark-heresy .toggle-equipped:hover {
  color: var(--impmal-lightblue);
  transform: scale(1.15);
}

.dark-heresy .toggle-equipped.equipped:hover {
  color: var(--impmal-lightblue);
  box-shadow: 0 0 8px rgba(11, 74, 80, 0.8), 0 0 16px rgba(11, 74, 80, 0.6);
}

.dark-heresy .weapon.item.unequipped .toggle-equipped:hover {
  color: #999;
}

/* Ensure weapon toggle-equipped in combat tab matches gear tab */
.dark-heresy .weapon.item .toggle-equipped,
.dark-heresy .weapons .weapon.item .toggle-equipped,
.dark-heresy .weapon.item .name .toggle-equipped,
.dark-heresy .weapons .weapon.item .name .toggle-equipped,
.dark-heresy .combat .weapons .item-list .items .weapon .name button.toggle-equipped {
  background: transparent !important;
  border: none !important;
  border-radius: 0 !important;
  color: #666 !important;
  cursor: pointer;
  padding: 0 !important;
  margin: 0 !important;
  margin-left: 6px !important;
  font-size: 12px !important;
  font-weight: normal !important;
  transition: all 0.2s ease;
  width: 14px !important;
  height: 14px !important;
  min-width: 14px !important;
  min-height: 14px !important;
  max-width: 14px !important;
  max-height: 14px !important;
  flex: 0 0 14px !important;
  display: inline-flex !important;
  align-items: center;
  justify-content: center;
  position: relative;
  z-index: 10;
  pointer-events: auto;
  vertical-align: middle;
  line-height: 1 !important;
  box-shadow: none !important;
  text-align: center !important;
  white-space: nowrap !important;
  overflow: visible !important;
  text-overflow: clip !important;
  -webkit-box-orient: horizontal !important;
  -webkit-line-clamp: 1 !important;
  line-clamp: 1 !important;
  outline: none !important;
}

.dark-heresy .combat .weapons .item-list .items .weapon .name button.toggle-equipped::before,
.dark-heresy .combat .weapons .item-list .items .weapon .name button.toggle-equipped::after {
  display: none !important;
  content: none !important;
}

.dark-heresy .weapon.item .toggle-equipped i,
.dark-heresy .weapons .weapon.item .toggle-equipped i,
.dark-heresy .weapon.item .name .toggle-equipped i,
.dark-heresy .weapons .weapon.item .name .toggle-equipped i,
.dark-heresy .combat .weapons .item-list .items .weapon .name button.toggle-equipped i {
  line-height: 1;
  font-size: 12px;
  display: block;
  width: 12px;
  height: 12px;
  margin: 0;
  padding: 0;
}

.dark-heresy .combat .weapons .item-list .items .weapon .name button.toggle-equipped.equipped {
  color: var(--impmal-lightgreen) !important;
  box-shadow: 0 0 6px rgba(55, 179, 107, 0.6), 0 0 12px rgba(55, 179, 107, 0.4) !important;
}

.dark-heresy .combat .weapons .item-list .items .weapon .name button.toggle-equipped.equipped:hover {
  color: var(--impmal-lightblue) !important;
  box-shadow: 0 0 8px rgba(11, 74, 80, 0.8), 0 0 16px rgba(11, 74, 80, 0.6) !important;
}

.dark-heresy .combat .weapons .item-list .items .weapon .name button.toggle-equipped:hover {
  background: transparent !important;
  border: none !important;
}

/* Toggle equipped button in gear tab */
.dark-heresy .gear .all-gear .item-list .items .gear .name .toggle-equipped {
  background: transparent !important;
  border: none !important;
  border-radius: 0 !important;
  color: #666;
  cursor: pointer;
  padding: 0;
  margin: 0;
  font-size: 12px;
  transition: all 0.2s ease;
  width: 14px;
  height: 14px;
  min-width: 14px;
  min-height: 14px;
  max-width: 14px;
  max-height: 14px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  position: relative;
  margin-right: 6px;
  z-index: 10;
  pointer-events: auto;
  flex-shrink: 0;
  vertical-align: middle;
  line-height: 1;
  box-shadow: none !important;
  opacity: 0.5;
  filter: brightness(0.7);
  outline: none !important;
}

.dark-heresy .gear .all-gear .item-list .items .gear .name .toggle-equipped.equipped {
  color: var(--impmal-lightgreen);
  box-shadow: 0 0 8px rgba(55, 179, 107, 0.8), 0 0 16px rgba(55, 179, 107, 0.6), 0 0 24px rgba(55, 179, 107, 0.4);
  filter: brightness(1.3);
  opacity: 1;
}

.dark-heresy .gear .all-gear .item-list .items .gear .name .toggle-equipped:hover {
  color: var(--impmal-lightblue);
  transform: scale(1.15);
  box-shadow: 0 0 6px rgba(11, 74, 80, 0.6), 0 0 12px rgba(11, 74, 80, 0.4);
  opacity: 0.7;
}

.dark-heresy .gear .all-gear .item-list .items .gear .name .toggle-equipped.equipped:hover {
  color: var(--impmal-lightgreen);
  box-shadow: 0 0 12px rgba(55, 179, 107, 1), 0 0 20px rgba(55, 179, 107, 0.8), 0 0 30px rgba(55, 179, 107, 0.6);
  filter: brightness(1.5);
  opacity: 1;
}

.dark-heresy .gear .toggle-equipped {
  background: transparent !important;
  border: none !important;
  border-radius: 0 !important;
  color: #666;
  cursor: pointer;
  padding: 0;
  margin: 0;
  font-size: 12px;
  transition: all 0.2s ease;
  margin-left: 6px;
  width: 14px;
  height: 14px;
  min-width: 14px;
  min-height: 14px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  position: relative;
  z-index: 10;
  pointer-events: auto;
  flex-shrink: 0;
  vertical-align: middle;
  line-height: 1;
  outline: none !important;
}

.dark-heresy .gear .toggle-equipped i {
  line-height: 1;
  font-size: 12px;
  display: block;
  width: 12px;
  height: 12px;
  margin: 0;
  padding: 0;
}

.dark-heresy .gear .toggle-equipped.equipped {
  color: var(--impmal-lightgreen);
  box-shadow: 0 0 8px rgba(55, 179, 107, 0.8), 0 0 16px rgba(55, 179, 107, 0.6), 0 0 24px rgba(55, 179, 107, 0.4);
  filter: brightness(1.3);
}

.dark-heresy .gear.item.unequipped .toggle-equipped,
.dark-heresy .gear-block.unequipped .toggle-equipped {
  color: #666;
  box-shadow: none;
  filter: brightness(0.7);
  opacity: 0.5;
}

.dark-heresy .gear.item.unequipped .toggle-equipped.equipped,
.dark-heresy .gear-block.unequipped .toggle-equipped.equipped {
  color: var(--impmal-lightgreen);
  box-shadow: 0 0 8px rgba(55, 179, 107, 0.8), 0 0 16px rgba(55, 179, 107, 0.6), 0 0 24px rgba(55, 179, 107, 0.4);
  filter: brightness(1.3);
  opacity: 1;
}

.dark-heresy .gear .toggle-equipped:hover {
  color: var(--impmal-lightblue);
  transform: scale(1.15);
  box-shadow: 0 0 6px rgba(11, 74, 80, 0.6), 0 0 12px rgba(11, 74, 80, 0.4);
}

.dark-heresy .gear .toggle-equipped.equipped:hover {
  color: var(--impmal-lightgreen);
  box-shadow: 0 0 12px rgba(55, 179, 107, 1), 0 0 20px rgba(55, 179, 107, 0.8), 0 0 30px rgba(55, 179, 107, 0.6);
  filter: brightness(1.5);
}

.dark-heresy .gear.item.unequipped .toggle-equipped:hover,
.dark-heresy .gear-block.unequipped .toggle-equipped:hover {
  color: #999;
  opacity: 0.7;
  box-shadow: 0 0 4px rgba(102, 102, 102, 0.4);
}

/* Unequipped weapon styling in gear tab */
.dark-heresy .gear-block.unequipped,
.dark-heresy .gear.item.unequipped {
  opacity: 0.5;
  color: #999;
}

.dark-heresy .gear-block.unequipped .gear.item .name,
.dark-heresy .gear.item.unequipped .name,
.dark-heresy .gear-block.unequipped .class,
.dark-heresy .gear.item.unequipped .class,
.dark-heresy .gear-block.unequipped .damage,
.dark-heresy .gear.item.unequipped .damage,
.dark-heresy .gear-block.unequipped .type,
.dark-heresy .gear.item.unequipped .type,
.dark-heresy .gear-block.unequipped .clip,
.dark-heresy .gear.item.unequipped .clip,
.dark-heresy .gear-block.unequipped .weight,
.dark-heresy .gear.item.unequipped .weight,
.dark-heresy .gear-block.unequipped .part,
.dark-heresy .gear.item.unequipped .part {
  color: #999;
}
